<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.51">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Resampling statistics - 24&nbsp; The Statistics of Hypothesis-Testing With Measured Data</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./testing_procedures.html" rel="next">
<link href="./testing_counts_2.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>

<script type="text/javascript">
  $(document).ready(function() {
    $("table").addClass('lightable-paper lightable-striped lightable-hover')
  });
</script>

<script src="site_libs/kePrint-0.0.1/kePrint.js"></script>
<link href="site_libs/lightable-0.0.1/lightable.css" rel="stylesheet">

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<link rel="stylesheet" href="style.css">
<link rel="stylesheet" href="font-awesome.min.css">
</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./testing_measured.html"><span class="chapter-number">24</span>&nbsp; <span class="chapter-title">The Statistics of Hypothesis-Testing With Measured Data</span></a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Resampling statistics</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">R edition</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./preface_third.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface to the third edition</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./preface_second.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface to the second edition</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./resampling_method.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">The resampling method</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./what_is_probability.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">What is probability?</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./about_technology.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Introducing R and the RStudio notebook</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./resampling_with_code.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Resampling with code</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./resampling_with_code2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">More resampling with code</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./sampling_tools.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Tools for samples and sampling</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./probability_theory_1a.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Probability Theory, Part 1</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./probability_theory_1b.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Probability Theory Part I (continued)</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./more_sampling_tools.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Two puzzles and more tools</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./probability_theory_2_compound.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Probability Theory, Part 2: Compound Probability</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./probability_theory_3.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Probability Theory, Part 3</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./probability_theory_4_finite.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Probability Theory, Part 4: Estimating Probabilities from Finite Universes</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./sampling_variability.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">On Variability in Sampling</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./monte_carlo.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">The Procedures of Monte Carlo Simulation (and Resampling)</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./standard_scores.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Ranks, Quantiles and Standard Scores</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./inference_ideas.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">The Basic Ideas in Statistical Inference</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./inference_intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Introduction to Statistical Inference</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./point_estimation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Point Estimation</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./framing_questions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Framing Statistical Questions</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./testing_counts_1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">Hypothesis-Testing with Counted Data, Part 1</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./significance.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">22</span>&nbsp; <span class="chapter-title">The Concept of Statistical Significance in Testing Hypotheses</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./testing_counts_2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">23</span>&nbsp; <span class="chapter-title">The Statistics of Hypothesis-Testing with Counted Data, Part 2</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./testing_measured.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">24</span>&nbsp; <span class="chapter-title">The Statistics of Hypothesis-Testing With Measured Data</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./testing_procedures.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">25</span>&nbsp; <span class="chapter-title">General Procedures for Testing Hypotheses</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./confidence_1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">26</span>&nbsp; <span class="chapter-title">Confidence Intervals, Part 1: Assessing the Accuracy of Samples</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./confidence_2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">27</span>&nbsp; <span class="chapter-title">Confidence Intervals, Part 2: The Two Approaches to Estimating Confidence Intervals</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./reliability_average.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">28</span>&nbsp; <span class="chapter-title">Some Last Words About the Reliability of Sample Averages</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./correlation_causation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">29</span>&nbsp; <span class="chapter-title">Correlation and Causation</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./how_big_sample.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">30</span>&nbsp; <span class="chapter-title">How Large a Sample?</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./bayes_simulation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">31</span>&nbsp; <span class="chapter-title">Bayesian Analysis by Simulation</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./exercise_solutions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">32</span>&nbsp; <span class="chapter-title">Exercise Solutions</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./acknowlegements.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">33</span>&nbsp; <span class="chapter-title">Acknowledgements</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./technical_note.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">34</span>&nbsp; <span class="chapter-title">Technical Note to the Professional Reader</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#sec-pig-rations-measured" id="toc-sec-pig-rations-measured" class="nav-link active" data-scroll-target="#sec-pig-rations-measured"><span class="header-section-number">24.0.1</span> Example: The Pig Rations Still Once Again, Using Measured Data</a></li>
  <li><a href="#sec-liquor-public-measured" id="toc-sec-liquor-public-measured" class="nav-link" data-scroll-target="#sec-liquor-public-measured"><span class="header-section-number">24.0.2</span> Example: Is There a Difference in Liquor Prices Between State-Run and Privately-Run Systems?</a></li>
  <li><a href="#example-is-there-a-difference-between-treatments-to-prevent-low-birthweights" id="toc-example-is-there-a-difference-between-treatments-to-prevent-low-birthweights" class="nav-link" data-scroll-target="#example-is-there-a-difference-between-treatments-to-prevent-low-birthweights"><span class="header-section-number">24.0.3</span> Example: Is there a difference between treatments to prevent low birthweights?</a></li>
  <li><a href="#sec-eg-bootstrap-sampling" id="toc-sec-eg-bootstrap-sampling" class="nav-link" data-scroll-target="#sec-eg-bootstrap-sampling"><span class="header-section-number">24.0.4</span> Example: Bootstrap Sampling with Replacement</a></li>
  <li><a href="#example-permutation-sampling-without-replacement" id="toc-example-permutation-sampling-without-replacement" class="nav-link" data-scroll-target="#example-permutation-sampling-without-replacement"><span class="header-section-number">24.0.5</span> Example: Permutation Sampling Without Replacement</a></li>
  <li><a href="#differences-among-four-means" id="toc-differences-among-four-means" class="nav-link" data-scroll-target="#differences-among-four-means"><span class="header-section-number">24.1</span> Differences among four means</a>
  <ul class="collapse">
  <li><a href="#example-differences-among-four-pig-rations" id="toc-example-differences-among-four-pig-rations" class="nav-link" data-scroll-target="#example-differences-among-four-pig-rations"><span class="header-section-number">24.1.1</span> Example: differences among four pig rations</a></li>
  </ul></li>
  <li><a href="#using-squared-differences" id="toc-using-squared-differences" class="nav-link" data-scroll-target="#using-squared-differences"><span class="header-section-number">24.2</span> Using Squared Differences</a></li>
  <li><a href="#exercises" id="toc-exercises" class="nav-link" data-scroll-target="#exercises"><span class="header-section-number">24.3</span> Exercises</a>
  <ul class="collapse">
  <li><a href="#sec-exr-paired-differences" id="toc-sec-exr-paired-differences" class="nav-link" data-scroll-target="#sec-exr-paired-differences"><span class="header-section-number">24.3.1</span> Exercise: paired differences</a></li>
  <li><a href="#sec-exr-seatbelt-proportions" id="toc-sec-exr-seatbelt-proportions" class="nav-link" data-scroll-target="#sec-exr-seatbelt-proportions"><span class="header-section-number">24.3.2</span> Exercise: seatbelt proportions</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span id="sec-testing-measured" class="quarto-section-identifier"><span class="chapter-number">24</span>&nbsp; <span class="chapter-title">The Statistics of Hypothesis-Testing With Measured Data</span></span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<!---
Discussion here of dispersion - have we discussed this before?

Methods of estimating dispersion.
-->
<p><a href="testing_counts_1.html" class="quarto-xref"><span>Chapter&nbsp;21</span></a> and <a href="point_estimation.html" class="quarto-xref"><span>Chapter&nbsp;19</span></a> discussed testing a hypothesis with data that either arrive in dichotomized (yes-no) form, or come as data in situations where it is convenient to dichotomize. We next consider hypothesis testing using measured data. Conventional statistical practice employs such devices as the “t-test” and “analysis of variance.” In contrast to those complex devices, the resampling method does not differ greatly from what has been discussed in previous chapters.</p>
<section id="sec-pig-rations-measured" class="level3" data-number="24.0.1">
<h3 data-number="24.0.1" class="anchored" data-anchor-id="sec-pig-rations-measured"><span class="header-section-number">24.0.1</span> Example: The Pig Rations Still Once Again, Using Measured Data</h3>
<p><strong>Testing for the difference between means of two equal-sized samples of measured-data observations</strong></p>
<p>Let us now treat the pig-food problem without converting the quantitative data into qualitative data, because a conversion always loses information.</p>
<p>The term “lose information” can be understood intuitively. Consider two sets of three sacks of corn. Set A includes sacks containing, respectively, one pound, two pounds, and three pounds. Set B includes sacks of one pound, two pounds, and a hundred pounds. If we <em>rank</em> the sacks by weight, the two sets can no longer be distinguished. The one-pound and two-pound sacks have ranks one and two in both cases, and their relative places in their sets are the same. But if we know <em>not only</em> that the one-pound sack is the smallest of its set and the three-pound or hundred-pound sack is the largest, but <em>also</em> that the largest sack is three pounds (or a hundred pounds), we have more information about a set than if we only know the ranks of its sacks.</p>
<p>Rank data are also known as “ordinal” data, whereas data measured in (say) pounds are known as “cardinal” data. Even though converting from cardinal (measured) to ordinal (ranked) data loses information, the conversion may increase convenience, and may therefore be worth doing in some cases.</p>
<p><a href="#tbl-pig-ab-rations" class="quarto-xref">Table&nbsp;<span>24.1</span></a> has the measured data for pig rations A and B.</p>
<div class="cell" data-layout-align="center" data-hash="testing_measured_cache/html/unnamed-chunk-1_ba2d9bfb535af13d79c93684508194e8">
<div class="cell-output-display">
<div id="tbl-pig-ab-rations" class="anchored">
<table class="lightable-paper lightable-striped lightable-hover table table-sm table-striped small" data-quarto-postprocess="true">
<caption>Table&nbsp;24.1: Measured data for pig rations A and B </caption>
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">ration</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">weight_gain</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">A</td>
<td style="text-align: right;">31</td>
</tr>
<tr class="even">
<td style="text-align: left;">A</td>
<td style="text-align: right;">34</td>
</tr>
<tr class="odd">
<td style="text-align: left;">A</td>
<td style="text-align: right;">29</td>
</tr>
<tr class="even">
<td style="text-align: left;">A</td>
<td style="text-align: right;">26</td>
</tr>
<tr class="odd">
<td style="text-align: left;">A</td>
<td style="text-align: right;">32</td>
</tr>
<tr class="even">
<td style="text-align: left;">A</td>
<td style="text-align: right;">35</td>
</tr>
<tr class="odd">
<td style="text-align: left;">A</td>
<td style="text-align: right;">38</td>
</tr>
<tr class="even">
<td style="text-align: left;">A</td>
<td style="text-align: right;">34</td>
</tr>
<tr class="odd">
<td style="text-align: left;">A</td>
<td style="text-align: right;">31</td>
</tr>
<tr class="even">
<td style="text-align: left;">A</td>
<td style="text-align: right;">29</td>
</tr>
<tr class="odd">
<td style="text-align: left;">A</td>
<td style="text-align: right;">32</td>
</tr>
<tr class="even">
<td style="text-align: left;">A</td>
<td style="text-align: right;">31</td>
</tr>
<tr class="odd">
<td style="text-align: left;">B</td>
<td style="text-align: right;">26</td>
</tr>
<tr class="even">
<td style="text-align: left;">B</td>
<td style="text-align: right;">24</td>
</tr>
<tr class="odd">
<td style="text-align: left;">B</td>
<td style="text-align: right;">28</td>
</tr>
<tr class="even">
<td style="text-align: left;">B</td>
<td style="text-align: right;">29</td>
</tr>
<tr class="odd">
<td style="text-align: left;">B</td>
<td style="text-align: right;">30</td>
</tr>
<tr class="even">
<td style="text-align: left;">B</td>
<td style="text-align: right;">29</td>
</tr>
<tr class="odd">
<td style="text-align: left;">B</td>
<td style="text-align: right;">31</td>
</tr>
<tr class="even">
<td style="text-align: left;">B</td>
<td style="text-align: right;">29</td>
</tr>
<tr class="odd">
<td style="text-align: left;">B</td>
<td style="text-align: right;">32</td>
</tr>
<tr class="even">
<td style="text-align: left;">B</td>
<td style="text-align: right;">26</td>
</tr>
<tr class="odd">
<td style="text-align: left;">B</td>
<td style="text-align: right;">28</td>
</tr>
<tr class="even">
<td style="text-align: left;">B</td>
<td style="text-align: right;">32</td>
</tr>
</tbody>
</table>
</div>


</div>
</div>
<p>We begin a measured-data procedure by noting that if the two pig foods are the same, then each of the observed weight gains came from the <em>same benchmark universe</em>. This is the basic tactic in our statistical strategy. That is, if the two foods came from the same universe, <em>our best guess about the composition of that universe is that it includes weight gains just like the twenty-four we have observed</em> , and in the same proportions, because that is all the information that we have about the universe; this is the bootstrap method. Since ours is (by definition) a sample from an infinite (or at least, a very large) universe of possible weight gains, we assume that there are <em>many</em> weight gains in the universe just like the ones we have observed, in the same proportion as we have observed them. For example, we assume that 2/24 of the universe is composed of 34-pound weight gains, as seen in <a href="#fig-rations-hist" class="quarto-xref">Figure&nbsp;<span>24.1</span></a>:</p>
<div class="cell" data-layout-align="center" data-hash="testing_measured_cache/html/fig-rations-hist_3b99e62ad04521dff97ff1c01d49d989">
<div class="cell-output-display">
<div id="fig-rations-hist" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="testing_measured_files/figure-html/fig-rations-hist-1.png" class="img-fluid figure-img" style="width:70.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;24.1: Histogram of weight gain</figcaption>
</figure>
</div>
</div>
</div>
<p>We recognize, of course, that weight gains other than the exact ones we observed certainly would occur in repeated experiments. And if we thought it reasonable to do so, we could assume that the “distribution” of the weight gains would follow a regular “smooth” shape such as <a href="#fig-rations-ideal" class="quarto-xref">Figure&nbsp;<span>24.2</span></a>. But deciding just how to draw <a href="#fig-rations-ideal" class="quarto-xref">Figure&nbsp;<span>24.2</span></a> from the data in <a href="#fig-rations-hist" class="quarto-xref">Figure&nbsp;<span>24.1</span></a> requires that we make arbitrary assumptions about unknown conditions. And if we were to draw <a href="#fig-rations-ideal" class="quarto-xref">Figure&nbsp;<span>24.2</span></a> in a form that would be sufficiently regular for conventional mathematical analysis, we might have to make some <em>very strong</em> assumptions going far beyond the observed data.</p>
<div class="cell" data-layout-align="center" data-hash="testing_measured_cache/html/fig-rations-ideal_f17aaec0b77e6e70cf2d5b118be90ae7">
<div class="cell-output-display">
<div id="fig-rations-ideal" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="testing_measured_files/figure-html/fig-rations-ideal-1.png" class="img-fluid figure-img" style="width:70.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;24.2: Idealized distribution for weight gain</figcaption>
</figure>
</div>
</div>
</div>
<p>Drawing a smooth curve such as <a href="#fig-rations-ideal" class="quarto-xref">Figure&nbsp;<span>24.2</span></a> from the raw data in <a href="#fig-rations-hist" class="quarto-xref">Figure&nbsp;<span>24.1</span></a> might be satisfactory — if done with wisdom and good judgment. But there is no necessity to draw such a smooth curve, in this case or in most cases. We can proceed by assuming simply that the benchmark universe — the universe to which we shall compare our samples, conventionally called the “null” or “hypothetical” universe — is composed only of elements similar to the observations we have in hand. We thereby lose no efficiency and avoid making unsound assumptions.</p>
<p>To carry out our procedure in practice: 1) Write down each of the twenty-four weight gains on a blank index card. We then have one card each for 31, 34, 29, 26, and so on. 2) Shuffle the twenty-four cards thoroughly, and pick one card. 3) Record the weight gain, and replace the card. (Recall that we are treating the weight gains as if they come from an infinite universe — that is, as if the probability of selecting any amount is the same no matter which others are selected randomly. Another way to say this is to state that each selection is independent of each other selection. If we did not replace the card before selecting the next weight gain, the selections would no longer be independent. See <a href="probability_theory_2_compound.html" class="quarto-xref"><span>Chapter&nbsp;11</span></a> for further discussion of this issue.) 4) Repeat this process until you have made two sets of 12 observations. 5) Call the first hand “food A” and the second hand “food B.” Determine the average weight gain for the two hands, and record it as in <a href="#tbl-eg-pigs-measured" class="quarto-xref">Table&nbsp;<span>24.2</span></a>. Repeat this procedure many times.</p>
<p>In operational steps:</p>
<ul>
<li><strong>Step 1.</strong> Write down each observed weight gain on a card, e.g.&nbsp;31, 34, 29 …</li>
<li><strong>Step 2.</strong> Shuffle and deal a card.</li>
<li><strong>Step 3.</strong> Record the weight and replace the card.</li>
<li><strong>Step 4.</strong> Repeat steps 2 and 3 eleven more times; call this group A.</li>
<li><strong>Step 5.</strong> Repeat steps 2-3 another twelve times; call this group B.</li>
<li><strong>Step 6.</strong> Calculate the mean weight gain of each group.</li>
<li><strong>Step 7.</strong> Subtract the mean of group A from the mean of group B and record. If larger (more positive) than 3.16 (the difference between the observed means) or more negative than -3.16, record “more.” Otherwise record “less.”</li>
<li><strong>Step 8.</strong> Repeat this procedure perhaps fifty times, and calculate the proportion “more.” This estimates the probability sought.</li>
</ul>
<p>In none of the first ten simulated trials did the difference in the means of the random hands exceed the observed difference (3.16 pounds, in the top line in the table) between foods A and B. (The difference between group <em>totals</em> tells the same story and is faster, requiring no division calculations.)</p>
<p>In the old days before a computer was easily available, I (JLS) would quit making trials at such a point, confident that a difference in means as great as observed is not likely to happen by chance. (Using the convenient “multiplication rule” described in <a href="probability_theory_1b.html" class="quarto-xref"><span>Chapter&nbsp;9</span></a>, we can estimate the probability of such an occurrence happening by chance in 10 successive trials as <span class="math inline">\(\frac{1}{2} * \frac{1}{2} * \frac{1}{2} ... = \frac{1}{2}^{10} = 1/1024 \approx .001\)</span> = .1 percent, a small chance indeed.) Nevertheless, let us press on to do 50 trials.</p>
<div id="tbl-eg-pigs-measured" class="anchored">
<table class="table">
<caption>Table&nbsp;24.2: Results of fifty random samples for measured pig rations</caption>
<colgroup>
<col style="width: 16%">
<col style="width: 18%">
<col style="width: 18%">
<col style="width: 1%">
<col style="width: 17%">
<col style="width: 1%">
<col style="width: 17%">
<col style="width: 1%">
</colgroup>
<thead>
<tr class="header">
<th>Trial #</th>
<th>Mean of first 12 observations (first hand)</th>
<th colspan="2">Mean of second 12 observations (second hand)</th>
<th colspan="2">Difference</th>
<th colspan="2">Greater or less than observed difference?</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Observed</td>
<td>382 / 12=31.83</td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="even">
<td>1</td>
<td>368 / 12=30.67</td>
<td>357 / 12=29.75</td>
<td colspan="2">.87</td>
<td colspan="2">Less</td>
<td></td>
</tr>
<tr class="odd">
<td>2</td>
<td>364 / 12=30.33</td>
<td>361 / 12=30.08</td>
<td colspan="2">.25</td>
<td colspan="2">Less</td>
<td></td>
</tr>
<tr class="even">
<td>3</td>
<td>352 / 12=29.33</td>
<td>373 / 12=31.08</td>
<td colspan="2">(1.75)</td>
<td colspan="2">Less</td>
<td></td>
</tr>
<tr class="odd">
<td>4</td>
<td>378 / 12=31.50</td>
<td>347 / 12=28.92</td>
<td colspan="2">2.58</td>
<td colspan="2">Less</td>
<td></td>
</tr>
<tr class="even">
<td>5</td>
<td>365 / 12=30.42</td>
<td>360 / 12=30.00</td>
<td colspan="2">.42</td>
<td colspan="2">Less</td>
<td></td>
</tr>
<tr class="odd">
<td>6</td>
<td>352 / 12=29.33</td>
<td>373 / 12=31.08</td>
<td colspan="2">(1.75)</td>
<td colspan="2">Less</td>
<td></td>
</tr>
<tr class="even">
<td>7</td>
<td>355 / 12=29.58</td>
<td>370 / 12=30.83</td>
<td colspan="2">(1.25)</td>
<td colspan="2">Less</td>
<td></td>
</tr>
<tr class="odd">
<td>8</td>
<td>366 / 12=30.50</td>
<td>359 / 12=29.92</td>
<td colspan="2">.58</td>
<td colspan="2">Less</td>
<td></td>
</tr>
<tr class="even">
<td>9</td>
<td>360 / 12=30.00</td>
<td>365 / 12=30.42</td>
<td colspan="2">(.42)</td>
<td colspan="2">Less</td>
<td></td>
</tr>
<tr class="odd">
<td>10</td>
<td>355 / 12=29.58</td>
<td>370 / 12=30.83</td>
<td colspan="2">(1.25)</td>
<td colspan="2">Less</td>
<td></td>
</tr>
<tr class="even">
<td>11</td>
<td>359 / 12=29.92</td>
<td>366 / 12=30.50</td>
<td colspan="2">(.58)</td>
<td colspan="2">Less</td>
<td></td>
</tr>
<tr class="odd">
<td>12</td>
<td>369 / 12=30.75</td>
<td>356 / 12=29.67</td>
<td colspan="2">1.08</td>
<td colspan="2">”</td>
<td></td>
</tr>
<tr class="even">
<td>13</td>
<td>360 / 12=30.00</td>
<td>365 / 12=30.42</td>
<td colspan="2">(.42)</td>
<td colspan="2">Less</td>
<td></td>
</tr>
<tr class="odd">
<td>14</td>
<td>377 / 12=31.42</td>
<td>348 / 12=29.00</td>
<td colspan="2">2.42</td>
<td colspan="2">Less</td>
<td></td>
</tr>
<tr class="even">
<td>15</td>
<td>365 / 12=30.42</td>
<td>360 / 12=30.00</td>
<td colspan="2">.42</td>
<td colspan="2">Less</td>
<td></td>
</tr>
<tr class="odd">
<td>16</td>
<td>364 / 12=30.33</td>
<td>361 / 12=30.08</td>
<td colspan="2">.25</td>
<td colspan="2">Less</td>
<td></td>
</tr>
<tr class="even">
<td>17</td>
<td>363 / 12=30.25</td>
<td>362 / 12=30.17</td>
<td colspan="2">.08</td>
<td colspan="2">Less</td>
<td></td>
</tr>
<tr class="odd">
<td>18</td>
<td>365 / 12=30.42</td>
<td>360 / 12=30.00</td>
<td colspan="2">.42</td>
<td colspan="2">Less</td>
<td></td>
</tr>
<tr class="even">
<td>19</td>
<td>369 / 12=30.75</td>
<td>356 / 12=29.67</td>
<td colspan="2">1.08</td>
<td colspan="2">Less</td>
<td></td>
</tr>
<tr class="odd">
<td>20</td>
<td>369 / 12=30.75</td>
<td>356 / 12=29.67</td>
<td colspan="2">1.08</td>
<td colspan="2">Less</td>
<td></td>
</tr>
<tr class="even">
<td>21</td>
<td>369 / 12=30.75</td>
<td>356 / 12=29.67</td>
<td colspan="2">1.08</td>
<td colspan="2">Less</td>
<td></td>
</tr>
<tr class="odd">
<td>22</td>
<td>364 / 12=30.33</td>
<td>361 / 12=30.08</td>
<td colspan="2">.25</td>
<td colspan="2">Less</td>
<td></td>
</tr>
<tr class="even">
<td>23</td>
<td>363 / 12=30.25</td>
<td>362 / 12=30.17</td>
<td colspan="2">.08</td>
<td colspan="2">Less</td>
<td></td>
</tr>
<tr class="odd">
<td>24</td>
<td>363 / 12=30.25</td>
<td>362 / 12=30.17</td>
<td colspan="2">.08</td>
<td colspan="2">Less</td>
<td></td>
</tr>
<tr class="even">
<td>25</td>
<td>364 / 12=30.33</td>
<td>361 / 12=30.08</td>
<td colspan="2">.25</td>
<td colspan="2">Less</td>
<td></td>
</tr>
<tr class="odd">
<td>26</td>
<td>359 / 12=29.92</td>
<td>366 / 12=30.50</td>
<td colspan="2">(.58)</td>
<td colspan="2">Less</td>
<td></td>
</tr>
<tr class="even">
<td>27</td>
<td>362 / 12=30.17</td>
<td>363 / 12=30.25</td>
<td colspan="2">(.08)</td>
<td colspan="2">Less</td>
<td></td>
</tr>
<tr class="odd">
<td>28</td>
<td>362 / 12=30.17</td>
<td>363 / 12=30.25</td>
<td colspan="2">(.08)</td>
<td colspan="2">Less</td>
<td></td>
</tr>
<tr class="even">
<td>29</td>
<td>373 / 12=31.08</td>
<td>352 / 12=29.33</td>
<td colspan="2">1.75</td>
<td colspan="2">Less</td>
<td></td>
</tr>
<tr class="odd">
<td>30</td>
<td>367 / 12=30.58</td>
<td>358 / 12=29.83</td>
<td colspan="2">.75</td>
<td colspan="2">Less</td>
<td></td>
</tr>
<tr class="even">
<td>31</td>
<td>376 / 12=31.33</td>
<td>349 / 12=29.08</td>
<td colspan="2">2.25</td>
<td colspan="2">Less</td>
<td></td>
</tr>
<tr class="odd">
<td>32</td>
<td>365 / 12=30.42</td>
<td>360 / 12=30.00</td>
<td colspan="2">.42</td>
<td colspan="2">Less</td>
<td></td>
</tr>
<tr class="even">
<td>33</td>
<td>357 / 12=29.75</td>
<td>368 / 12=30.67</td>
<td colspan="2">(1.42)</td>
<td colspan="2">Less</td>
<td></td>
</tr>
<tr class="odd">
<td>34</td>
<td>349 / 12=29.08</td>
<td>376 / 12=31.33</td>
<td colspan="2">2.25</td>
<td colspan="2">Less</td>
<td></td>
</tr>
<tr class="even">
<td>35</td>
<td>356 / 12=29.67</td>
<td>396 / 12=30.75</td>
<td colspan="2">(1.08)</td>
<td colspan="2">Less</td>
<td></td>
</tr>
<tr class="odd">
<td>36</td>
<td>359 / 12=29.92</td>
<td>366 / 12=30.50</td>
<td colspan="2">(.58)</td>
<td colspan="2">Less</td>
<td></td>
</tr>
<tr class="even">
<td>37</td>
<td>372 / 12=31.00</td>
<td>353 / 12=29.42</td>
<td colspan="2">1.58</td>
<td colspan="2">Less</td>
<td></td>
</tr>
<tr class="odd">
<td>38</td>
<td>368 / 12=30.67</td>
<td>357 / 12=29.75</td>
<td colspan="2">.92</td>
<td colspan="2">Less</td>
<td></td>
</tr>
<tr class="even">
<td>39</td>
<td>344 / 12=28.67</td>
<td>382 / 12=31.81</td>
<td colspan="2">(3.16)</td>
<td colspan="2">Equal</td>
<td></td>
</tr>
<tr class="odd">
<td>40</td>
<td>365 / 12=30.42</td>
<td>360 / 12=30.00</td>
<td colspan="2">.42</td>
<td colspan="2">Less</td>
<td></td>
</tr>
<tr class="even">
<td>41</td>
<td>375 / 12=31.25</td>
<td>350 / 12=29.17</td>
<td colspan="2">2.08</td>
<td colspan="2">Less</td>
<td></td>
</tr>
<tr class="odd">
<td>42</td>
<td>353 / 12=29.42</td>
<td>372 / 12=31.00</td>
<td colspan="2">(1.58)</td>
<td colspan="2">Less</td>
<td></td>
</tr>
<tr class="even">
<td>43</td>
<td>357 / 12=29.75</td>
<td>368 / 12=30.67</td>
<td colspan="2">(.92)</td>
<td colspan="2">Less</td>
<td></td>
</tr>
<tr class="odd">
<td>44</td>
<td>363 / 12=30.25</td>
<td>362 / 12=30.17</td>
<td colspan="2">.08</td>
<td colspan="2">Less</td>
<td></td>
</tr>
<tr class="even">
<td>45</td>
<td>353 / 12=29.42</td>
<td>372 / 12=31.00</td>
<td colspan="2">(1.58)</td>
<td colspan="2">Less</td>
<td></td>
</tr>
<tr class="odd">
<td>46</td>
<td>354 / 12=29.50</td>
<td>371 / 12=30.92</td>
<td colspan="2">(1.42)</td>
<td colspan="2">Less</td>
<td></td>
</tr>
<tr class="even">
<td>47</td>
<td>353 / 12=29.42</td>
<td>372 / 12=31.00</td>
<td colspan="2">(1.58)</td>
<td colspan="2">Less</td>
<td></td>
</tr>
<tr class="odd">
<td>48</td>
<td>366 / 12=30.50</td>
<td>350 / 12=29.92</td>
<td colspan="2">.58</td>
<td colspan="2">Less</td>
<td></td>
</tr>
<tr class="even">
<td>49</td>
<td>364 / 12=30.53</td>
<td>361 / 12=30.08</td>
<td colspan="2">.25</td>
<td colspan="2">Less</td>
<td></td>
</tr>
<tr class="odd">
<td>50</td>
<td>370 / 12=30.83</td>
<td>355 / 12=29.58</td>
<td colspan="2">1.25</td>
<td colspan="2">Less</td>
<td></td>
</tr>
</tbody>
</table>
</div>
<p><a href="#tbl-eg-pigs-measured" class="quarto-xref">Table&nbsp;<span>24.2</span></a> shows fifty trials of which only one (the thirty-ninth) is as “far out” as the observed samples. These data give us an estimate of the probability that, if the two foods come from the same universe, a difference this great or greater would occur just by chance. (Compare this 2 percent estimate with the probability of roughly 1 percent estimated with the conventional <em>t</em> test — a “significance level” of 1 percent.) On the average, the test described in this section yields a significance level as high as such mathematical-probability tests as the <em>t</em> test — that is, it is just as efficient — though the tests described in the examples of <a href="testing_counts_1.html#sec-pig-rations" class="quarto-xref"><span>Section&nbsp;21.2.7</span></a> and <a href="testing_counts_2.html#sec-pig-pairs" class="quarto-xref"><span>Section&nbsp;23.2.1</span></a> are likely to be less efficient because they convert measured data to ranked or classified data. <a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a></p>
<p>It is <em>not</em> appropriate to say that these data give us an estimate of the probability that the foods “do not come” from the same universe. This is because we can <em>never</em> state a probability that a sample came from a given universe unless the alternatives are fully specified in advance.<a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a></p>
<p>This example also illustrates how the <em>dispersion within samples</em> affects the difficulty of finding out whether the samples differ from each other. For example, the average weight gain for food A was 32 pounds, versus 29 pounds for food B. If <em>all</em> the food A-fed pigs had gained weight within a range of say 29.9 and 30.1 pounds, and if all the food B-fed pigs had gained weight within a range of 28.9 and 29.1 pounds — that is, if the highest weight gain in food B had been lower than the lowest weight gain in food A — then there would be no question that food A is better, and even fewer observations would have made this statistically conclusive. Variation (dispersion) is thus of great importance in statistics and in the social sciences. The larger the dispersion among the observations <em>within</em> the samples, the larger the <em>sample size</em> necessary to make a conclusive comparison between two groups or reliable estimates of summarization statistics. (The dispersion might be measured by the mean absolute deviation (the average absolute difference between the mean and the individual observations, treating both plus and minus differences as positive), the variance (the average <em>squared</em> difference between the mean and the observations), the standard deviation (the square root of the variance), the range (the difference between the smallest and largest observations), or some other device.)</p>
<!---
Lots about dispersion here.  Needs better introduction?
-->
<p>If you are performing your tests by hand rather than using a computer (a good exercise even nowadays when computers are so accessible), you might prefer to work with the median instead of the mean, because the median requires less computation. (The median also has the advantage of being less influenced by a single far-out observation that might be quite atypical; all measures have their special advantages and disadvantages.) Simply compare the difference in medians of the twelve-pig resamples to the difference in medians of the actual samples, just as was done with the means. The only operational difference is to substitute the word “median” for the word “mean” in the steps listed above. You may need a somewhat larger number of trials when working with medians, however, for they tend to be less precise than means.</p>
<!---
Discussion of bootstrap and median?
-->
<p>The R notebook compares the difference in the sums of the weight gains for the actual pigs against the difference resulting from two randomly-chosen groups of pigs, using the same numerical weight gains of individual pigs as were obtained in the actual experiment. If the differences in average weight gains of the randomly ordered groups are rarely as large as the difference in weight gains from the actual sets of pigs fed food A-alpha and food B-beta, then we can conclude that the foods do make a difference in pigs’ weight gains.</p>
<p>Note first that pigs in group A gained a total of 382 pounds while group B gained a total of 344 pounds — 38 fewer. To minimize computations, we will deal with totals like these, not averages.</p>
<p>First we construct vectors A and B of the weight gains of the pigs fed with the two foods. Then we combine the two vectors into one long vector and select two groups of 12 randomly and with replacement (the two <code>sample</code> commands). Notice we sample <em>with replacement</em>. This is the <em>bootstrap</em> procedure*, where we simulate new samples by resampling with replacement from the original sample. We <code>sum</code> the weight gains for the two resamples, and calculate the difference. We keep track of those differences by storing them in the <code>results</code> array, graph them on a histogram, and see how many times resample A exceeded resample B by at least 38 pounds, or vice versa (we are testing whether the two are different, not whether food A produces larger weight gains).</p>
<div class="notebook" name="measured_rations" title="Pig rations via bootstrap">
<p>Start of <code>measured_rations</code> notebook</p>
<div class="nb-links">
<a class="notebook-link" href="notebooks/measured_rations.Rmd">Download notebook</a>
<a class="interact-button" href="https://mybinder.org/v2/gh/resampling-stats/resampling-with/gh-pages?filepath=r-book/notebooks/measured_rations.Rmd">Interact</a>
</div>

<p>First we need to get the measured data from the data file using <span class="r">R</span>:</p>
<p>We load the file containing the data:</p>
<div class="cell" data-layout-align="center" data-hash="testing_measured_cache/html/unnamed-chunk-4_97afe03e6e637e6151f0dc3c1bdb2cbf">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Read the data file containing pig ration data.</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>rations_df <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">'data/pig_rations.csv'</span>)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Show the first 6 rows.</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(rations_df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  ration weight_gain
1      A          31
2      A          34
3      A          29
4      A          26
5      A          32
6      A          35</code></pre>
</div>
</div>
<p>Let us first select the rows containing data for ration B (we will get the rows for ration A afterwards):</p>
<div class="cell" data-layout-align="center" data-hash="testing_measured_cache/html/unnamed-chunk-6_38ceefe604a0cd481cb750f72a5f00b9">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Select ration B rows.</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>ration_b_df <span class="ot">&lt;-</span> <span class="fu">subset</span>(rations_df, rations_df[<span class="st">'ration'</span>] <span class="sc">==</span> <span class="st">'B'</span>)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="co">#  Show the first six rows.</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(ration_b_df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   ration weight_gain
13      B          26
14      B          24
15      B          28
16      B          29
17      B          30
18      B          29</code></pre>
</div>
</div>
<p>Finally for ration B, convert the weights to a vector for use in the simulation.</p>
<div class="cell" data-layout-align="center" data-hash="testing_measured_cache/html/unnamed-chunk-8_d5e1f503b96c591a9076fa9956c949aa">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>b_weights <span class="ot">&lt;-</span> ration_b_df<span class="sc">$</span>weight_gain</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Show the result.</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>b_weights</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] 26 24 28 29 30 29 31 29 32 26 28 32</code></pre>
</div>
</div>
<p>Select ration A rows, and get the weights as a vector:</p>
<div class="cell" data-layout-align="center" data-hash="testing_measured_cache/html/unnamed-chunk-10_a786052d7caaea60d6d99ad68dcf2768">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>ration_a_df <span class="ot">&lt;-</span> <span class="fu">subset</span>(rations_df, rations_df[<span class="st">'ration'</span>] <span class="sc">==</span> <span class="st">'A'</span>)</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>a_weights <span class="ot">&lt;-</span> ration_a_df<span class="sc">$</span>weight_gain</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Show the result.</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>a_weights</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] 31 34 29 26 32 35 38 34 31 29 32 31</code></pre>
</div>
</div>
<p>We will use the <code>a_weights</code> and <code>b_weights</code> vectors for our simulation. We are going to shuffle these weights, so we first <em>concatenate</em> the two vectors (see <a href="probability_theory_3.html#sec-concatenate" class="quarto-xref"><span>Section&nbsp;12.16.1</span></a>) so we can shuffle them:</p>
<div class="cell" data-layout-align="center" data-hash="testing_measured_cache/html/unnamed-chunk-12_8bf6f9097dc8e1ec60e1f13fdf99210b">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>both <span class="ot">&lt;-</span> <span class="fu">c</span>(a_weights, b_weights)</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>both</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] 31 34 29 26 32 35 38 34 31 29 32 31 26 24 28 29 30 29 31 29 32 26 28 32</code></pre>
</div>
</div>
<p>Now do the simulation:</p>
<div class="cell" data-layout-align="center" data-hash="testing_measured_cache/html/unnamed-chunk-14_903b94e24f1754651974e7f4747d0a31">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Set the number of trials</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>n_trials <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a><span class="co"># An empty array to store the trial results.</span></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>results <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n_trials)</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Do 10,000 experiments.</span></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n_trials) {</span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Take a "resample" of 12 with replacement from both and put it in fake_a</span></span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>    fake_a <span class="ot">&lt;-</span> <span class="fu">sample</span>(both, <span class="at">size=</span><span class="dv">12</span>, <span class="at">replace=</span><span class="cn">TRUE</span>)</span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Likewise to make fake_b</span></span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a>    fake_b <span class="ot">&lt;-</span> <span class="fu">sample</span>(both, <span class="at">size=</span><span class="dv">12</span>, <span class="at">replace=</span><span class="cn">TRUE</span>)</span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Sum the first "resample."</span></span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a>    fake_a_sum <span class="ot">&lt;-</span> <span class="fu">sum</span>(fake_a)</span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Sum the second "resample."</span></span>
<span id="cb11-16"><a href="#cb11-16" aria-hidden="true" tabindex="-1"></a>    fake_b_sum <span class="ot">&lt;-</span> <span class="fu">sum</span>(fake_b)</span>
<span id="cb11-17"><a href="#cb11-17" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Calculate the difference between the two resamples.</span></span>
<span id="cb11-18"><a href="#cb11-18" aria-hidden="true" tabindex="-1"></a>    fake_diff <span class="ot">&lt;-</span> fake_a_sum <span class="sc">-</span> fake_b_sum</span>
<span id="cb11-19"><a href="#cb11-19" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Keep track of each trial result.</span></span>
<span id="cb11-20"><a href="#cb11-20" aria-hidden="true" tabindex="-1"></a>    results[i] <span class="ot">&lt;-</span> fake_diff</span>
<span id="cb11-21"><a href="#cb11-21" aria-hidden="true" tabindex="-1"></a>    <span class="co"># End one experiment, go back and repeat until all trials are complete,</span></span>
<span id="cb11-22"><a href="#cb11-22" aria-hidden="true" tabindex="-1"></a>    <span class="co"># then proceed.</span></span>
<span id="cb11-23"><a href="#cb11-23" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb11-24"><a href="#cb11-24" aria-hidden="true" tabindex="-1"></a><span class="co"># Produce a histogram of trial results.</span></span>
<span id="cb11-25"><a href="#cb11-25" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(results, <span class="at">breaks=</span><span class="dv">25</span>,</span>
<span id="cb11-26"><a href="#cb11-26" aria-hidden="true" tabindex="-1"></a>      <span class="at">xlab=</span><span class="st">'Second resample minus first'</span>,</span>
<span id="cb11-27"><a href="#cb11-27" aria-hidden="true" tabindex="-1"></a>      <span class="at">main=</span><span class="st">'Distribution difference in sums of resamples'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="testing_measured_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid figure-img" style="width:70.0%"></p>
</figure>
</div>
</div>
</div>
<p>From this histogram we see that a very small proportion of the trials produced a difference between groups as large as that observed (or larger). R will calculate this for us with the following code:</p>
<div class="cell" data-layout-align="center" data-hash="testing_measured_cache/html/unnamed-chunk-16_2507c08356243af7b917cbd773f4b817">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Determine how many of the trials produced a difference between resamples.</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>count_more <span class="ot">&lt;-</span> <span class="fu">sum</span>(results <span class="sc">&gt;=</span> <span class="dv">38</span>)</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Likewise for a difference of -38.</span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>count_less <span class="ot">&lt;-</span> <span class="fu">sum</span>(results <span class="sc">&lt;=</span> <span class="sc">-</span><span class="dv">38</span>)</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Add the two together.</span></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>k <span class="ot">=</span> count_more <span class="sc">+</span> count_less</span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Divide by number of trials to convert to proportion.</span></span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>kk <span class="ot">=</span> k <span class="sc">/</span> n_trials</span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the result.</span></span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a><span class="fu">message</span>(<span class="st">'Proportion of trials with either &gt;=38 or &lt;=-38: '</span>, kk)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Proportion of trials with either &gt;=38 or &lt;=-38: 0.012</code></pre>
</div>
</div>
<p>End of <code>measured_rations</code> notebook</p>
</div>
<!---
End of notebook
-->
</section>
<section id="sec-liquor-public-measured" class="level3" data-number="24.0.2">
<h3 data-number="24.0.2" class="anchored" data-anchor-id="sec-liquor-public-measured"><span class="header-section-number">24.0.2</span> Example: Is There a Difference in Liquor Prices Between State-Run and Privately-Run Systems?</h3>
<p>This is an example of <strong>testing for differences between means of unequal-sized samples of measured data</strong>.</p>
<p>In the 1960s I (JLS) studied the price of liquor in the sixteen “monopoly” states (where the state government owns the retail liquor stores) compared to the twenty-six states in which retail liquor stores are privately owned. (Some states were omitted for technical reasons. And it is interesting to note that the situation and the price pattern has changed radically since then.) These data were introduced in the context of a problem in probability in <a href="probability_theory_3.html#sec-public-liquor" class="quarto-xref"><span>Section&nbsp;12.16</span></a>.</p>
<p><a href="#tbl-whiskey-prices2" class="quarto-xref">Table&nbsp;<span>24.3</span></a> is the same as the matching table in <a href="probability_theory_3.html#sec-public-liquor" class="quarto-xref"><span>Section&nbsp;12.16</span></a>. They show the representative 1961 prices of a fifth of Seagram 7 Crown whiskey in the two sets of states:<a href="#fn3" class="footnote-ref" id="fnref3" role="doc-noteref"><sup>3</sup></a></p>
<div class="cell" data-layout-align="center" data-hash="testing_measured_cache/html/unnamed-chunk-17_b8c97cf2f3f5a27785c95d1aa6fd7efc">
<div id="tbl-whiskey-prices2" class="anchored">
<table class="table table-sm table-striped small">
<caption>Table&nbsp;24.3: Whiskey prices by state category</caption>
<colgroup>
<col style="width: 16%">
<col style="width: 16%">
<col style="width: 20%">
</colgroup>
<thead>
<tr class="header">
<th></th>
<th>Private</th>
<th>Government</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td></td>
<td>4.82</td>
<td>4.65</td>
</tr>
<tr class="even">
<td></td>
<td>5.29</td>
<td>4.55</td>
</tr>
<tr class="odd">
<td></td>
<td>4.89</td>
<td>4.11</td>
</tr>
<tr class="even">
<td></td>
<td>4.95</td>
<td>4.15</td>
</tr>
<tr class="odd">
<td></td>
<td>4.55</td>
<td>4.2</td>
</tr>
<tr class="even">
<td></td>
<td>4.9</td>
<td>4.55</td>
</tr>
<tr class="odd">
<td></td>
<td>5.25</td>
<td>3.8</td>
</tr>
<tr class="even">
<td></td>
<td>5.3</td>
<td>4.0</td>
</tr>
<tr class="odd">
<td></td>
<td>4.29</td>
<td>4.19</td>
</tr>
<tr class="even">
<td></td>
<td>4.85</td>
<td>4.75</td>
</tr>
<tr class="odd">
<td></td>
<td>4.54</td>
<td>4.74</td>
</tr>
<tr class="even">
<td></td>
<td>4.75</td>
<td>4.5</td>
</tr>
<tr class="odd">
<td></td>
<td>4.85</td>
<td>4.1</td>
</tr>
<tr class="even">
<td></td>
<td>4.85</td>
<td>4.0</td>
</tr>
<tr class="odd">
<td></td>
<td>4.5</td>
<td>5.05</td>
</tr>
<tr class="even">
<td></td>
<td>4.75</td>
<td>4.2</td>
</tr>
<tr class="odd">
<td></td>
<td>4.79</td>
<td></td>
</tr>
<tr class="even">
<td></td>
<td>4.85</td>
<td></td>
</tr>
<tr class="odd">
<td></td>
<td>4.79</td>
<td></td>
</tr>
<tr class="even">
<td></td>
<td>4.95</td>
<td></td>
</tr>
<tr class="odd">
<td></td>
<td>4.95</td>
<td></td>
</tr>
<tr class="even">
<td></td>
<td>4.75</td>
<td></td>
</tr>
<tr class="odd">
<td></td>
<td>5.2</td>
<td></td>
</tr>
<tr class="even">
<td></td>
<td>5.1</td>
<td></td>
</tr>
<tr class="odd">
<td></td>
<td>4.8</td>
<td></td>
</tr>
<tr class="even">
<td></td>
<td>4.29</td>
<td></td>
</tr>
<tr class="odd">
<td></td>
<td></td>
<td></td>
</tr>
<tr class="even">
<td><strong>Count</strong></td>
<td>26</td>
<td>16</td>
</tr>
<tr class="odd">
<td><strong>Mean</strong></td>
<td>4.84</td>
<td>4.35</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>The <em>economic</em> question that underlay the investigation — having both theoretical and policy ramifications — is as follows: Does state ownership affect prices? The <em>empirical</em> question is whether the prices in the two sets of states were systematically different. In <em>statistical</em> terms, we wish to test the hypothesis that there was a difference between the groups of states related to their mode of liquor distribution, or whether the observed $.49 differential in means might well have occurred by happenstance. In other words, we want to know whether the two sub-groups of states differed systematically in their liquor prices, or whether the observed pattern could well have been produced by chance variability.</p>
<p>The first step is to examine the two sets of data graphically to see whether there was such a clear-cut difference between them — of the order of Snow’s data on cholera, or the Japanese Navy data on beri-beri — that no test was necessary. The separate displays, and then the two combined together, are shown in <a href="#fig-whiskey-hist2" class="quarto-xref">Figure&nbsp;<span>24.3</span></a>; the answer is not clear-cut and hence a formal test is necessary.</p>

<!---
Refer back to @sec-inference-ideas tables 11.3 and 11.4.
-->
<div class="cell" data-layout-align="center" data-opts.label="svg_fig" data-hash="testing_measured_cache/html/fig-whiskey-hist2_6efb81fcfe53590777c795a1e3b755de">
<div class="cell-output-display">
<div id="fig-whiskey-hist2" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="testing_measured_files/figure-html/fig-whiskey-hist2-1.png" class="img-fluid figure-img" style="width:70.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;24.3: Whiskey prices by state category</figcaption>
</figure>
</div>
</div>
</div>
<p>At first I used a resampling permutation test as follows: Assuming that the entire universe of possible prices consists of the set of events that were observed, because that is all the information available about the universe, I wrote each of the forty-two observed state prices on a separate card. The shuffled deck simulated a situation in which each state has an equal chance for each price.</p>
<p>On the “null hypothesis” that the two groups’ prices do <em>not</em> reflect different price-setting mechanisms, but rather differ only by chance, I then examined how often that simulated universe stochastically produces groups with results as different as observed in 1961. I repeatedly dealt groups of 16 and 26 cards, without replacing the cards, to simulate hypothetical monopoly-state and private-state samples, each time calculating the difference in mean prices.</p>
<p>The probability that the benchmark null-hypothesis universe would produce a difference between groups as large or larger than observed in 1961 is estimated by how frequently the mean of the group of randomly-chosen sixteen prices from the simulated state-ownership universe is less than (or equal to) the mean of the actual sixteen state-ownership prices. If the simulated difference between the randomly-chosen groups was frequently equal to or greater than observed in 1961, one would not conclude that the observed difference was due to the type of retailing system because it could well have been due to chance variation.</p>
<p>Here is that procedure as <span class="r">an R</span> notebook. Compare to the very similar bootstrap procedure in <a href="probability_theory_3.html#sec-public-liquor" class="quarto-xref"><span>Section&nbsp;12.16</span></a>.</p>
<div class="notebook" name="liquor_permutation" title="Permutation test of public and private liquor prices">
<p>Start of <code>liquor_permutation</code> notebook</p>
<div class="nb-links">
<a class="notebook-link" href="notebooks/liquor_permutation.Rmd">Download notebook</a>
<a class="interact-button" href="https://mybinder.org/v2/gh/resampling-stats/resampling-with/gh-pages?filepath=r-book/notebooks/liquor_permutation.Rmd">Interact</a>
</div>

<div class="cell" data-layout-align="center" data-hash="testing_measured_cache/html/unnamed-chunk-20_38e960cbaf5fdfdfdb55c77da91bdbad">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load the data from a data file.</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>prices_df <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">'data/liquor_prices.csv'</span>)</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Show this first six rows.</span></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(prices_df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  state_type price
1    private  4.82
2    private  5.29
3    private  4.89
4    private  4.95
5    private  4.55
6    private  4.90</code></pre>
</div>
</div>
<p>Take all prices from the loaded data file, and convert into a vectors for each category.</p>
<div class="cell" data-layout-align="center" data-hash="testing_measured_cache/html/unnamed-chunk-23_38295cb05a41823b300621cb7be4f8f0">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Rows for private prices.</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>priv_df <span class="ot">&lt;-</span> <span class="fu">subset</span>(prices_df, prices_df[<span class="st">'state_type'</span>] <span class="sc">==</span> <span class="st">'private'</span>)</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert corresponding prices to vector.</span></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>priv <span class="ot">&lt;-</span> priv_df<span class="sc">$</span>price</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Show the result.</span></span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>priv</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] 4.82 5.29 4.89 4.95 4.55 4.90 5.25 5.30 4.29 4.85 4.54 4.75 4.85 4.85 4.50
[16] 4.75 4.79 4.85 4.79 4.95 4.95 4.75 5.20 5.10 4.80 4.29</code></pre>
</div>
</div>
<div class="cell" data-layout-align="center" data-hash="testing_measured_cache/html/unnamed-chunk-24_bb5703c5c58dc7023c5731d88b28c67f">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Rows for government prices.</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>govt_df <span class="ot">&lt;-</span> <span class="fu">subset</span>(prices_df, prices_df[<span class="st">'state_type'</span>] <span class="sc">==</span> <span class="st">'government'</span>)</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert corresponding prices to vector.</span></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>govt <span class="ot">=</span> govt_df<span class="sc">$</span>price</span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Show the result.</span></span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>govt</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] 4.65 4.55 4.11 4.15 4.20 4.55 3.80 4.00 4.19 4.75 4.74 4.50 4.10 4.00 5.05
[16] 4.20</code></pre>
</div>
</div>
<p>Calculate actual difference:</p>
<div class="cell" data-layout-align="center" data-hash="testing_measured_cache/html/unnamed-chunk-26_d44bf802e32c037afa1dd55360219ad2">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>actual_diff <span class="ot">&lt;-</span> <span class="fu">mean</span>(priv) <span class="sc">-</span> <span class="fu">mean</span>(govt)</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>actual_diff</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.492</code></pre>
</div>
</div>
<p>Concatenate the private and government values into one vector:</p>
<div class="cell" data-layout-align="center" data-hash="testing_measured_cache/html/unnamed-chunk-28_e3dae104f870f0deb95f92bb1a916548">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Join the two vectors of data into one vector.</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>both <span class="ot">&lt;-</span> <span class="fu">c</span>(priv, govt)</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>both</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] 4.82 5.29 4.89 4.95 4.55 4.90 5.25 5.30 4.29 4.85 4.54 4.75 4.85 4.85 4.50
[16] 4.75 4.79 4.85 4.79 4.95 4.95 4.75 5.20 5.10 4.80 4.29 4.65 4.55 4.11 4.15
[31] 4.20 4.55 3.80 4.00 4.19 4.75 4.74 4.50 4.10 4.00 5.05 4.20</code></pre>
</div>
</div>
<p>Do simulation:</p>
<div class="cell" data-layout-align="center" data-hash="testing_measured_cache/html/unnamed-chunk-30_ef01618653c20e6bd9dcf4eb1ede85a1">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>n_trials <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Fake differences for each trial.</span></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>results <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n_trials)</span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Repeat 10000 simulation trials</span></span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10000</span>) {</span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Shuffle 42 values to a random order.</span></span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a>    shuffled <span class="ot">=</span> <span class="fu">sample</span>(both)</span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Take first 26 shuffled values as fake private group</span></span>
<span id="cb24-13"><a href="#cb24-13" aria-hidden="true" tabindex="-1"></a>    fake_priv <span class="ot">=</span> shuffled[<span class="dv">1</span><span class="sc">:</span><span class="dv">26</span>]</span>
<span id="cb24-14"><a href="#cb24-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-15"><a href="#cb24-15" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Remaining values (from position 27 to end, 16 values)</span></span>
<span id="cb24-16"><a href="#cb24-16" aria-hidden="true" tabindex="-1"></a>    <span class="co"># form the fake government group.</span></span>
<span id="cb24-17"><a href="#cb24-17" aria-hidden="true" tabindex="-1"></a>    fake_govt <span class="ot">=</span> shuffled[<span class="dv">27</span><span class="sc">:</span><span class="dv">42</span>]</span>
<span id="cb24-18"><a href="#cb24-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-19"><a href="#cb24-19" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Find the mean of the "private" group.</span></span>
<span id="cb24-20"><a href="#cb24-20" aria-hidden="true" tabindex="-1"></a>    p <span class="ot">&lt;-</span> <span class="fu">mean</span>(fake_priv)</span>
<span id="cb24-21"><a href="#cb24-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-22"><a href="#cb24-22" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Mean of the "govt." group</span></span>
<span id="cb24-23"><a href="#cb24-23" aria-hidden="true" tabindex="-1"></a>    g <span class="ot">&lt;-</span> <span class="fu">mean</span>(fake_govt)</span>
<span id="cb24-24"><a href="#cb24-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-25"><a href="#cb24-25" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Difference in the means</span></span>
<span id="cb24-26"><a href="#cb24-26" aria-hidden="true" tabindex="-1"></a>    diff <span class="ot">&lt;-</span> p <span class="sc">-</span> g</span>
<span id="cb24-27"><a href="#cb24-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-28"><a href="#cb24-28" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Keep score of the trials</span></span>
<span id="cb24-29"><a href="#cb24-29" aria-hidden="true" tabindex="-1"></a>    results[i] <span class="ot">&lt;-</span> diff</span>
<span id="cb24-30"><a href="#cb24-30" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb24-31"><a href="#cb24-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-32"><a href="#cb24-32" aria-hidden="true" tabindex="-1"></a><span class="co"># Graph of simulation results to compare with the observed result.</span></span>
<span id="cb24-33"><a href="#cb24-33" aria-hidden="true" tabindex="-1"></a>fig_title <span class="ot">&lt;-</span> <span class="fu">paste</span>(<span class="st">'Average price difference (Actual difference = '</span>,</span>
<span id="cb24-34"><a href="#cb24-34" aria-hidden="true" tabindex="-1"></a>                   <span class="fu">round</span>(actual_diff <span class="sc">*</span> <span class="dv">100</span>),</span>
<span id="cb24-35"><a href="#cb24-35" aria-hidden="true" tabindex="-1"></a>                   <span class="st">'cents'</span>)</span>
<span id="cb24-36"><a href="#cb24-36" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(results, <span class="at">main=</span>fig_title, <span class="at">xlab=</span><span class="st">'Difference in average prices (cents)'</span>)</span>
<span id="cb24-37"><a href="#cb24-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-38"><a href="#cb24-38" aria-hidden="true" tabindex="-1"></a><span class="co"># Number of trials where fake difference &gt;= actual.</span></span>
<span id="cb24-39"><a href="#cb24-39" aria-hidden="true" tabindex="-1"></a>k <span class="ot">=</span> <span class="fu">sum</span>(results <span class="sc">&gt;=</span> actual_diff)</span>
<span id="cb24-40"><a href="#cb24-40" aria-hidden="true" tabindex="-1"></a>kk <span class="ot">=</span> k <span class="sc">/</span> n_trials</span>
<span id="cb24-41"><a href="#cb24-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-42"><a href="#cb24-42" aria-hidden="true" tabindex="-1"></a><span class="fu">message</span>(<span class="st">'Proportion fake differences &lt;= actual_difference: '</span>, kk)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Proportion fake differences &lt;= actual_difference: 0</code></pre>
</div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="testing_measured_files/figure-html/unnamed-chunk-30-1.png" class="img-fluid figure-img" style="width:70.0%"></p>
</figure>
</div>
</div>
</div>
<p>End of <code>liquor_permutation</code> notebook</p>
</div>
<!---
End of liquor_permutation notebook.
-->
<p>The result — about zero percent of the simulations generated a value as large or larger than the actual difference — implies that there is a very small probability that two groups with mean prices as different as were observed would happen by chance if drawn from the universe of 42 observed prices. So we “reject the null hypothesis” and instead find persuasive the proposition that the type of liquor distribution system influences the prices that consumers pay.<a href="#fn4" class="footnote-ref" id="fnref4" role="doc-noteref"><sup>4</sup></a></p>
<p>The logical framework of this resampling version of the permutation test differs greatly from the formulaic version, which relies on some sophisticated mathematics. The formula-method alternative would be the <a href="https://en.wikipedia.org/wiki/Student's_t-test">Student’s t-test</a>, in which the user simply plugs into an unintuitive formula and reads the result from a table.</p>
<!---
Discussion of t-test?  Have we introduced the t-test?
-->
<p>A R program to handle the liquor problem with an infinite-universe bootstrap distribution simply substitutes the random sampling command <code>sample</code> for the commands to do shuffling and splitting above. The results of the bootstrap test are indistinguishable from those in the permutation version of the program above — see: <a href="probability_theory_3.html#sec-public-liquor" class="quarto-xref"><span>Section&nbsp;12.16</span></a>.</p>
<p>Still another difficult question is whether <em>any</em> hypothesis test is appropriate, because the states were not randomly selected for inclusion in one group or another, and the results could be caused by factors other than the liquor system; this applies to both the above methods. The states constitute the entire universe in which we are interested, rather than being a sample taken from some larger universe as with a biological experiment or a small survey sample. But this objection pertains to a conventional test as well as to resampling methods. And a similar question arises throughout medical and social science — to the two water suppliers between which John Snow detected vast differences in cholera rates, to rates of lung cancer in human smokers, to analyses of changes in speeding laws, and so on.</p>
<p>The appropriate question is not whether the units were assigned randomly, however, but whether there is strong reason to believe that the results are not meaningful because they are the result of a <em>particular</em> “hidden” variable.</p>
<p>These debates about fundamentals illustrate the unsettled state of statistical thinking about basic issues. Other disciplines also have their controversies about fundamentals. But in statistics these issues arise as early as the introductory course, because all but the most contrived problems are shot through with these questions. Instructors and researchers usually gloss over these matters, as Gigerenzer et al., show ( <em>The Empire of Chance</em> ). Again, because with resampling one does not become immersed in the difficult mathematical techniques that underlie conventional methods, one is quicker to see these difficult questions, which apply equally to conventional methods and resampling.</p>
<!---
Discussion of fogginess that arises from uncertainty about maths.
-->
</section>
<section id="example-is-there-a-difference-between-treatments-to-prevent-low-birthweights" class="level3" data-number="24.0.3">
<h3 data-number="24.0.3" class="anchored" data-anchor-id="example-is-there-a-difference-between-treatments-to-prevent-low-birthweights"><span class="header-section-number">24.0.3</span> Example: Is there a difference between treatments to prevent low birthweights?</h3>
<p>Next we consider the use of resampling with <em>measured</em> data to test the hypothesis that drug A prevents low birthweights <span class="citation" data-cites="rosner1995biostatistics">(<a href="references.html#ref-rosner1995biostatistics" role="doc-biblioref">Rosner 1995, 291</a>)</span>. The data for the treatment and control groups are shown in <a href="#tbl-birthweights" class="quarto-xref">Table&nbsp;<span>24.4</span></a>.</p>
<div class="cell" data-layout-align="center" data-hash="testing_measured_cache/html/unnamed-chunk-31_8244129c6b92fac4f36db008e7685b98">
<div class="cell-output-display">
<div id="tbl-birthweights" class="anchored">
<table class="lightable-paper lightable-striped lightable-hover table table-sm table-striped small" data-quarto-postprocess="true">
<caption>Table&nbsp;24.4: Birthweights in clinical trial for drug to prevent low birthweights </caption>
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">Treatment</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Birthweight</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Drug A</td>
<td style="text-align: right;">6.9</td>
</tr>
<tr class="even">
<td style="text-align: left;">Drug A</td>
<td style="text-align: right;">7.6</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Drug A</td>
<td style="text-align: right;">7.3</td>
</tr>
<tr class="even">
<td style="text-align: left;">Drug A</td>
<td style="text-align: right;">7.6</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Drug A</td>
<td style="text-align: right;">6.8</td>
</tr>
<tr class="even">
<td style="text-align: left;">Drug A</td>
<td style="text-align: right;">7.2</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Drug A</td>
<td style="text-align: right;">8.0</td>
</tr>
<tr class="even">
<td style="text-align: left;">Drug A</td>
<td style="text-align: right;">5.5</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Drug A</td>
<td style="text-align: right;">5.8</td>
</tr>
<tr class="even">
<td style="text-align: left;">Drug A</td>
<td style="text-align: right;">7.3</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Drug A</td>
<td style="text-align: right;">8.2</td>
</tr>
<tr class="even">
<td style="text-align: left;">Drug A</td>
<td style="text-align: right;">6.9</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Drug A</td>
<td style="text-align: right;">6.8</td>
</tr>
<tr class="even">
<td style="text-align: left;">Drug A</td>
<td style="text-align: right;">5.7</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Drug A</td>
<td style="text-align: right;">8.6</td>
</tr>
<tr class="even">
<td style="text-align: left;">Control</td>
<td style="text-align: right;">6.4</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Control</td>
<td style="text-align: right;">6.7</td>
</tr>
<tr class="even">
<td style="text-align: left;">Control</td>
<td style="text-align: right;">5.4</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Control</td>
<td style="text-align: right;">8.2</td>
</tr>
<tr class="even">
<td style="text-align: left;">Control</td>
<td style="text-align: right;">5.3</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Control</td>
<td style="text-align: right;">6.6</td>
</tr>
<tr class="even">
<td style="text-align: left;">Control</td>
<td style="text-align: right;">5.8</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Control</td>
<td style="text-align: right;">5.7</td>
</tr>
<tr class="even">
<td style="text-align: left;">Control</td>
<td style="text-align: right;">6.2</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Control</td>
<td style="text-align: right;">7.1</td>
</tr>
<tr class="even">
<td style="text-align: left;">Control</td>
<td style="text-align: right;">7.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Control</td>
<td style="text-align: right;">6.9</td>
</tr>
<tr class="even">
<td style="text-align: left;">Control</td>
<td style="text-align: right;">5.6</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Control</td>
<td style="text-align: right;">4.2</td>
</tr>
<tr class="even">
<td style="text-align: left;">Control</td>
<td style="text-align: right;">6.8</td>
</tr>
</tbody>
</table>
</div>


</div>
</div>
<p>The treatment group averaged .82 pounds more than the control group (<a href="#tbl-birth-means" class="quarto-xref">Table&nbsp;<span>24.5</span></a>):</p>
<div class="cell" data-layout-align="center" data-hash="testing_measured_cache/html/unnamed-chunk-32_e3f42be6938a57e4b373ef268d23042a">
<div class="cell-output-display">
<div id="tbl-birth-means" class="anchored">
<table class="lightable-paper lightable-striped lightable-hover table table-sm table-striped small" data-quarto-postprocess="true">
<caption>Table&nbsp;24.5: Mean birthweight per group</caption>
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th"></th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Mean birthweight</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Control</td>
<td style="text-align: right;">6.26</td>
</tr>
<tr class="even">
<td style="text-align: left;">Drug A</td>
<td style="text-align: right;">7.08</td>
</tr>
</tbody>
</table>
</div>


</div>
</div>
<p>Here is a resampling approach to the problem:</p>
<ol type="1">
<li>If the drug has no effect, our best guess about the “universe” of birthweights is that it is composed of (say) a million each of the observed weights, all lumped together. In other words, in the absence of any other information or compelling theory, we assume that the combination of our samples is our best estimate of the universe. Hence let us write each of the birthweights on a card, and put them into a hat. Drawing them one by one and then replacing them is the operational equivalent of a very large (but equal) number of each birthweight.</li>
<li>Repeatedly draw two samples of 15 birthweights each, and check how frequently the observed difference is as large as, or larger than, the actual difference of .82 pounds.</li>
</ol>
<p>This is the so-called bootstrap test of the null-hypothesis.</p>
<div class="notebook" name="birthweight_bootstap" title="Bootstrap test of birthweight difference">
<p>Start of <code>birthweight_bootstap</code> notebook</p>
<div class="nb-links">
<a class="notebook-link" href="notebooks/birthweight_bootstap.Rmd">Download notebook</a>
<a class="interact-button" href="https://mybinder.org/v2/gh/resampling-stats/resampling-with/gh-pages?filepath=r-book/notebooks/birthweight_bootstap.Rmd">Interact</a>
</div>

<p>Proceed with the simulation:</p>
<div class="cell" data-layout-align="center" data-hash="testing_measured_cache/html/unnamed-chunk-35_6d1f62557dba8d0db003305639247392">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Get treatment and control values from data file.</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>birth_df <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">'data/birthweights.csv'</span>)</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Birthweidhts for Drug A participants.</span></span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>treat_df <span class="ot">&lt;-</span> <span class="fu">subset</span>(birth_df, birth_df<span class="sc">$</span>Treatment <span class="sc">==</span> <span class="st">'Drug A'</span>)</span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Birthweigts as vector.</span></span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>treat <span class="ot">&lt;-</span> treat_df<span class="sc">$</span>Birthweight</span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Control birthweights.</span></span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a>control_df <span class="ot">&lt;-</span> <span class="fu">subset</span>(birth_df, birth_df<span class="sc">$</span>Treatment <span class="sc">==</span> <span class="st">'Control'</span>)</span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Birthweigts as vector.</span></span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a>control <span class="ot">&lt;-</span> control_df<span class="sc">$</span>Birthweight</span>
<span id="cb26-11"><a href="#cb26-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-12"><a href="#cb26-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Actual difference.</span></span>
<span id="cb26-13"><a href="#cb26-13" aria-hidden="true" tabindex="-1"></a>actual_diff <span class="ot">&lt;-</span> <span class="fu">mean</span>(treat) <span class="sc">-</span> <span class="fu">mean</span>(control)</span>
<span id="cb26-14"><a href="#cb26-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Show the actual difference.</span></span>
<span id="cb26-15"><a href="#cb26-15" aria-hidden="true" tabindex="-1"></a>actual_diff</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.82</code></pre>
</div>
</div>
<p>Proceed with the simulation:</p>
<div class="cell" data-layout-align="center" data-hash="testing_measured_cache/html/unnamed-chunk-36_d765dcd493158cb935560f42bb2b2c3e">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Concatenate treatment and control vectors.</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>both <span class="ot">&lt;-</span> <span class="fu">c</span>(treat, control)</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Number of trials.</span></span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>n_trials <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Make vector to store results for each trial.</span></span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a>results <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n_trials)</span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Do 10000 simulations</span></span>
<span id="cb28-11"><a href="#cb28-11" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n_trials) {</span>
<span id="cb28-12"><a href="#cb28-12" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Take a resample of 15 from all birth weights.</span></span>
<span id="cb28-13"><a href="#cb28-13" aria-hidden="true" tabindex="-1"></a>    fake_treat <span class="ot">&lt;-</span> <span class="fu">sample</span>(both, <span class="at">size=</span><span class="dv">15</span>, <span class="at">replace=</span><span class="cn">TRUE</span>)</span>
<span id="cb28-14"><a href="#cb28-14" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Take a second, similar resample.</span></span>
<span id="cb28-15"><a href="#cb28-15" aria-hidden="true" tabindex="-1"></a>    fake_control <span class="ot">&lt;-</span> <span class="fu">sample</span>(both, <span class="at">size=</span><span class="dv">15</span>, <span class="at">replace=</span><span class="cn">TRUE</span>)</span>
<span id="cb28-16"><a href="#cb28-16" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Find the means of the two resamples.</span></span>
<span id="cb28-17"><a href="#cb28-17" aria-hidden="true" tabindex="-1"></a>    mt <span class="ot">&lt;-</span> <span class="fu">mean</span>(fake_treat)</span>
<span id="cb28-18"><a href="#cb28-18" aria-hidden="true" tabindex="-1"></a>    mc <span class="ot">&lt;-</span> <span class="fu">mean</span>(fake_control)</span>
<span id="cb28-19"><a href="#cb28-19" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Find the difference between the means of the two resamples.</span></span>
<span id="cb28-20"><a href="#cb28-20" aria-hidden="true" tabindex="-1"></a>    diff <span class="ot">&lt;-</span> mt <span class="sc">-</span> mc</span>
<span id="cb28-21"><a href="#cb28-21" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Keep score of the result.</span></span>
<span id="cb28-22"><a href="#cb28-22" aria-hidden="true" tabindex="-1"></a>    results[i] <span class="ot">&lt;-</span> diff</span>
<span id="cb28-23"><a href="#cb28-23" aria-hidden="true" tabindex="-1"></a>    <span class="co"># End the simulation experiment, go back and repeat</span></span>
<span id="cb28-24"><a href="#cb28-24" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb28-25"><a href="#cb28-25" aria-hidden="true" tabindex="-1"></a><span class="co"># Produce a histogram of the resample differences</span></span>
<span id="cb28-26"><a href="#cb28-26" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(results, <span class="at">breaks=</span><span class="dv">25</span>,</span>
<span id="cb28-27"><a href="#cb28-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">main=</span><span class="st">'Null-world distribution of treatment/control difference'</span>,</span>
<span id="cb28-28"><a href="#cb28-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">xlab=</span><span class="st">'Null-world mean treatment - mean control'</span>)</span>
<span id="cb28-29"><a href="#cb28-29" aria-hidden="true" tabindex="-1"></a><span class="co"># How often did resample differences exceed the observed difference of</span></span>
<span id="cb28-30"><a href="#cb28-30" aria-hidden="true" tabindex="-1"></a><span class="co"># .82?</span></span>
<span id="cb28-31"><a href="#cb28-31" aria-hidden="true" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="fu">sum</span>(results <span class="sc">&gt;=</span> actual_diff)</span>
<span id="cb28-32"><a href="#cb28-32" aria-hidden="true" tabindex="-1"></a>kk <span class="ot">&lt;-</span> k <span class="sc">/</span> n_trials</span>
<span id="cb28-33"><a href="#cb28-33" aria-hidden="true" tabindex="-1"></a><span class="fu">message</span>(<span class="st">'Proportion null-world differences &gt;= actual difference: '</span>, kk)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Proportion null-world differences &gt;= actual difference: 0.0109</code></pre>
</div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="testing_measured_files/figure-html/unnamed-chunk-36-1.png" class="img-fluid figure-img" style="width:70.0%"></p>
</figure>
</div>
</div>
</div>
<p>End of <code>birthweight_bootstap</code> notebook</p>
</div>
<!---
End of notebook
-->
<p>Result: only about one percent of the pairs of resamples produced means that differed by as much as .82. We can conclude that the observed difference is unlikely to have occurred by chance.</p>
</section>
<section id="sec-eg-bootstrap-sampling" class="level3" data-number="24.0.4">
<h3 data-number="24.0.4" class="anchored" data-anchor-id="sec-eg-bootstrap-sampling"><span class="header-section-number">24.0.4</span> Example: Bootstrap Sampling with Replacement</h3>
<p>Efron and Tibshirani <span class="citation" data-cites="efron1993bootstrap">(<a href="references.html#ref-efron1993bootstrap" role="doc-biblioref">1993, 11</a>)</span> present this as their basic problem illustrating the bootstrap method: Seven mice were given a new medical treatment intended to improve their survival rates after surgery, and nine mice were not treated. The numbers of days the treated mice survived were 94, 38, 23, 197, 99, 16 and 14, whereas the numbers of days the untreated mice (the control group) survived were 52, 10, 40, 104, 51, 27, 146, 30, and 46. The question we ask is: Did the treatment prolong survival, or might chance variation be responsible for the observed difference in mean survival times?</p>
<p>We start by supposing the treatment did NOT prolong survival and that chance variation in the mice was responsible for the observed difference.</p>
<p>If that is so, then we consider that the two groups came from the same universe. Now we’d like to know how likely it is that two groups drawn from this common universe would differ as much as the two observed groups differ.</p>
<p>If we had unlimited time and money, we would seek additional samples in the same way that we obtained these. Lacking time and money, we create a hypothetical universe that embodies everything we know about such a common universe. We imagine replicating each sample element millions of times to create an almost infinite universe that looks just like our samples. Then we can take resamples from this hypothetical universe and see how they behave.</p>
<p>Even on a computer, creating such a large universe is tedious so we use a shortcut. We replace each element after we pick it for a resample. That way, our hypothetical (bootstrap) universe is effectively infinite.</p>
<p>The following procedure will serve:</p>
<ul>
<li><strong>Step 1.</strong> Calculate the difference between the means of the two observed samples – it’s 30.63 days in favor of the treated mice.</li>
<li><strong>Step 2.</strong> Consider the two samples combined (16 observations) as the relevant universe to resample from.</li>
<li><strong>Step 3</strong>. Draw 7 hypothetical observations with replacement and designate them “Treatment”; draw 9 hypothetical observations with replacement and designate them “Control.”</li>
<li><strong>Step 4.</strong> Compute and record the difference between the means of the two samples. ** Step 5.** Repeat steps 2 and 3 perhaps 10000 times. ** Step 6.** Determine how often the resampled difference exceeds the observed difference of 30.63.</li>
</ul>
<p>The following notebook follows the above procedure:</p>
<div class="notebook" name="mouse_bootstrap" title="A classic bootstrap example">
<p>Start of <code>mouse_bootstrap</code> notebook</p>
<div class="nb-links">
<a class="notebook-link" href="notebooks/mouse_bootstrap.Rmd">Download notebook</a>
<a class="interact-button" href="https://mybinder.org/v2/gh/resampling-stats/resampling-with/gh-pages?filepath=r-book/notebooks/mouse_bootstrap.Rmd">Interact</a>
</div>

<div class="cell" data-layout-align="center" data-hash="testing_measured_cache/html/unnamed-chunk-38_3f6bf80ddd355cfea58b700133ae825b">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Treatment group.</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>treat <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">94</span>, <span class="dv">38</span>, <span class="dv">23</span>, <span class="dv">197</span>, <span class="dv">99</span>, <span class="dv">16</span>, <span class="dv">141</span>)</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a><span class="co"># control group</span></span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>control <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">52</span>, <span class="dv">10</span>, <span class="dv">40</span>, <span class="dv">104</span>, <span class="dv">51</span>, <span class="dv">27</span>, <span class="dv">146</span>, <span class="dv">30</span>, <span class="dv">46</span>)</span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Observed difference in real world.</span></span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a>actual_diff <span class="ot">&lt;-</span> <span class="fu">mean</span>(treat) <span class="sc">-</span> <span class="fu">mean</span>(control)</span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Set the number of trials.</span></span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true" tabindex="-1"></a>n_trials <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb30-11"><a href="#cb30-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-12"><a href="#cb30-12" aria-hidden="true" tabindex="-1"></a><span class="co"># An empty array to store the trials.</span></span>
<span id="cb30-13"><a href="#cb30-13" aria-hidden="true" tabindex="-1"></a>results <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n_trials)</span>
<span id="cb30-14"><a href="#cb30-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-15"><a href="#cb30-15" aria-hidden="true" tabindex="-1"></a><span class="co"># U is our universe (Step 2 above)</span></span>
<span id="cb30-16"><a href="#cb30-16" aria-hidden="true" tabindex="-1"></a>u <span class="ot">&lt;-</span> <span class="fu">c</span>(treat, control)</span>
<span id="cb30-17"><a href="#cb30-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-18"><a href="#cb30-18" aria-hidden="true" tabindex="-1"></a><span class="co"># step 5 above.</span></span>
<span id="cb30-19"><a href="#cb30-19" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n_trials) {</span>
<span id="cb30-20"><a href="#cb30-20" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Step 3 above.</span></span>
<span id="cb30-21"><a href="#cb30-21" aria-hidden="true" tabindex="-1"></a>    fake_treat <span class="ot">&lt;-</span> <span class="fu">sample</span>(u, <span class="at">size=</span><span class="dv">7</span>, <span class="at">replace=</span><span class="cn">TRUE</span>)</span>
<span id="cb30-22"><a href="#cb30-22" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Step 3.</span></span>
<span id="cb30-23"><a href="#cb30-23" aria-hidden="true" tabindex="-1"></a>    fake_control <span class="ot">&lt;-</span> <span class="fu">sample</span>(u, <span class="at">size=</span><span class="dv">9</span>, <span class="at">replace=</span><span class="cn">TRUE</span>)</span>
<span id="cb30-24"><a href="#cb30-24" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Step 4.</span></span>
<span id="cb30-25"><a href="#cb30-25" aria-hidden="true" tabindex="-1"></a>    mt <span class="ot">&lt;-</span> <span class="fu">mean</span>(fake_treat)</span>
<span id="cb30-26"><a href="#cb30-26" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Step 4.</span></span>
<span id="cb30-27"><a href="#cb30-27" aria-hidden="true" tabindex="-1"></a>    mc <span class="ot">&lt;-</span> <span class="fu">mean</span>(fake_control)</span>
<span id="cb30-28"><a href="#cb30-28" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Step 4.</span></span>
<span id="cb30-29"><a href="#cb30-29" aria-hidden="true" tabindex="-1"></a>    diff <span class="ot">&lt;-</span> mt <span class="sc">-</span> mc</span>
<span id="cb30-30"><a href="#cb30-30" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Step 4.</span></span>
<span id="cb30-31"><a href="#cb30-31" aria-hidden="true" tabindex="-1"></a>    results[i] <span class="ot">&lt;-</span> diff</span>
<span id="cb30-32"><a href="#cb30-32" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb30-33"><a href="#cb30-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-34"><a href="#cb30-34" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 6</span></span>
<span id="cb30-35"><a href="#cb30-35" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(results, <span class="at">breaks=</span><span class="dv">25</span>,</span>
<span id="cb30-36"><a href="#cb30-36" aria-hidden="true" tabindex="-1"></a>    <span class="at">main=</span><span class="st">'Bootstrap distribution of mean differences in survival'</span>,</span>
<span id="cb30-37"><a href="#cb30-37" aria-hidden="true" tabindex="-1"></a>    <span class="at">xlab=</span><span class="st">'Bootstrap mean treatment - mean control'</span>)</span>
<span id="cb30-38"><a href="#cb30-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-39"><a href="#cb30-39" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 6</span></span>
<span id="cb30-40"><a href="#cb30-40" aria-hidden="true" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="fu">sum</span>(results <span class="sc">&gt;=</span> actual_diff)</span>
<span id="cb30-41"><a href="#cb30-41" aria-hidden="true" tabindex="-1"></a>kk <span class="ot">&lt;-</span> k <span class="sc">/</span> n_trials</span>
<span id="cb30-42"><a href="#cb30-42" aria-hidden="true" tabindex="-1"></a><span class="fu">message</span>(<span class="st">'Proportion bootstrap mean difference &gt;= actual difference: '</span>, kk)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Proportion bootstrap mean difference &gt;= actual difference: 0.1272</code></pre>
</div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="testing_measured_files/figure-html/unnamed-chunk-38-1.png" class="img-fluid figure-img" style="width:70.0%"></p>
</figure>
</div>
</div>
</div>
<p>End of <code>mouse_bootstrap</code> notebook</p>
</div>
<!---
End of notebook
-->
<p>Interpretation: 10000 simulated resamples (of sizes 7 and 9) from a combined universe produced a difference as big as 30.63 about 12.7 percent of the time. We cannot rule out the possibility that chance might be responsible for the observed advantage of the treatment group.</p>
</section>
<section id="example-permutation-sampling-without-replacement" class="level3" data-number="24.0.5">
<h3 data-number="24.0.5" class="anchored" data-anchor-id="example-permutation-sampling-without-replacement"><span class="header-section-number">24.0.5</span> Example: Permutation Sampling Without Replacement</h3>
<p>This section discusses at some length the question of when sampling with replacement (the bootstrap), and sampling without replacement (permutation or “exact” test) are the appropriate resampling methods. The case at hand seems like a clearcut case where the bootstrap is appropriate. (Note that in this case we draw both samples from a combined universe consisting of all observations, whether we do so with or without replacement.) Nevertheless, let us see how the technique would differ if one were to consider that the permutation test is appropriate. The algorithm would then be as follows (with the steps that are the same as above labeled “a” and those that are different labeled “b”):</p>
<ul>
<li><strong>Step 1a.</strong> Calculate the difference between the means of the two observed samples – it’s 30.63 days in favor of the treated mice.</li>
<li><strong>Step 2a.</strong> Consider the two samples combined (16 observations) as the relevant universe to resample from.</li>
<li><strong>Step 3b.</strong> Draw 7 hypothetical observations without replacement and designate them “Treatment”; draw the remaining 9 hypothetical observations and designate them “Control.” (We can do this by shuffling our universe and splitting it into groups by taking the first 7 and the last 9.)</li>
<li><strong>Step 4a.</strong> Compute and record the difference between the means of the two samples.</li>
<li><strong>Step 5a.</strong> Repeat steps 2 and 3 perhaps 10,000 times</li>
<li><strong>Step 6a.</strong> Determine how often the resampled difference exceeds the observed difference of 30.63.</li>
</ul>
<p>Here is the R notebook:</p>
<div class="notebook" name="mouse_permutation" title="Permutation test for mouse survival data">
<p>Start of <code>mouse_permutation</code> notebook</p>
<div class="nb-links">
<a class="notebook-link" href="notebooks/mouse_permutation.Rmd">Download notebook</a>
<a class="interact-button" href="https://mybinder.org/v2/gh/resampling-stats/resampling-with/gh-pages?filepath=r-book/notebooks/mouse_permutation.Rmd">Interact</a>
</div>

<div class="cell" data-layout-align="center" data-hash="testing_measured_cache/html/unnamed-chunk-40_cf65fcaa3aa8be4ed5c8de62b2de9bc6">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Treatment group.</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>treat <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">94</span>, <span class="dv">38</span>, <span class="dv">23</span>, <span class="dv">197</span>, <span class="dv">99</span>, <span class="dv">16</span>, <span class="dv">141</span>)</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a><span class="co"># control group</span></span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>control <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">52</span>, <span class="dv">10</span>, <span class="dv">40</span>, <span class="dv">104</span>, <span class="dv">51</span>, <span class="dv">27</span>, <span class="dv">146</span>, <span class="dv">30</span>, <span class="dv">46</span>)</span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Observed difference in real world.</span></span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a>actual_diff <span class="ot">&lt;-</span> <span class="fu">mean</span>(treat) <span class="sc">-</span> <span class="fu">mean</span>(control)</span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Set the number of trials.</span></span>
<span id="cb32-10"><a href="#cb32-10" aria-hidden="true" tabindex="-1"></a>n_trials <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb32-11"><a href="#cb32-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-12"><a href="#cb32-12" aria-hidden="true" tabindex="-1"></a><span class="co"># An empty array to store the trials.</span></span>
<span id="cb32-13"><a href="#cb32-13" aria-hidden="true" tabindex="-1"></a>results <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n_trials)</span>
<span id="cb32-14"><a href="#cb32-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-15"><a href="#cb32-15" aria-hidden="true" tabindex="-1"></a><span class="co"># U is our universe (Step 2 above)</span></span>
<span id="cb32-16"><a href="#cb32-16" aria-hidden="true" tabindex="-1"></a>u <span class="ot">&lt;-</span> <span class="fu">c</span>(treat, control)</span>
<span id="cb32-17"><a href="#cb32-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-18"><a href="#cb32-18" aria-hidden="true" tabindex="-1"></a><span class="co"># step 5 above.</span></span>
<span id="cb32-19"><a href="#cb32-19" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n_trials) {</span>
<span id="cb32-20"><a href="#cb32-20" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Step 3b above.</span></span>
<span id="cb32-21"><a href="#cb32-21" aria-hidden="true" tabindex="-1"></a>    shuffled <span class="ot">&lt;-</span> <span class="fu">sample</span>(u)</span>
<span id="cb32-22"><a href="#cb32-22" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Step 3b - take the first 7 values.</span></span>
<span id="cb32-23"><a href="#cb32-23" aria-hidden="true" tabindex="-1"></a>    fake_treat <span class="ot">&lt;-</span> shuffled[<span class="dv">1</span><span class="sc">:</span><span class="dv">7</span>]</span>
<span id="cb32-24"><a href="#cb32-24" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Step 3b - take the remaining values.</span></span>
<span id="cb32-25"><a href="#cb32-25" aria-hidden="true" tabindex="-1"></a>    fake_control <span class="ot">&lt;-</span> shuffled[<span class="dv">8</span><span class="sc">:</span><span class="dv">16</span>]</span>
<span id="cb32-26"><a href="#cb32-26" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Step 4.</span></span>
<span id="cb32-27"><a href="#cb32-27" aria-hidden="true" tabindex="-1"></a>    mt <span class="ot">&lt;-</span> <span class="fu">mean</span>(fake_treat)</span>
<span id="cb32-28"><a href="#cb32-28" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Step 4.</span></span>
<span id="cb32-29"><a href="#cb32-29" aria-hidden="true" tabindex="-1"></a>    mc <span class="ot">&lt;-</span> <span class="fu">mean</span>(fake_control)</span>
<span id="cb32-30"><a href="#cb32-30" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Step 4.</span></span>
<span id="cb32-31"><a href="#cb32-31" aria-hidden="true" tabindex="-1"></a>    diff <span class="ot">&lt;-</span> mt <span class="sc">-</span> mc</span>
<span id="cb32-32"><a href="#cb32-32" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Step 4.</span></span>
<span id="cb32-33"><a href="#cb32-33" aria-hidden="true" tabindex="-1"></a>    results[i] <span class="ot">&lt;-</span> diff</span>
<span id="cb32-34"><a href="#cb32-34" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb32-35"><a href="#cb32-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-36"><a href="#cb32-36" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 6</span></span>
<span id="cb32-37"><a href="#cb32-37" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(results, <span class="at">breaks=</span><span class="dv">25</span>,</span>
<span id="cb32-38"><a href="#cb32-38" aria-hidden="true" tabindex="-1"></a>    <span class="at">main=</span><span class="st">'Permutation distribution of mean differences in survival'</span>,</span>
<span id="cb32-39"><a href="#cb32-39" aria-hidden="true" tabindex="-1"></a>    <span class="at">xlab=</span><span class="st">'Permutation mean treatment - mean control'</span>)</span>
<span id="cb32-40"><a href="#cb32-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-41"><a href="#cb32-41" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 6</span></span>
<span id="cb32-42"><a href="#cb32-42" aria-hidden="true" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="fu">sum</span>(results <span class="sc">&gt;=</span> actual_diff)</span>
<span id="cb32-43"><a href="#cb32-43" aria-hidden="true" tabindex="-1"></a>kk <span class="ot">&lt;-</span> k <span class="sc">/</span> n_trials</span>
<span id="cb32-44"><a href="#cb32-44" aria-hidden="true" tabindex="-1"></a><span class="fu">message</span>(<span class="st">'Proportion permutation mean difference &gt;= actual difference: '</span>, kk)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Proportion permutation mean difference &gt;= actual difference: 0.1406</code></pre>
</div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="testing_measured_files/figure-html/unnamed-chunk-40-1.png" class="img-fluid figure-img" style="width:70.0%"></p>
</figure>
</div>
</div>
</div>
<p>End of <code>mouse_permutation</code> notebook</p>
</div>
<!---
End of notebook
-->
<p>Interpretation: 10000 simulated resamples (of sizes 7 and 9) from a combined universe produced a difference as big as 30.63 about 14.1 percent of the time. We therefore should not rule out the possibility that chance might be responsible for the observed advantage of the treatment group.</p>
</section>
<section id="differences-among-four-means" class="level2" data-number="24.1">
<h2 data-number="24.1" class="anchored" data-anchor-id="differences-among-four-means"><span class="header-section-number">24.1</span> Differences among four means</h2>
<section id="example-differences-among-four-pig-rations" class="level3" data-number="24.1.1">
<h3 data-number="24.1.1" class="anchored" data-anchor-id="example-differences-among-four-pig-rations"><span class="header-section-number">24.1.1</span> Example: differences among four pig rations</h3>
<p><strong>Test for Differences Among Means of More Than Two Samples of Measured Data</strong>.</p>
<p>In the examples of <a href="testing_counts_1.html#sec-fruitfly" class="quarto-xref"><span>Section&nbsp;21.2.0.1</span></a> and <a href="testing_counts_1.html#sec-female-calves" class="quarto-xref"><span>Section&nbsp;21.2.1</span></a> we investigated whether or not the results shown by a <em>single</em> sample are sufficiently different from a null (benchmark) hypothesis so that the sample is unlikely to have come from the null-hypothesis benchmark universe. In the examples of <a href="testing_counts_1.html#sec-cancer-cures" class="quarto-xref"><span>Section&nbsp;21.2.4</span></a>, <a href="testing_counts_2.html#sec-pig-pairs" class="quarto-xref"><span>Section&nbsp;23.2.1</span></a>, and <a href="#sec-pig-rations-measured" class="quarto-xref"><span>Section&nbsp;24.0.1</span></a> we then investigated whether or not the results shown by <em>two</em> samples suggest that both had come from the <em>same</em> universe, a universe that was assumed to be the composite of the two samples. Now, as in <a href="testing_counts_2.html#sec-fruitfly-four" class="quarto-xref"><span>Section&nbsp;23.1.1</span></a>, we investigate whether or not <em>several</em> samples come from the same universe, except that now we work with measured data rather than with counted data.</p>
<p>If one experiments with each of 100 different pig foods on twelve pigs, some of the foods will show much better results than will others <em>just by chance</em>, just as one family in sixteen is likely to have the very “high” number of 4 daughters in its first four children. Therefore, it is wrong reasoning to try out the 100 pig foods, select the food that shows the best results, and then compare it statistically with the average (sum) of all the other foods (or worse, with the poorest food). With such a procedure and enough samples, you will surely find one (or more) that seems very atypical statistically. A bridge hand with 12 or 13 spades seems very atypical, too, but if you deal enough bridge hands you will sooner or later get one with 12 or 13 spades — as a purely chance phenomenon, dealt randomly from a standard deck. Therefore we need a test that prevents our falling into such traps. Such a test usually operates by taking into account the differences among <em>all</em> the foods that were tried.</p>
<p>The method of <a href="#sec-pig-rations-measured" class="quarto-xref"><span>Section&nbsp;24.0.1</span></a> can be extended to handle this problem. Assume that <em>four</em> foods were each tested on twelve pigs. The weight gains in pounds for the pigs fed on foods A and B were as before. <a href="#tbl-pig-cd-rations" class="quarto-xref">Table&nbsp;<span>24.6</span></a> has the weight gains for foods C and D. (Compare these with the weight gains for foods A and B in <a href="#tbl-pig-ab-rations" class="quarto-xref">Table&nbsp;<span>24.1</span></a>).</p>
<div class="cell" data-layout-align="center" data-hash="testing_measured_cache/html/unnamed-chunk-41_ad662f9051419c6c08a3609dea0c4d0c">
<div class="cell-output-display">
<div id="tbl-pig-cd-rations" class="anchored">
<table class="lightable-paper lightable-striped lightable-hover table table-sm table-striped small" data-quarto-postprocess="true">
<caption>Table&nbsp;24.6: Measured data for pig rations C and D </caption>
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th"></th>
<th style="text-align: left;" data-quarto-table-cell-role="th">ration</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">weight_gain</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">25</td>
<td style="text-align: left;">C</td>
<td style="text-align: right;">30</td>
</tr>
<tr class="even">
<td style="text-align: left;">26</td>
<td style="text-align: left;">C</td>
<td style="text-align: right;">30</td>
</tr>
<tr class="odd">
<td style="text-align: left;">27</td>
<td style="text-align: left;">C</td>
<td style="text-align: right;">32</td>
</tr>
<tr class="even">
<td style="text-align: left;">28</td>
<td style="text-align: left;">C</td>
<td style="text-align: right;">31</td>
</tr>
<tr class="odd">
<td style="text-align: left;">29</td>
<td style="text-align: left;">C</td>
<td style="text-align: right;">29</td>
</tr>
<tr class="even">
<td style="text-align: left;">30</td>
<td style="text-align: left;">C</td>
<td style="text-align: right;">27</td>
</tr>
<tr class="odd">
<td style="text-align: left;">31</td>
<td style="text-align: left;">C</td>
<td style="text-align: right;">25</td>
</tr>
<tr class="even">
<td style="text-align: left;">32</td>
<td style="text-align: left;">C</td>
<td style="text-align: right;">30</td>
</tr>
<tr class="odd">
<td style="text-align: left;">33</td>
<td style="text-align: left;">C</td>
<td style="text-align: right;">31</td>
</tr>
<tr class="even">
<td style="text-align: left;">34</td>
<td style="text-align: left;">C</td>
<td style="text-align: right;">32</td>
</tr>
<tr class="odd">
<td style="text-align: left;">35</td>
<td style="text-align: left;">C</td>
<td style="text-align: right;">34</td>
</tr>
<tr class="even">
<td style="text-align: left;">36</td>
<td style="text-align: left;">C</td>
<td style="text-align: right;">33</td>
</tr>
<tr class="odd">
<td style="text-align: left;">37</td>
<td style="text-align: left;">D</td>
<td style="text-align: right;">32</td>
</tr>
<tr class="even">
<td style="text-align: left;">38</td>
<td style="text-align: left;">D</td>
<td style="text-align: right;">25</td>
</tr>
<tr class="odd">
<td style="text-align: left;">39</td>
<td style="text-align: left;">D</td>
<td style="text-align: right;">31</td>
</tr>
<tr class="even">
<td style="text-align: left;">40</td>
<td style="text-align: left;">D</td>
<td style="text-align: right;">26</td>
</tr>
<tr class="odd">
<td style="text-align: left;">41</td>
<td style="text-align: left;">D</td>
<td style="text-align: right;">32</td>
</tr>
<tr class="even">
<td style="text-align: left;">42</td>
<td style="text-align: left;">D</td>
<td style="text-align: right;">27</td>
</tr>
<tr class="odd">
<td style="text-align: left;">43</td>
<td style="text-align: left;">D</td>
<td style="text-align: right;">28</td>
</tr>
<tr class="even">
<td style="text-align: left;">44</td>
<td style="text-align: left;">D</td>
<td style="text-align: right;">29</td>
</tr>
<tr class="odd">
<td style="text-align: left;">45</td>
<td style="text-align: left;">D</td>
<td style="text-align: right;">29</td>
</tr>
<tr class="even">
<td style="text-align: left;">46</td>
<td style="text-align: left;">D</td>
<td style="text-align: right;">28</td>
</tr>
<tr class="odd">
<td style="text-align: left;">47</td>
<td style="text-align: left;">D</td>
<td style="text-align: right;">23</td>
</tr>
<tr class="even">
<td style="text-align: left;">48</td>
<td style="text-align: left;">D</td>
<td style="text-align: right;">25</td>
</tr>
</tbody>
</table>
</div>


</div>
</div>
<p>Now construct a benchmark universe of <em>forty-eight</em> index cards, one for each weight gain. Then deal out sets of four hands randomly. More specifically:</p>
<ul>
<li><strong>Step 1.</strong> Constitute a universe of the forty-eight observed weight gains in the four samples, writing the weight gains on cards.</li>
<li><strong>Step 2.</strong> Draw four groups of twelve weight gains, with replacement, since we are drawing from a hypothesized infinite universe in which consecutive draws are independent. Determine whether the difference between the lowest and highest group means is as large or larger than the observed difference. If so write “yes,” otherwise “no.”</li>
<li><strong>Step 3.</strong> Repeat step 2 fifty times.</li>
<li><strong>Step 4.</strong> Count the trials in which the differences between the simulated groups with the highest and lowest means are as large or larger than the differences between the means of the highest and lowest observed samples. The proportion of such trials to the total number of trials is the probability that all four samples would differ as much as do the observed samples if they (in technical terms) come from the same universe.</li>
</ul>
<p>The problem, as handled by the steps given above, is quite similar to the way we handled the example in <a href="testing_counts_2.html#sec-four-rehabs" class="quarto-xref"><span>Section&nbsp;23.1.2</span></a>, except that the data are measured (in pounds of weight gain) rather than simply counted (the number of rehabilitations).</p>
<p>Instead of working through a program for the procedure outlined above, let us consider a different approach to the problem — computing the difference between each <em>pair</em> of foods, six differences in all, converting all minus (-) signs to (+) differences (taking the <em>absolute</em> value). Then we can <em>total</em> the six absolute differences, and compare the total with the sum of the six absolute differences in the <em>observed</em> sample. The proportion of the resampling trials in which the observed sample sum is equaled or exceeded by the sum of the differences in the trials is the probability that the observed samples would differ as much as they do if they come from the same universe.<a href="#fn5" class="footnote-ref" id="fnref5" role="doc-noteref"><sup>5</sup></a></p>
<p>One naturally wonders whether this latter test statistic is better than the range, as discussed above. It would seem obvious that using the information contained in all four samples should increase the precision of the estimate. And indeed it is so, as you can confirm for yourself by comparing the results of the two approaches. But in the long run, the estimate provided by the two approaches would be much the same. That is, there is no reason to think that one or another of the estimates is <em>biased</em> . However, successive samples from the population would steady down faster to the true value using the four-group-based estimate than they would using the range. That is, the four-group-based estimate would require a smaller sample of pigs.</p>
<p>Is there reason to prefer one or the other approach from the point of view of some decision that might be made? One might think that the range procedure throws light on which <em>one</em> of the foods is best in a way that the four-group-based approach does not. But this is not correct. Both approaches answer this question, and <em>only</em> this question: Are the results from the four foods likely to have resulted from the same “universe” of weight gains or not? If one wants to know whether the <em>best</em> food is similar to, say, all the other three, the appropriate approach would be a <em>two-sample</em> approach similar to various two-sample examples discussed earlier. (It would be still <em>another</em> question to ask whether the best food is different from the worst. One would then use a procedure different from either of those discussed above.)</p>
<p>If the foods cost the same, one would not need even a two-sample analysis to decide which food to feed. Feed the one whose results are best in the experiment, without bothering to ask whether it is “really” the best; you can’t go wrong as long as it doesn’t cost more to use it. (One could inquire about the probability that the food yielding the best results in the experiment would attain those results by chance even if it was worse than the others by some stipulated amount, but pursuing that line of thought may be left to the student as an exercise.)</p>
<p>In the notebook below, we want a measure of how the groups differ. The obvious first step is to add up the total weight gains for each group (<a href="#tbl-gain-sums" class="quarto-xref">Table&nbsp;<span>24.7</span></a>):</p>
<div class="cell" data-layout-align="center" data-hash="testing_measured_cache/html/unnamed-chunk-42_d51fe2bf5c2082b171e2c9b4fc862e8e">
<div class="cell-output-display">
<div id="tbl-gain-sums" class="anchored">
<table class="lightable-paper lightable-striped lightable-hover table table-sm table-striped small" data-quarto-postprocess="true">
<caption>Table&nbsp;24.7: Weight gain sum per group</caption>
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th"></th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Sum of weight gains</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">A</td>
<td style="text-align: right;">382</td>
</tr>
<tr class="even">
<td style="text-align: left;">B</td>
<td style="text-align: right;">344</td>
</tr>
<tr class="odd">
<td style="text-align: left;">C</td>
<td style="text-align: right;">364</td>
</tr>
<tr class="even">
<td style="text-align: left;">D</td>
<td style="text-align: right;">335</td>
</tr>
</tbody>
</table>
</div>


</div>
</div>
<p>The next step is to calculate the differences between all the possible combinations of groups.</p>
<div class="cell" data-layout-align="center" data-hash="testing_measured_cache/html/unnamed-chunk-44_d6ecf6e37fb14a3fe7fb2057dcdb31eb">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>differences <span class="ot">&lt;-</span>  <span class="fu">c</span>(<span class="dv">382</span> <span class="sc">-</span> <span class="dv">344</span>, <span class="dv">382</span> <span class="sc">-</span> <span class="dv">364</span>, <span class="dv">382</span> <span class="sc">-</span> <span class="dv">335</span>,</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>                  <span class="dv">344</span> <span class="sc">-</span> <span class="dv">364</span>, <span class="dv">344</span> <span class="sc">-</span> <span class="dv">335</span>, <span class="dv">364</span> <span class="sc">-</span> <span class="dv">335</span>)</span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>differences</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1]  38  18  47 -20   9  29</code></pre>
</div>
</div>
</section>
</section>
<section id="using-squared-differences" class="level2" data-number="24.2">
<h2 data-number="24.2" class="anchored" data-anchor-id="using-squared-differences"><span class="header-section-number">24.2</span> Using Squared Differences</h2>
<p>Here we face a choice. We could work with the absolute differences — that is, the results of the subtractions — treating each result as a positive number even if it is negative. We have seen this approach before. Therefore let us now take the opportunity of showing another approach. Instead of working with the absolute differences, we <em>square</em> each difference, and then sum the squares.</p>
<p>Squaring vectors squares <em>each element</em> of the vector (see <a href="standard_scores.html#sec-squared-arrays" class="quarto-xref"><span>Section&nbsp;16.7.1</span></a>):</p>
<div class="cell" data-layout-align="center" data-hash="testing_measured_cache/html/unnamed-chunk-47_bb3d4eedf88cd2395a640c1b6f17bffe">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>squared_differences <span class="ot">&lt;-</span> differences <span class="sc">**</span> <span class="dv">2</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>squared_differences</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1444  324 2209  400   81  841</code></pre>
</div>
</div>
<div class="cell" data-layout-align="center" data-hash="testing_measured_cache/html/unnamed-chunk-48_879fdd8db54acd4e16e9d05415f3f3a3">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>sum_sq_d <span class="ot">=</span> <span class="fu">sum</span>(squared_differences)</span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>sum_sq_d</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 5299</code></pre>
</div>
</div>
<p>An advantage of working with the squares is that they are positive — a negative number squared is positive — which is convenient. Additionally, conventional statistics works mainly with squared quantities, and therefore it is worth getting familiar with that point of view. The squared differences in this case add up to 5299.</p>
<p>Using R, we shuffle all the weight gains together, select four random groups, and determine whether the sum of squared differences in the resample equal or exceed 5299. If they do so with regularity, then we conclude that the observed differences could easily have occurred by chance.</p>
<p>With the <span class="r"><code>c</code></span> func, we string the four vectors into a single vector called <code>all_weights</code>. After shuffling (using <span class="r"><code>sample</code></span> the 48-pig weight-gain vector <code>all_weights</code> into <code>shuffled</code>, we split <code>shuffled</code> into four randomized samples. And we compute the squared differences between the pairs of groups and <code>sum</code> the squared differences just as we did above for the observed groups.</p>
<p>Last, we examine how often the simulated-trials data produce differences among the groups as large as (or larger than) the actually observed data — 5299.</p>
<div class="notebook" name="squared_rations" title="Sum of squared differences for pig rations">
<p>Start of <code>squared_rations</code> notebook</p>
<div class="nb-links">
<a class="notebook-link" href="notebooks/squared_rations.Rmd">Download notebook</a>
<a class="interact-button" href="https://mybinder.org/v2/gh/resampling-stats/resampling-with/gh-pages?filepath=r-book/notebooks/squared_rations.Rmd">Interact</a>
</div>

<div class="cell" data-layout-align="center" data-hash="testing_measured_cache/html/unnamed-chunk-50_ff684732ec869c2009d5561f61f0930c">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load data file.</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>rations_df <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">'data/pig_rations.csv'</span>)</span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Show the first six rows.</span></span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(rations_df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  ration weight_gain
1      A          31
2      A          34
3      A          29
4      A          26
5      A          32
6      A          35</code></pre>
</div>
</div>
<div class="cell" data-layout-align="center" data-hash="testing_measured_cache/html/unnamed-chunk-52_f6124012553c848b9515f1920adb0e67">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Get vectors for each ration.</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a><span class="co"># A</span></span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>a_rows <span class="ot">&lt;-</span> <span class="fu">subset</span>(rations_df, rations_df<span class="sc">$</span>ration <span class="sc">==</span> <span class="st">'A'</span>)</span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a>a_weights <span class="ot">&lt;-</span> a_rows<span class="sc">$</span>weight_gain</span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a><span class="co"># B</span></span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a>b_rows <span class="ot">&lt;-</span> <span class="fu">subset</span>(rations_df, rations_df<span class="sc">$</span>ration <span class="sc">==</span> <span class="st">'B'</span>)</span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a>b_weights <span class="ot">&lt;-</span> b_rows<span class="sc">$</span>weight_gain</span>
<span id="cb42-8"><a href="#cb42-8" aria-hidden="true" tabindex="-1"></a><span class="co"># C</span></span>
<span id="cb42-9"><a href="#cb42-9" aria-hidden="true" tabindex="-1"></a>c_rows <span class="ot">&lt;-</span> <span class="fu">subset</span>(rations_df, rations_df<span class="sc">$</span>ration <span class="sc">==</span> <span class="st">'C'</span>)</span>
<span id="cb42-10"><a href="#cb42-10" aria-hidden="true" tabindex="-1"></a>c_weights <span class="ot">&lt;-</span> c_rows<span class="sc">$</span>weight_gain</span>
<span id="cb42-11"><a href="#cb42-11" aria-hidden="true" tabindex="-1"></a><span class="co"># D</span></span>
<span id="cb42-12"><a href="#cb42-12" aria-hidden="true" tabindex="-1"></a>d_rows <span class="ot">&lt;-</span> <span class="fu">subset</span>(rations_df, rations_df<span class="sc">$</span>ration <span class="sc">==</span> <span class="st">'D'</span>)</span>
<span id="cb42-13"><a href="#cb42-13" aria-hidden="true" tabindex="-1"></a>d_weights <span class="ot">&lt;-</span> d_rows<span class="sc">$</span>weight_gain</span>
<span id="cb42-14"><a href="#cb42-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Concatenate into one long vector.</span></span>
<span id="cb42-15"><a href="#cb42-15" aria-hidden="true" tabindex="-1"></a>all_weights <span class="ot">&lt;-</span> <span class="fu">c</span>(a_weights, b_weights, c_weights, d_weights)</span>
<span id="cb42-16"><a href="#cb42-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Show the concatenated vector.</span></span>
<span id="cb42-17"><a href="#cb42-17" aria-hidden="true" tabindex="-1"></a>all_weights</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] 31 34 29 26 32 35 38 34 31 29 32 31 26 24 28 29 30 29 31 29 32 26 28 32 30
[26] 30 32 31 29 27 25 30 31 32 34 33 32 25 31 26 32 27 28 29 29 28 23 25</code></pre>
</div>
</div>
<div class="cell" data-layout-align="center" data-hash="testing_measured_cache/html/unnamed-chunk-54_c8c780977083a5c5419b7da79e0ff0d0">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>n_trials <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a><span class="co"># An vector to store the result of each trial.</span></span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a>results <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n_trials)</span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Do 10000 trials</span></span>
<span id="cb44-7"><a href="#cb44-7" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n_trials) {</span>
<span id="cb44-8"><a href="#cb44-8" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Shuffle all the weight gains.</span></span>
<span id="cb44-9"><a href="#cb44-9" aria-hidden="true" tabindex="-1"></a>    shuffled <span class="ot">&lt;-</span> <span class="fu">sample</span>(all_weights)</span>
<span id="cb44-10"><a href="#cb44-10" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Split into 4 now random samples.</span></span>
<span id="cb44-11"><a href="#cb44-11" aria-hidden="true" tabindex="-1"></a>    fake_a <span class="ot">&lt;-</span> shuffled[<span class="dv">1</span><span class="sc">:</span><span class="dv">12</span>]</span>
<span id="cb44-12"><a href="#cb44-12" aria-hidden="true" tabindex="-1"></a>    fake_b <span class="ot">&lt;-</span> shuffled[<span class="dv">13</span><span class="sc">:</span><span class="dv">24</span>]</span>
<span id="cb44-13"><a href="#cb44-13" aria-hidden="true" tabindex="-1"></a>    fake_c <span class="ot">&lt;-</span> shuffled[<span class="dv">25</span><span class="sc">:</span><span class="dv">36</span>]</span>
<span id="cb44-14"><a href="#cb44-14" aria-hidden="true" tabindex="-1"></a>    fake_d <span class="ot">&lt;-</span> shuffled[<span class="dv">37</span><span class="sc">:</span><span class="dv">48</span>]</span>
<span id="cb44-15"><a href="#cb44-15" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Sum the weight gains for the 4 resamples.</span></span>
<span id="cb44-16"><a href="#cb44-16" aria-hidden="true" tabindex="-1"></a>    sum_a <span class="ot">&lt;-</span> <span class="fu">sum</span>(fake_a)</span>
<span id="cb44-17"><a href="#cb44-17" aria-hidden="true" tabindex="-1"></a>    sum_b <span class="ot">&lt;-</span> <span class="fu">sum</span>(fake_b)</span>
<span id="cb44-18"><a href="#cb44-18" aria-hidden="true" tabindex="-1"></a>    sum_c <span class="ot">&lt;-</span> <span class="fu">sum</span>(fake_c)</span>
<span id="cb44-19"><a href="#cb44-19" aria-hidden="true" tabindex="-1"></a>    sum_d <span class="ot">&lt;-</span> <span class="fu">sum</span>(fake_d)</span>
<span id="cb44-20"><a href="#cb44-20" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Find the differences between all the possible pairs of resamples.</span></span>
<span id="cb44-21"><a href="#cb44-21" aria-hidden="true" tabindex="-1"></a>    a_b <span class="ot">&lt;-</span> sum_a <span class="sc">-</span> sum_b</span>
<span id="cb44-22"><a href="#cb44-22" aria-hidden="true" tabindex="-1"></a>    a_c <span class="ot">&lt;-</span> sum_a <span class="sc">-</span> sum_c</span>
<span id="cb44-23"><a href="#cb44-23" aria-hidden="true" tabindex="-1"></a>    a_d <span class="ot">&lt;-</span> sum_a <span class="sc">-</span> sum_d</span>
<span id="cb44-24"><a href="#cb44-24" aria-hidden="true" tabindex="-1"></a>    b_c <span class="ot">&lt;-</span> sum_b <span class="sc">-</span> sum_c</span>
<span id="cb44-25"><a href="#cb44-25" aria-hidden="true" tabindex="-1"></a>    b_d <span class="ot">&lt;-</span> sum_b <span class="sc">-</span> sum_d</span>
<span id="cb44-26"><a href="#cb44-26" aria-hidden="true" tabindex="-1"></a>    c_d <span class="ot">&lt;-</span> sum_c <span class="sc">-</span> sum_d</span>
<span id="cb44-27"><a href="#cb44-27" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Put the differences into an vector.</span></span>
<span id="cb44-28"><a href="#cb44-28" aria-hidden="true" tabindex="-1"></a>    fake_diffs <span class="ot">&lt;-</span> <span class="fu">c</span>(a_b, a_c, a_d, b_c, b_d, c_d)</span>
<span id="cb44-29"><a href="#cb44-29" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Square them to give six squared differences.</span></span>
<span id="cb44-30"><a href="#cb44-30" aria-hidden="true" tabindex="-1"></a>    sq_fake_diffs <span class="ot">&lt;-</span> fake_diffs <span class="sc">**</span> <span class="dv">2</span></span>
<span id="cb44-31"><a href="#cb44-31" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Sum the squares.</span></span>
<span id="cb44-32"><a href="#cb44-32" aria-hidden="true" tabindex="-1"></a>    sum_sq_fake_diffs <span class="ot">&lt;-</span> <span class="fu">sum</span>(sq_fake_diffs)</span>
<span id="cb44-33"><a href="#cb44-33" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Keep track of the total for each trial.</span></span>
<span id="cb44-34"><a href="#cb44-34" aria-hidden="true" tabindex="-1"></a>    results[i] <span class="ot">&lt;-</span> sum_sq_fake_diffs</span>
<span id="cb44-35"><a href="#cb44-35" aria-hidden="true" tabindex="-1"></a>    <span class="co"># End one trial, go back and repeat until 10000 trials are complete.</span></span>
<span id="cb44-36"><a href="#cb44-36" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb44-37"><a href="#cb44-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-38"><a href="#cb44-38" aria-hidden="true" tabindex="-1"></a><span class="co"># Produce a histogram of the trial results.</span></span>
<span id="cb44-39"><a href="#cb44-39" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(results, <span class="at">breaks=</span><span class="dv">25</span>,</span>
<span id="cb44-40"><a href="#cb44-40" aria-hidden="true" tabindex="-1"></a>    <span class="at">main=</span><span class="st">'Null distribution of sum of squared differences'</span>,</span>
<span id="cb44-41"><a href="#cb44-41" aria-hidden="true" tabindex="-1"></a>    <span class="at">xlab=</span><span class="st">'Sum of squared differences in null world'</span>)</span>
<span id="cb44-42"><a href="#cb44-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-43"><a href="#cb44-43" aria-hidden="true" tabindex="-1"></a><span class="co"># Find out how many trials produced differences among groups as great as</span></span>
<span id="cb44-44"><a href="#cb44-44" aria-hidden="true" tabindex="-1"></a><span class="co"># or greater than those observed.</span></span>
<span id="cb44-45"><a href="#cb44-45" aria-hidden="true" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="fu">sum</span>(results <span class="sc">&gt;=</span> <span class="dv">5299</span>)</span>
<span id="cb44-46"><a href="#cb44-46" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert to a proportion.</span></span>
<span id="cb44-47"><a href="#cb44-47" aria-hidden="true" tabindex="-1"></a>kk <span class="ot">&lt;-</span> k <span class="sc">/</span> n_trials</span>
<span id="cb44-48"><a href="#cb44-48" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the result.</span></span>
<span id="cb44-49"><a href="#cb44-49" aria-hidden="true" tabindex="-1"></a><span class="fu">message</span>(<span class="st">'Number of sum of squared differences &gt;= 5299: '</span>, kk)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Number of sum of squared differences &gt;= 5299: 0.0061</code></pre>
</div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="testing_measured_files/figure-html/unnamed-chunk-54-1.png" class="img-fluid figure-img" style="width:70.0%"></p>
</figure>
</div>
</div>
</div>
<p>End of <code>squared_rations</code> notebook</p>
</div>
<!---
End of notebook
-->
<p>We find that our observed sum of squares — 5299 — was equaled or exceeded by randomly-drawn sums of squares in only 0.6 percent of our trials. We conclude that the four treatments are likely not all similar.</p>
</section>
<section id="exercises" class="level2" data-number="24.3">
<h2 data-number="24.3" class="anchored" data-anchor-id="exercises"><span class="header-section-number">24.3</span> Exercises</h2>
<p>Solutions for problems may be found in <a href="exercise_solutions.html" class="quarto-xref"><span>Chapter&nbsp;32</span></a>.</p>
<section id="sec-exr-paired-differences" class="level3" data-number="24.3.1">
<h3 data-number="24.3.1" class="anchored" data-anchor-id="sec-exr-paired-differences"><span class="header-section-number">24.3.1</span> Exercise: paired differences</h3>
<p>The data shown in <a href="#tbl-hamilton-scores" class="quarto-xref">Table&nbsp;<span>24.8</span></a> might be data for the outcomes of two different mechanics, showing the length of time until the next overhaul is needed for nine pairs of similar vehicles. Or they could be two readings made by different instruments on the same sample of rock. In fact, they represent data for two successive tests for depression on the Hamilton scale, before and after drug therapy.</p>
<!---
Note on source in Hollander: Salsburg (1970): Personal communication (with the cooperation of Pfizer and co, Groton, Conn.)
-->
<div class="cell" data-layout-align="center" data-hash="testing_measured_cache/html/unnamed-chunk-55_88c9c46b0c33f3c4b9ba09d6943df055">
<div class="cell-output-display">
<div id="tbl-hamilton-scores" class="anchored">
<table class="lightable-paper lightable-striped lightable-hover table table-sm table-striped small" data-quarto-postprocess="true">
<caption>Table&nbsp;24.8: Hamilton Depression Scale Values </caption>
<thead>
<tr class="header">
<th style="text-align: right;" data-quarto-table-cell-role="th">Patient #</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Score before</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Score after</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">1.83</td>
<td style="text-align: right;">0.878</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">0.50</td>
<td style="text-align: right;">0.647</td>
</tr>
<tr class="odd">
<td style="text-align: right;">3</td>
<td style="text-align: right;">1.62</td>
<td style="text-align: right;">0.598</td>
</tr>
<tr class="even">
<td style="text-align: right;">4</td>
<td style="text-align: right;">2.48</td>
<td style="text-align: right;">2.050</td>
</tr>
<tr class="odd">
<td style="text-align: right;">5</td>
<td style="text-align: right;">1.68</td>
<td style="text-align: right;">1.060</td>
</tr>
<tr class="even">
<td style="text-align: right;">6</td>
<td style="text-align: right;">1.88</td>
<td style="text-align: right;">1.290</td>
</tr>
<tr class="odd">
<td style="text-align: right;">7</td>
<td style="text-align: right;">1.55</td>
<td style="text-align: right;">1.060</td>
</tr>
<tr class="even">
<td style="text-align: right;">8</td>
<td style="text-align: right;">3.06</td>
<td style="text-align: right;">3.140</td>
</tr>
<tr class="odd">
<td style="text-align: right;">9</td>
<td style="text-align: right;">1.30</td>
<td style="text-align: right;">1.290</td>
</tr>
</tbody>
</table>
</div>


</div>
</div>
<p>The task is to perform a test that will help decide whether there is a difference in the depression scores at the two visits (or the performances of the two mechanics). Perform both a bootstrap test and a permutation test, and give some reason for preferring one to the other in principle. How much do they differ in practice? (For this exercise, assume that we can treat the before and after scores as two different and independent samples and ignore the pairing between the before and after scores).</p>
<p>Here’s a notebook to get you started:</p>
<div class="notebook" name="paired_differences" title="Paired differences exercise">
<p>Start of <code>paired_differences</code> notebook</p>
<div class="nb-links">
<a class="notebook-link" href="notebooks/paired_differences.Rmd">Download notebook</a>
<a class="interact-button" href="https://mybinder.org/v2/gh/resampling-stats/resampling-with/gh-pages?filepath=r-book/notebooks/paired_differences.Rmd">Interact</a>
</div>

<div class="cell" data-layout-align="center" data-hash="testing_measured_cache/html/unnamed-chunk-57_dfe7d9b38a040eeeac176702527dc17d">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">'data/hamilton.csv'</span>)</span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>before <span class="ot">&lt;-</span> df<span class="sc">$</span>score_before</span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>after <span class="ot">&lt;-</span> df<span class="sc">$</span>score_after</span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Your code here.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>End of <code>paired_differences</code> notebook</p>
</div>
<!---
End of notebook.
-->
<p>See <a href="exercise_solutions.html#sec-soln-paired-differences" class="quarto-xref"><span>Section&nbsp;32.1</span></a> for a solution.</p>
</section>
<section id="sec-exr-seatbelt-proportions" class="level3" data-number="24.3.2">
<h3 data-number="24.3.2" class="anchored" data-anchor-id="sec-exr-seatbelt-proportions"><span class="header-section-number">24.3.2</span> Exercise: seatbelt proportions</h3>
<p>Thirty-six of 72 (.5) taxis surveyed in Pittsburgh had visible seatbelts. Seventy-seven of 129 taxis in Chicago (.597) had visible seatbelts. Calculate a confidence interval for the difference in proportions, estimated at -.097. (Source: Peskun, Peter H., “A New Confidence Interval Method Based on the Normal Approximation for the Difference of Two Binomial Probabilities,” <em>Journal of the American Statistical Association</em> , 6/93 p.&nbsp;656).</p>
<p>For solution, see <a href="exercise_solutions.html#sec-soln-seatbelt-proportions" class="quarto-xref"><span>Section&nbsp;32.2</span></a>}</p>


<div id="refs" class="references csl-bib-body hanging-indent" role="list" style="display: none">
<div id="ref-chung1958randomization" class="csl-entry" role="listitem">
Chung, James H, and Donald AS Fraser. 1958. <span>“Randomization Tests for a Multivariate Two-Sample Problem.”</span> <em>Journal of the American Statistical Association</em> 53 (283): 729–35. <a href="https://www.jstor.org/stable/pdf/2282050.pdf">https://www.jstor.org/stable/pdf/2282050.pdf</a>.
</div>
<div id="ref-dwass1957modified" class="csl-entry" role="listitem">
Dwass, Meyer. 1957. <span>“Modified Randomization Tests for Nonparametric Hypotheses.”</span> <em>The Annals of Mathematical Statistics</em>, 181–87. <a href="https://www.jstor.org/stable/pdf/2237031.pdf">https://www.jstor.org/stable/pdf/2237031.pdf</a>.
</div>
<div id="ref-efron1993bootstrap" class="csl-entry" role="listitem">
Efron, Bradley, and Robert J Tibshirani. 1993. <span>“An Introduction to the Bootstrap.”</span> In <em>Monographs on Statistics and Applied Probability</em>, edited by David R Cox, David V Hinkley, Nancy Reid, Donald B Rubin, and Bernard W Silverman. Vol. 57. New York: <span>Chapman &amp; Hall</span>.
</div>
<div id="ref-fisher1935design" class="csl-entry" role="listitem">
Fisher, Ronald Aylmer. 1935. <em>The Design of Experiments</em>. 1st ed. Edinburgh: <span>Oliver and Boyd Ltd</span>. <a href="https://archive.org/details/in.ernet.dli.2015.502684">https://archive.org/details/in.ernet.dli.2015.502684</a>.
</div>
<div id="ref-fisher1960design" class="csl-entry" role="listitem">
———. 1960. <em>The Design of Experiments</em>. 7th ed. Edinburgh: <span>Oliver and Boyd Ltd</span>. <a href="https://archive.org/details/designofexperime0000rona_q7u5">https://archive.org/details/designofexperime0000rona_q7u5</a>.
</div>
<div id="ref-pitman1937significance" class="csl-entry" role="listitem">
Pitman, Edwin JG. 1937. <span>“Significance Tests Which May Be Applied to Samples from Any Populations.”</span> <em>Supplement to the Journal of the Royal Statistical Society</em> 4 (1): 119–30. <a href="https://www.jstor.org/stable/pdf/2984124.pdf">https://www.jstor.org/stable/pdf/2984124.pdf</a>.
</div>
<div id="ref-rosner1995biostatistics" class="csl-entry" role="listitem">
Rosner, Bernard. 1995. <em>Fundamentals of Biostatistics</em>. 4th ed. Belmont: Wadsworth Publishing Company. <a href="https://archive.org/details/fundamentalsofbi00rosn">https://archive.org/details/fundamentalsofbi00rosn</a>.
</div>
<div id="ref-simon1996effects" class="csl-entry" role="listitem">
Simon, Julian Lincoln, and David M Simon. 1996. <span>“The Effects of Regulations on State Liquor Prices.”</span> <em>Empirica</em> 23: 303–16.
</div>
</div>
</section>
</section>
<aside id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes">
<hr>
<ol>
<li id="fn1"><p>Technical Note: The test described in this section is non-parametric and therefore makes no assumptions about the shapes of the distributions, which is good because we would be on soft ground if we assumed normality in the pig-food case, given the sample sizes. This test does not, however, throw away information as do the rank and median tests illustrated earlier. And indeed, this test proves to be more powerful than the other non-parametric tests. After developing this test, I discovered that its general logic follows the tradition of the “randomization” tests, based on an idea by R.A. Fisher <span class="citation" data-cites="fisher1935design fisher1960design">(<a href="references.html#ref-fisher1935design" role="doc-biblioref">1935</a>; <a href="references.html#ref-fisher1960design" role="doc-biblioref">1960, chap. III</a>, section 21)</span> and worked out for the two-sample cases by E.J.G. Pitman <span class="citation" data-cites="pitman1937significance">(<a href="references.html#ref-pitman1937significance" role="doc-biblioref">1937</a>)</span>. But the only earlier mentions of sampling from the universe of possibilities are in M. Dwass <span class="citation" data-cites="dwass1957modified">(<a href="references.html#ref-dwass1957modified" role="doc-biblioref">1957</a>)</span> and J.H. Chung and D. Fraser <span class="citation" data-cites="chung1958randomization">(<a href="references.html#ref-chung1958randomization" role="doc-biblioref">1958</a>)</span>. I am grateful to J. Pratt for bringing the latter literature to my attention.<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn2"><p>This short comment is the tip of the iceberg of an argument that has been going on for 200 years among statisticians. It needs much more discussion to be understandable or persuasive.<a href="#fnref2" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn3"><p>The data are from <em>The Liquor Handbook</em> (1962, p.&nbsp;68). Eight states are omitted for various reasons. For more information, see Simon and Simon <span class="citation" data-cites="simon1996effects">(<a href="references.html#ref-simon1996effects" role="doc-biblioref">1996</a>)</span>.<a href="#fnref3" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn4"><p>Various tests indicate that the difference between the groups of states was highly significant. See Simon and Simon <span class="citation" data-cites="simon1996effects">(<a href="references.html#ref-simon1996effects" role="doc-biblioref">1996</a>)</span>.<a href="#fnref4" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn5"><p>Technical Note: Computing the sum of squared differences renders this test superficially more similar to the analysis of variance but will not alter the results. This test has not been discussed in the statistical literature, to my knowledge, except perhaps for a faint suggestion at the end of Chung and Fraser <span class="citation" data-cites="chung1958randomization">(<a href="references.html#ref-chung1958randomization" role="doc-biblioref">1958</a>)</span>. This and the two-sample test can easily be performed with canned computer programs as well as R. In addition to their advantages of nonparametricity, they are equally efficient and vastly easier to teach and to understand than the t-test and the analysis of variance. Therefore, we believe that these tests should be “treatments of choice,” as the doctors say.<a href="#fnref5" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</aside>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./testing_counts_2.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">23</span>&nbsp; <span class="chapter-title">The Statistics of Hypothesis-Testing with Counted Data, Part 2</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./testing_procedures.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">25</span>&nbsp; <span class="chapter-title">General Procedures for Testing Hypotheses</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->



</body></html>