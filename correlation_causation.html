<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.1">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>29&nbsp; Correlation and Causation – Resampling statistics</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./how_big_sample.html" rel="next">
<link href="./reliability_average.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script type="text/javascript">
  $(document).ready(function() {
    $("table").addClass('lightable-paper lightable-striped lightable-hover')
  });
</script>
<script src="site_libs/kePrint-0.0.1/kePrint.js"></script>
<link href="site_libs/lightable-0.0.1/lightable.css" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="style.css">
<link rel="stylesheet" href="font-awesome.min.css">
</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./correlation_causation.html"><span class="chapter-number">29</span>&nbsp; <span class="chapter-title">Correlation and Causation</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Resampling statistics</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">R edition</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./preface_third.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface to the third edition</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./preface_second.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface to the second edition</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./resampling_method.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">The resampling method</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./what_is_probability.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">What is probability?</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./about_technology.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Introducing R and the Jupyter notebook</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./resampling_with_code.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Resampling with code</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./resampling_with_code2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">More resampling with code</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./sampling_tools.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Tools for samples and sampling</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./probability_theory_1a.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Probability Theory, Part 1</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./probability_theory_1b.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Probability Theory Part I (continued)</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./more_sampling_tools.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Two puzzles and more tools</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./probability_theory_2_compound.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Probability Theory, Part 2: Compound Probability</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./probability_theory_3.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Probability Theory, Part 3</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./probability_theory_4_finite.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Probability Theory, Part 4: Estimating Probabilities from Finite Universes</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./sampling_variability.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">On Variability in Sampling</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./monte_carlo.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">The Procedures of Monte Carlo Simulation (and Resampling)</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./standard_scores.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Ranks, Quantiles and Standard Scores</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./inference_ideas.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">The Basic Ideas in Statistical Inference</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./inference_intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Introduction to Statistical Inference</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./point_estimation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Point Estimation</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./framing_questions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Framing Statistical Questions</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./testing_counts_1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">Hypothesis-Testing with Counted Data, Part 1</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./significance.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">22</span>&nbsp; <span class="chapter-title">The Concept of Statistical Significance in Testing Hypotheses</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./testing_counts_2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">23</span>&nbsp; <span class="chapter-title">The Statistics of Hypothesis-Testing with Counted Data, Part 2</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./testing_measured.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">24</span>&nbsp; <span class="chapter-title">The Statistics of Hypothesis-Testing With Measured Data</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./testing_procedures.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">25</span>&nbsp; <span class="chapter-title">General Procedures for Testing Hypotheses</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./confidence_1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">26</span>&nbsp; <span class="chapter-title">Confidence Intervals, Part 1: Assessing the Accuracy of Samples</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./confidence_2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">27</span>&nbsp; <span class="chapter-title">Confidence Intervals, Part 2: The Two Approaches to Estimating Confidence Intervals</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./reliability_average.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">28</span>&nbsp; <span class="chapter-title">Some Last Words About the Reliability of Sample Averages</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./correlation_causation.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">29</span>&nbsp; <span class="chapter-title">Correlation and Causation</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./how_big_sample.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">30</span>&nbsp; <span class="chapter-title">How Large a Sample?</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./bayes_simulation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">31</span>&nbsp; <span class="chapter-title">Bayesian Analysis by Simulation</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./exercise_solutions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">32</span>&nbsp; <span class="chapter-title">Exercise Solutions</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./acknowlegements.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">33</span>&nbsp; <span class="chapter-title">Acknowledgements</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./technical_note.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">34</span>&nbsp; <span class="chapter-title">Technical Note to the Professional Reader</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#preview" id="toc-preview" class="nav-link active" data-scroll-target="#preview"><span class="header-section-number">29.1</span> Preview</a></li>
  <li><a href="#introduction-to-correlation-and-causation" id="toc-introduction-to-correlation-and-causation" class="nav-link" data-scroll-target="#introduction-to-correlation-and-causation"><span class="header-section-number">29.2</span> Introduction to correlation and causation</a></li>
  <li><a href="#a-note-on-association-compared-to-testing-a-hypothesis" id="toc-a-note-on-association-compared-to-testing-a-hypothesis" class="nav-link" data-scroll-target="#a-note-on-association-compared-to-testing-a-hypothesis"><span class="header-section-number">29.3</span> A Note on Association Compared to Testing a Hypothesis</a>
  <ul class="collapse">
  <li><a href="#sec-athletic-iq-ranks" id="toc-sec-athletic-iq-ranks" class="nav-link" data-scroll-target="#sec-athletic-iq-ranks"><span class="header-section-number">29.3.1</span> Example: Is Athletic Ability Directly Related to Intelligence?</a></li>
  <li><a href="#example-athletic-ability-and-i.q.-a-third-way" id="toc-example-athletic-ability-and-i.q.-a-third-way" class="nav-link" data-scroll-target="#example-athletic-ability-and-i.q.-a-third-way"><span class="header-section-number">29.3.2</span> Example: Athletic ability and I.Q. — a third way</a></li>
  </ul></li>
  <li><a href="#sec-sum-products" id="toc-sec-sum-products" class="nav-link" data-scroll-target="#sec-sum-products"><span class="header-section-number">29.4</span> Correlation with sum of products</a>
  <ul class="collapse">
  <li><a href="#sec-ath-iq-sop" id="toc-sec-ath-iq-sop" class="nav-link" data-scroll-target="#sec-ath-iq-sop"><span class="header-section-number">29.4.1</span> Example: sum of products correlation of athletic and IQ scores</a></li>
  <li><a href="#example-correlation-between-adherence-to-medication-regime-and-change-in-cholesterol" id="toc-example-correlation-between-adherence-to-medication-regime-and-change-in-cholesterol" class="nav-link" data-scroll-target="#example-correlation-between-adherence-to-medication-regime-and-change-in-cholesterol"><span class="header-section-number">29.4.2</span> Example: Correlation Between Adherence to Medication Regime and Change in Cholesterol</a></li>
  </ul></li>
  <li><a href="#sec-correlation-coefficient" id="toc-sec-correlation-coefficient" class="nav-link" data-scroll-target="#sec-correlation-coefficient"><span class="header-section-number">29.5</span> The correlation coefficient</a>
  <ul class="collapse">
  <li><a href="#correlations-are-symmetrical" id="toc-correlations-are-symmetrical" class="nav-link" data-scroll-target="#correlations-are-symmetrical"><span class="header-section-number">29.5.1</span> Correlations are symmetrical</a></li>
  <li><a href="#the-correlation-coefficient-in" id="toc-the-correlation-coefficient-in" class="nav-link" data-scroll-target="#the-correlation-coefficient-in"><span class="header-section-number">29.5.2</span> The correlation coefficient in R</a></li>
  <li><a href="#test-linear-association-with-the-correlation-coefficient" id="toc-test-linear-association-with-the-correlation-coefficient" class="nav-link" data-scroll-target="#test-linear-association-with-the-correlation-coefficient"><span class="header-section-number">29.5.3</span> Test linear association with the correlation coefficient</a></li>
  </ul></li>
  <li><a href="#sec-counted-association" id="toc-sec-counted-association" class="nav-link" data-scroll-target="#sec-counted-association"><span class="header-section-number">29.6</span> Testing for a relationship between counted-data variables</a>
  <ul class="collapse">
  <li><a href="#example-drinking-beer-and-being-in-favor-of-selling-beer" id="toc-example-drinking-beer-and-being-in-favor-of-selling-beer" class="nav-link" data-scroll-target="#example-drinking-beer-and-being-in-favor-of-selling-beer"><span class="header-section-number">29.6.1</span> Example: Drinking Beer And Being In Favor of Selling Beer</a></li>
  <li><a href="#example-do-athletes-really-have-slumps" id="toc-example-do-athletes-really-have-slumps" class="nav-link" data-scroll-target="#example-do-athletes-really-have-slumps"><span class="header-section-number">29.6.2</span> Example: do athletes really have “slumps”?</a></li>
  </ul></li>
  <li><a href="#exercises" id="toc-exercises" class="nav-link" data-scroll-target="#exercises"><span class="header-section-number">29.7</span> Exercises</a>
  <ul class="collapse">
  <li><a href="#sec-exr-voter-participation" id="toc-sec-exr-voter-participation" class="nav-link" data-scroll-target="#sec-exr-voter-participation"><span class="header-section-number">29.7.1</span> Exercise: voter participation</a></li>
  <li><a href="#sec-exr-runs-strikeouts" id="toc-sec-exr-runs-strikeouts" class="nav-link" data-scroll-target="#sec-exr-runs-strikeouts"><span class="header-section-number">29.7.2</span> Exercise: association of runs and strikeouts</a></li>
  <li><a href="#sec-exr-runs-strikeouts-r" id="toc-sec-exr-runs-strikeouts-r" class="nav-link" data-scroll-target="#sec-exr-runs-strikeouts-r"><span class="header-section-number">29.7.3</span> Exercise: runs, strikeouts, correlation coefficient</a></li>
  <li><a href="#sec-exr-money-exchange" id="toc-sec-exr-money-exchange" class="nav-link" data-scroll-target="#sec-exr-money-exchange"><span class="header-section-number">29.7.4</span> Exercise: money and exchange rate</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span id="sec-correlation-causation" class="quarto-section-identifier"><span class="chapter-number">29</span>&nbsp; <span class="chapter-title">Correlation and Causation</span></span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="preview" class="level2" data-number="29.1">
<h2 data-number="29.1" class="anchored" data-anchor-id="preview"><span class="header-section-number">29.1</span> Preview</h2>
<p>The correlation (speaking in a loose way for now) between two variables measures the strength of the relationship between them. A positive “linear” correlation between two variables <span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span> implies that high values of <span class="math inline">\(x\)</span> are associated with high values of <span class="math inline">\(y\)</span>, and that low values of <span class="math inline">\(x\)</span> are associated with low values of <span class="math inline">\(y\)</span>. A negative correlation implies the opposite; high values of <span class="math inline">\(x\)</span> are associated with <em>low</em> values of <span class="math inline">\(y\)</span>. By definition a “correlation coefficient” (<a href="#sec-correlation-coefficient" class="quarto-xref"><span>Section 29.5</span></a>) close to zero indicates little or no linear relationship between two variables; correlation coefficients close to 1 and -1 denote a strong positive or negative relationship. We will start by using a simpler measure of correlation than the correlation coefficient, however.</p>
<p>One way to measure correlation with the resampling method is to rank both variables from highest to lowest, and investigate how often in randomly-generated samples the rankings of the two variables are as close to each other as the rankings in the observed variables. A better approach, because it uses more of the quantitative information contained in the data — though it requires more computation — is to multiply the values for the corresponding pairs of values for the two variables, and compare the sum of the resulting products to the analogous sum for randomly-generated pairs of the observed variable values (<a href="#sec-sum-products" class="quarto-xref"><span>Section 29.4</span></a>). The last section of the chapter (<a href="#sec-counted-association" class="quarto-xref"><span>Section 29.6</span></a>) shows how the strength of a relationship can be determined when the data are counted, rather than measured. First comes some discussion of the philosophical issues involved in correlation and causation.</p>
</section>
<section id="introduction-to-correlation-and-causation" class="level2" data-number="29.2">
<h2 data-number="29.2" class="anchored" data-anchor-id="introduction-to-correlation-and-causation"><span class="header-section-number">29.2</span> Introduction to correlation and causation</h2>
<p>The questions in examples <a href="probability_theory_3.html#sec-birthday-problem" class="quarto-xref"><span>Section 12.1</span></a> to <a href="probability_theory_4_finite.html#sec-fifteen-bridge" class="quarto-xref"><span>Section 13.3.3</span></a> have been stated in the following form: Does the independent variable (say, irradiation; or type of pig ration) have an effect upon the dependent variable (say, sex of fruit flies; or weight gain of pigs)? This is another way to state the following question: Is there a <em>causal relationship</em> between the independent variable(s) and the dependent variable? (“Independent” or “control” is the name we give to the variable(s) the researcher believes is (are) responsible for changes in the other variable, which we call the “dependent” or “response” variable.)</p>
<p>A causal relationship cannot be defined perfectly neatly. Even an experiment does not determine perfectly whether a relationship deserves to be called “causal” because, among other reasons, the independent variable may not be clear-cut. For example, even if cigarette smoking experimentally produces cancer in rats, it might be the paper and not the tobacco that causes the cancer. Or consider the fabled gentlemen who got experimentally drunk on bourbon and soda on Monday night, scotch and soda on Tuesday night, and brandy and soda on Wednesday night — and stayed sober on Thursday night by drinking nothing. With a vast inductive leap of scientific imagination, they treated their experience as an empirical demonstration that soda, the common element each evening, was the cause of the inebriated state they had experienced. Notice that their deduction was perfectly sound, given only the recent evidence they had. Other knowledge of the world is necessary to set them straight. That is, even in a controlled experiment there is often no way except subject-matter knowledge to avoid erroneous conclusions about causality. Nothing except substantive knowledge or scientific intuition would have led them to the recognition that it is the alcohol rather than the soda that made them drunk, <em>as long as they always took soda with their drinks</em> . And no statistical procedure can suggest to them that they ought to experiment with the presence and absence of soda. If this is true for an experiment, it must also be true for an uncontrolled study.</p>
<p>Here are some tests that a relationship usually must pass to be called causal. That is, a working definition of a particular causal relationship is expressed in a statement that has these important characteristics:</p>
<ol type="1">
<li><p>It is an association that is strong enough so that the observer believes it to have a predictive (explanatory) power great enough to be scientifically useful or interesting. For example, he is not likely to say that wearing glasses causes (or is a cause of) auto accidents if the observed <em>correlation coefficient</em> is .07<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a>, even if the sample is large enough to make the correlation statistically convincing. In other words, unimportant relationships are not likely to be labeled causal.</p>
<p>Various observers may well differ in judging whether or not an association is strong enough to be important and therefore “causal.” And the particular field in which the observer works may affect this judgment. This is an indication that whether or not a relationship is dubbed “causal” involves a good deal of human judgment and is subject to dispute.</p></li>
<li><p>The “side conditions” must be sufficiently <em>few</em> and sufficiently observable so that the relationship will apply under a wide enough range of conditions to be considered useful or interesting. In other words, <em>the relationship must not require too many “if”s, “and”s, and “but”s in order to hold</em> . For example, one might say that an increase in income caused an increase in the birth rate if this relationship were observed everywhere. But, if the relationship were found to hold only in developed countries, among the educated classes, and among the higher-income groups, then it would be less likely to be called “causal” — even if the correlation were extremely high once the specified conditions had been met. A similar example can be made of the relationship between income and happiness.</p></li>
<li><p>For a relationship to be called “causal,” there should be sound reason to believe that, even if the control variable were not the “real” cause (and it never is), other relevant “hidden” and “real” cause variables must also change <em>consistently</em> with changes in the control variables. That is, a variable being manipulated may reasonably be called “causal” if the real variable for which it is believed to be a proxy must always be tied intimately to it. (Between two variables, v and w, v may be said to be the “more real” cause and <em>w</em> a “spurious” cause, if <em>v</em> and <em>w</em> require the same side conditions, except that <em>v</em> does not require <em>w</em> as a side condition.) This third criterion (non-spuriousness) is of particular importance to policy makers. The difference between it and the previous criterion for side conditions is that a plenitude of very restrictive side conditions may take the relationship out of the class of causal relationships, <em>even though the effects of the side conditions are known</em> . This criterion of nonspuriousness concerns variables that are as yet <em>unknown and unevaluated</em> but that have a <em>possible</em> ability to <em>upset</em> the observed association.</p>
<p>Examples of spurious relationships and hidden-third-factor causation are commonplace. For a single example, toy sales rise in December. There is no danger in saying that December causes an increase in toy sales, even though it is “really” Christmas that causes the increase, because Christmas and December practically always accompany each other.</p>
<p>Belief that the relationship is not spurious is increased if <em>many</em> likely variables have been investigated and none removes the relationship. This is further demonstration that the test of whether or not an association should be called “causal” cannot be a logical one; there is no way that one can express in symbolic logic the fact that many other variables have been tried without changing the relationship in question.</p></li>
<li><p>The more tightly a relationship is bound into (that is, deduced from, compatible with, and logically connected to) a general framework of theory, the stronger is its claim to be called “causal.” For an economics example, observed positive relationships between the interest rate and business investment and between profits and investment are more likely to be called “causal” than is the relationship between liquid assets and investment. This is so because the first two statements can be deduced from classical price theory, whereas the third statement cannot. Connection to a theoretical framework provides support for belief that the side conditions necessary for the statement to hold true are not restrictive and that the likelihood of spurious correlation is not great; because a statement is logically connected to the rest of the system, the statement tends to stand or fall as the rest of the system stands or falls. And, because the rest of the system of economic theory has, over a long period of time and in a wide variety of tests, been shown to have predictive power, a statement connected with it is cloaked in this mantle.</p></li>
</ol>
<p>variable completely predicts another with a linear association) through 0 (the variables have no linear association) to -1 (one variable completely predict the other, but positive values in one are associated with negative values in the other).</p>
<p>The social sciences other than economics do not have such well-developed bodies of deductive theory, and therefore this criterion of causality does not weigh as heavily in sociology, for instance, as in economics. Rather, the other social sciences seem to substitute a weaker and more general criterion, that is, whether or not the statement of the relationship is accompanied by other statements that seem to “explain” the “mechanism” by which the relationship operates. Consider, for example, the relationship between the phases of the moon and the suicide rate. The reason that sociologists do not call it causal is that there are no auxiliary propositions that explain the relationship and describe an operative mechanism. On the other hand, the relationship between broken homes and youth crime is often referred to as “causal,” presumably because a large body of psychological theory serves to explain why a child raised without one or the other parent, or in the presence of parental strife, should not adjust readily.</p>
<p>Furthermore, one can never decide with perfect certainty whether in any <em>given</em> situation one variable “causes” a particular change in another variable. At best, given your particular purposes in investigating a phenomena, you may be safe in judging that very likely there is causal influence.</p>
<p>In brief, it is correct to say (as it is so often said) that correlation does not prove causation — if we add the word “completely” to make it “correlation does not <em>completely</em> prove causation.” On the other hand, causation can <em>never</em> be “proven” <em>completely</em> by correlation <em>or any other</em> tool or set of tools, including experimentation. The best we can do is make informed judgments about whether to call a relationship causal.</p>
<p>It is clear, however, that in any situation where we are interested in the possibility of causation, we must <em>at least</em> know whether there is a relationship (correlation) between the variables of interest; the existence of a relationship is necessary for a relationship to be judged causal even if it is not sufficient to receive the causal label. And in other situations where we are not even interested in causality, but rather simply want to predict events or understand the structure of a system, we may be interested in the existence of relationships quite apart from questions about causations. Therefore our next set of problems deals with the probability of there being a relationship between two measured variables, variables that can take on any values (say, the values on a test of athletic scores) rather than just two values (say, whether or not there has been irradiation.)<a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a></p>
<p>Another way to think about such problems is to ask whether two variables are <em>independent</em> of each other — that is, whether you know anything about the value of one variable if you know the value of the other in a particular case — or whether they are not independent but rather are related.</p>
</section>
<section id="a-note-on-association-compared-to-testing-a-hypothesis" class="level2" data-number="29.3">
<h2 data-number="29.3" class="anchored" data-anchor-id="a-note-on-association-compared-to-testing-a-hypothesis"><span class="header-section-number">29.3</span> A Note on Association Compared to Testing a Hypothesis</h2>
<p>Problems in which we investigate a) whether there is an <em>association</em> , versus b) whether there is a <em>difference</em> between just two groups, often look very similar, especially when the data constitute a 2-by-2 table. There is this important difference between the two types of analysis, however: Questions about <em>association</em> refer to <em>variables</em> — say weight and age — and it never makes sense to ask whether there is a difference between variables (except when asking whether they measure the same quantity). Questions about <em>similarity or difference</em> refer to <em>groups of individuals</em> , and in such a situation it does make sense to ask whether or not two groups are observably different from each other.</p>
<section id="sec-athletic-iq-ranks" class="level3" data-number="29.3.1">
<h3 data-number="29.3.1" class="anchored" data-anchor-id="sec-athletic-iq-ranks"><span class="header-section-number">29.3.1</span> Example: Is Athletic Ability Directly Related to Intelligence?</h3>
<p>A more specific version of our question: <strong>is there correlation between the two variables or are they independent?</strong></p>
<p>A scientist often wants to know whether or not two characteristics go together, that is, whether or not they are correlated (that is, related or associated). For example, do young adults with high athletic ability tend to also have high I.Q.s?</p>
<p>Hypothetical physical-education scores of a group of ten high-school boys are shown in <a href="#tbl-physical-mental" class="quarto-xref">Table&nbsp;<span>29.1</span></a>, ordered from high to low, along with the I.Q. score for each boy. The ranks for each student’s athletic and I.Q. scores are then shown in the third and fourth columns:</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="tbl-physical-mental" class="lightable-paper lightable-striped lightable-hover quarto-float quarto-figure quarto-figure-center anchored" style="font-family: &quot;Arial Narrow&quot;, arial, helvetica, sans-serif; width: auto !important; margin-left: auto; margin-right: auto;" data-quarto-postprocess="true">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-physical-mental-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;29.1: Hypothetical athletic and I.Q. scores for high school boys
</figcaption>
<div aria-describedby="tbl-physical-mental-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table class="lightable-paper lightable-striped lightable-hover caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: right;" data-quarto-table-cell-role="th">Athletic Score</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">I.Q. Score</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Athletic Rank</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">I.Q.Rank</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">97</td>
<td style="text-align: right;">114</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">3</td>
</tr>
<tr class="even">
<td style="text-align: right;">94</td>
<td style="text-align: right;">120</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="odd">
<td style="text-align: right;">93</td>
<td style="text-align: right;">107</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">7</td>
</tr>
<tr class="even">
<td style="text-align: right;">90</td>
<td style="text-align: right;">113</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">4</td>
</tr>
<tr class="odd">
<td style="text-align: right;">87</td>
<td style="text-align: right;">118</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="even">
<td style="text-align: right;">86</td>
<td style="text-align: right;">101</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">8</td>
</tr>
<tr class="odd">
<td style="text-align: right;">86</td>
<td style="text-align: right;">109</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">6</td>
</tr>
<tr class="even">
<td style="text-align: right;">85</td>
<td style="text-align: right;">110</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">5</td>
</tr>
<tr class="odd">
<td style="text-align: right;">81</td>
<td style="text-align: right;">100</td>
<td style="text-align: right;">9</td>
<td style="text-align: right;">9</td>
</tr>
<tr class="even">
<td style="text-align: right;">76</td>
<td style="text-align: right;">99</td>
<td style="text-align: right;">10</td>
<td style="text-align: right;">10</td>
</tr>
</tbody>
</table>
</div>
</figure>
</div>


</div>
</div>
<p><a href="#fig-ath-iq-scatter" class="quarto-xref">Figure&nbsp;<span>29.1</span></a> is a <em>scatterplot</em> with “Athletic Score” on the x-axis and “I.Q. Score” on the y-axis. Each point on the plot corresponds to one row of <a href="#tbl-physical-mental" class="quarto-xref">Table&nbsp;<span>29.1</span></a> (and therefore one boy); in particular each point is at the <span class="math inline">\(x\)</span>, <span class="math inline">\(y\)</span> coordinate given by the values in “Athletic Score” and “I.Q. Score”. For example the point for the first boy is at position x=97, y=114.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-ath-iq-scatter" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ath-iq-scatter-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="correlation_causation_files/figure-html/fig-ath-iq-scatter-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:70.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ath-iq-scatter-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;29.1: Scatter plot of I.Q. Score as a function of Athletic Score
</figcaption>
</figure>
</div>
</div>
</div>
<p>We want to know whether a high score on athletic ability tends to be found along with a high I.Q. score more often than would be expected by chance. Therefore, our strategy is to see how often high scores on <em>both</em> variables are found by chance. We do this by disassociating the two variables and making two separate and independent universes, one composed of the athletic scores and another of the I.Q. scores. Then we draw pairs of observations from the two universes at random, and compare the experimental patterns that occur by chance to what actually is observed to occur in the world.</p>
<p>The first testing scheme we shall use is similar to our first approach to the pig rations — splitting the results into just “highs” and “lows.” We take ten cards, one of each denomination from “ace” to “10,” shuffle, and deal five cards to correspond to the first five athletic ranks. The face values then correspond to the I.Q. ranks. Under the benchmark hypothesis the athletic ranks will not be associated with the I.Q. ranks. Add the face values in the first five cards in each trial; the first hand includes 2, 4, 5, 6, and 9, so the sum is 26. Record, shuffle, and repeat perhaps ten times. Then compare the random results to the sum of the observed ranks of the five top athletes, which equals 17.</p>
<p>The following steps describe a slightly different procedure than that just described, because this one may be easier to understand:</p>
<ul>
<li><strong>Step 1.</strong> Convert the athletic and I.Q. scores to ranks. Then constitute a universe of spades, “ace” to “10,” to correspond to the athletic ranks, and a universe of hearts, “ace” to “10,” to correspond to the IQ ranks.</li>
<li><strong>Step 2.</strong> Deal out the well-shuffled cards into pairs, each pair with an athletic score and an I.Q. score.</li>
<li><strong>Step 3.</strong> Locate the cards with the top five athletic ranks, and add the I.Q. rank scores on their paired cards. Compare this sum to the observed sum of 17. If 17 or less, indicate “yes,” otherwise “no.” (Why do we use “17 or less” rather than “less than 17”? Because we are asking the probability of a score <em>this low or lower</em>.)</li>
<li><strong>Step 4.</strong> Repeat steps 2 and 3 ten times.</li>
<li><strong>Step 5.</strong> Calculate the proportion “yes.” This estimates the probability sought.</li>
</ul>
<p>In <a href="#tbl-ability-trials" class="quarto-xref">Table&nbsp;<span>29.2</span></a> we see that the observed sum (17) is lower than the sum of the top 5 ranks in all but one (shown in bold) of the ten random trials (trial 5), which suggests that there is a good chance (9 in 10) that the five best athletes will not have I.Q. scores that high by chance. But it might be well to deal some more to get a more reliable average. We add thirty hands, and thirty-nine of the total forty hands exceed the observed rank value, so the probability that the observed correlation of athletic and I.Q. scores would occur by chance is about .025. In other words, if there is no real association between the variables, the probability that the top 5 ranks would sum to a number this low or lower is only 1 in 40, and it therefore seems reasonable to believe that high athletic ability tends to accompany a high I.Q.</p>
<div id="tbl-ability-trials" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-ability-trials-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;29.2: 40 random trials of the athletic / IQ problem
</figcaption>
<div aria-describedby="tbl-ability-trials-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table class="caption-top table">
<thead>
<tr class="header">
<th>Trial</th>
<th>Sum of IQ Ranks</th>
<th>&lt;= observed (17)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>26</td>
<td>No</td>
</tr>
<tr class="even">
<td>2</td>
<td>23</td>
<td>No</td>
</tr>
<tr class="odd">
<td>3</td>
<td>22</td>
<td>No</td>
</tr>
<tr class="even">
<td>4</td>
<td>37</td>
<td>No</td>
</tr>
<tr class="odd">
<td><strong>5</strong></td>
<td><strong>16</strong></td>
<td><strong>Yes</strong></td>
</tr>
<tr class="even">
<td>6</td>
<td>22</td>
<td>No</td>
</tr>
<tr class="odd">
<td>7</td>
<td>22</td>
<td>No</td>
</tr>
<tr class="even">
<td>8</td>
<td>28</td>
<td>No</td>
</tr>
<tr class="odd">
<td>9</td>
<td>38</td>
<td>No</td>
</tr>
<tr class="even">
<td>10</td>
<td>22</td>
<td>No</td>
</tr>
<tr class="odd">
<td>11</td>
<td>35</td>
<td>No</td>
</tr>
<tr class="even">
<td>12</td>
<td>36</td>
<td>No</td>
</tr>
<tr class="odd">
<td>13</td>
<td>31</td>
<td>No</td>
</tr>
<tr class="even">
<td>14</td>
<td>29</td>
<td>No</td>
</tr>
<tr class="odd">
<td>15</td>
<td>32</td>
<td>No</td>
</tr>
<tr class="even">
<td>16</td>
<td>25</td>
<td>No</td>
</tr>
<tr class="odd">
<td>17</td>
<td>25</td>
<td>No</td>
</tr>
<tr class="even">
<td>18</td>
<td>29</td>
<td>No</td>
</tr>
<tr class="odd">
<td>19</td>
<td>25</td>
<td>No</td>
</tr>
<tr class="even">
<td>20</td>
<td>22</td>
<td>No</td>
</tr>
<tr class="odd">
<td>21</td>
<td>30</td>
<td>No</td>
</tr>
<tr class="even">
<td>22</td>
<td>31</td>
<td>No</td>
</tr>
<tr class="odd">
<td>23</td>
<td>35</td>
<td>No</td>
</tr>
<tr class="even">
<td>24</td>
<td>25</td>
<td>No</td>
</tr>
<tr class="odd">
<td>25</td>
<td>33</td>
<td>No</td>
</tr>
<tr class="even">
<td>26</td>
<td>30</td>
<td>No</td>
</tr>
<tr class="odd">
<td>27</td>
<td>24</td>
<td>No</td>
</tr>
<tr class="even">
<td>28</td>
<td>29</td>
<td>No</td>
</tr>
<tr class="odd">
<td>29</td>
<td>30</td>
<td>No</td>
</tr>
<tr class="even">
<td>30</td>
<td>31</td>
<td>No</td>
</tr>
<tr class="odd">
<td>31</td>
<td>30</td>
<td>No</td>
</tr>
<tr class="even">
<td>32</td>
<td>21</td>
<td>No</td>
</tr>
<tr class="odd">
<td>33</td>
<td>25</td>
<td>No</td>
</tr>
<tr class="even">
<td>34</td>
<td>19</td>
<td>No</td>
</tr>
<tr class="odd">
<td>35</td>
<td>29</td>
<td>No</td>
</tr>
<tr class="even">
<td>36</td>
<td>23</td>
<td>No</td>
</tr>
<tr class="odd">
<td>37</td>
<td>23</td>
<td>No</td>
</tr>
<tr class="even">
<td>38</td>
<td>34</td>
<td>No</td>
</tr>
<tr class="odd">
<td>39</td>
<td>23</td>
<td>No</td>
</tr>
<tr class="even">
<td>40</td>
<td>26</td>
<td>No</td>
</tr>
</tbody>
</table>
</div>
</figure>
</div>
<p>In fact we can apply an even simpler procedure to get the same result, by reasoning about the individual trial.</p>
<p>One trial in our procedure is:</p>
<ul>
<li><strong>Step 2.</strong> Deal out the well-shuffled cards into pairs, each pair with an athletic score and an I.Q. score.</li>
<li><strong>Step 3.</strong> Locate the cards with the top five athletic ranks, and add the I.Q. rank scores on their paired cards. Compare this sum to the observed sum of 17. If 17 or less, indicate “yes,” otherwise “no.” (Why do we use “17 or less” rather than “less than 17”? Because we are asking the probability of a score <em>this low or lower</em>.)</li>
</ul>
<p>Now consider the 5 IQ rank cards. In the procedure above, we found these by <em>first</em> pairing the athletic ranks and the IQ ranks, <em>then</em> selecting the IQ ranks corresponding to the top 5 athletic ranks. A little thought may persuade you, that by doing this, we have have a <em>random selection of 5 IQ ranks</em>. We got that random selection by pairing, selecting on athletic rank — but the initial pairing and selection will do nothing other than giving us one particular set of randomly chosen 5 IQ rank cards. So we can simplify our procedure even further by missing out the pairing and selecting by rank steps; we can just shuffle the IQ rank cards and deal out 5 to be our randomly selected IQ ranks.</p>
<div class="notebook" name="athlete_iq" title="Athletic ability and IQ">
<p>Start of <code>athlete_iq</code> notebook</p>
<div class="nb-links">
<a class="notebook-link" href="notebooks/athlete_iq.Rmd">Download notebook</a>
<a class="interact-button" href="./interact/lab/index.html?path=athlete_iq.ipynb">Interact</a>
</div>

<p>To simulate this problem in R, we first create a vector containing the I.Q. rankings of the top 5 students in athletics. The <code>sum</code> of these I.Q. rankings constitutes the observed result to be tested against randomly-drawn samples. We observe that the actual I.Q. rankings of the top five athletes sums to 17. The more frequently that the sum of 5 randomly-generated rankings (out of 10) is as low as this observed number, the higher is the probability that there is no relationship between athletic performance and I.Q. based on these data.</p>
<p>First we record the 1 through 10 into vector <code>iq_ranks</code>. Then we shuffle the numbers so the rankings are in a random order. Then select the first 5 of these numbers and put them in another vector, <code>top_5</code>, and <code>sum</code> them, putting the result in <code>top_5_sum</code>. We repeat this procedure <code>N = 10000</code> times, recording each result in a scorekeeping vector: <code>z</code>. Graphing <code>z</code>, we get a histogram that shows us how often our randomly assigned sums are equal to or below 17.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Number of repeats.</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>n_trials <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="co"># The IQ ranks, ready for shuffling.</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>iq_ranks <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>  <span class="co"># 1 through 10.</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Scorekeeping array.</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>results <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n_trials)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n_trials) {</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Shuffle the ranks.</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>    shuffled <span class="ot">&lt;-</span> <span class="fu">sample</span>(iq_ranks)</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Take the first 5 ranks.</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>    top_5 <span class="ot">&lt;-</span> shuffled[<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>]</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Sum those ranks.</span></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>    top_5_sum <span class="ot">&lt;-</span> <span class="fu">sum</span>(top_5)</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Keep track of the result of each trial.</span></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>    results[i] <span class="ot">&lt;-</span> top_5_sum</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>    <span class="co"># End the experiment, go back and repeat.</span></span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Produce a histogram of trial results.</span></span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Make the bins be the integers from 10 through 45.</span></span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(results, <span class="at">breaks=</span><span class="dv">10</span><span class="sc">:</span><span class="dv">45</span>, <span class="at">main=</span><span class="st">'Sums of 5 ranks selected at random'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="correlation_causation_files/figure-html/unnamed-chunk-4-3.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:70.0%"></p>
</figure>
</div>
</div>
</div>
<p>We see that in only about 2 % of the trials did random selection of ranks produce a total of 17 or lower. R can calculate this for us directly:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Determine how many trials produced sums of ranks &lt;= 17 by chance.</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="fu">sum</span>(results <span class="sc">&lt;=</span> <span class="dv">17</span>)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="co"># The proportion.</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>kk <span class="ot">&lt;-</span> k <span class="sc">/</span> n_trials</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Show the result.</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>kk</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.016</code></pre>
</div>
</div>
<p>End of <code>athlete_iq</code> notebook</p>
</div>
<!---
End of notebook
-->
<p>Why do we sum the ranks of the first <em>five</em> athletes rather than taking the sum of the top three, say? Indeed, we could have looked at the top three, two, four, or even six or seven. The first reason for splitting the group in half is that an even split uses the available information more fully, and therefore we obtain greater efficiency. (I cannot prove this formally here, but perhaps it makes intuitive sense to you.) A second reason is that getting into the habit of always looking at an even split reduces the chances that you will pick and choose in such a manner as to fool yourself. For example, if the I.Q. ranks of the top five athletes were 3, 2, 1, 10, and 9, we would be deceiving ourselves if, after looking the data over, we drew the line between athletes 3 and 4. (More generally, choosing an appropriate measure before examining the data will help you avoid fooling yourself in such matters.)</p>
<p>A simpler but less efficient approach to this same problem is to classify the top-half athletes by whether or not they were also in the top half of the I.Q. scores. Of the first five athletes actually observed, <em>four</em> were in the top five I.Q. scores. We can then shuffle five black and five red cards and see how often four or more (that is, four or five) blacks come up with the first five cards. The proportion of times that four or more blacks occurs in the trial is the probability that an association as strong as that observed might occur by chance even if there is no association. <a href="#tbl-top-rank-counts" class="quarto-xref">Table&nbsp;<span>29.3</span></a> shows a proportion of five trials out of twenty.</p>
<div id="tbl-top-rank-counts" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-top-rank-counts-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;29.3: Results of 20 random trials of the top-5 rank counts
</figcaption>
<div aria-describedby="tbl-top-rank-counts-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table class="caption-top table">
<thead>
<tr class="header">
<th>Trial</th>
<th>Score</th>
<th>Yes or No</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>4</td>
<td>Yes</td>
</tr>
<tr class="even">
<td>2</td>
<td>2</td>
<td>No</td>
</tr>
<tr class="odd">
<td>3</td>
<td>2</td>
<td>No</td>
</tr>
<tr class="even">
<td>4</td>
<td>2</td>
<td>No</td>
</tr>
<tr class="odd">
<td>5</td>
<td>3</td>
<td>No</td>
</tr>
<tr class="even">
<td>6</td>
<td>2</td>
<td>No</td>
</tr>
<tr class="odd">
<td>7</td>
<td>4</td>
<td>Yes</td>
</tr>
<tr class="even">
<td>8</td>
<td>3</td>
<td>No</td>
</tr>
<tr class="odd">
<td>9</td>
<td>3</td>
<td>No</td>
</tr>
<tr class="even">
<td>10</td>
<td>4</td>
<td>Yes</td>
</tr>
<tr class="odd">
<td>11</td>
<td>3</td>
<td>No</td>
</tr>
<tr class="even">
<td>12</td>
<td>1</td>
<td>No</td>
</tr>
<tr class="odd">
<td>13</td>
<td>3</td>
<td>No</td>
</tr>
<tr class="even">
<td>14</td>
<td>3</td>
<td>No</td>
</tr>
<tr class="odd">
<td>15</td>
<td>4</td>
<td>Yes</td>
</tr>
<tr class="even">
<td>16</td>
<td>3</td>
<td>No</td>
</tr>
<tr class="odd">
<td>17</td>
<td>2</td>
<td>No</td>
</tr>
<tr class="even">
<td>18</td>
<td>2</td>
<td>No</td>
</tr>
<tr class="odd">
<td>19</td>
<td>2</td>
<td>No</td>
</tr>
<tr class="even">
<td>20</td>
<td>4</td>
<td>Yes</td>
</tr>
</tbody>
</table>
</div>
</figure>
</div>
<div class="notebook" name="athlete_iq_rank_count" title="Athletic ability and IQ using rank counts">
<p>Start of <code>athlete_iq_rank_count</code> notebook</p>
<div class="nb-links">
<a class="notebook-link" href="notebooks/athlete_iq_rank_count.Rmd">Download notebook</a>
<a class="interact-button" href="./interact/lab/index.html?path=athlete_iq_rank_count.ipynb">Interact</a>
</div>

<p>In the R code below, we first note that the top 5 athletes had 4 of the top 5 I.Q. scores. So we constitute the set of 10 IQ rankings vector <code>iq_ranks</code>. We then shuffle <code>iq_ranks</code> and select the first 5 I.Q. rankings (out of 10). We count (<code>sum</code>) how many are in the top 5, and keep track of the result. After repeating 10,000 times using a <code>for</code> loop, we find out how often we select 4 of the top 5.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Number of repeats.</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>n_trials <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="co"># The IQ ranks, ready for shuffling.</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>iq_ranks <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>  <span class="co"># 1 through 10.</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Scorekeeping array.</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>results <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n_trials)</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n_trials) {</span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Shuffle the ranks.</span></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>    shuffled <span class="ot">&lt;-</span> <span class="fu">sample</span>(iq_ranks)</span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Take the first 5 ranks.</span></span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>    top_5 <span class="ot">&lt;-</span> shuffled[<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>]</span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Everything up until this point is the same as the code above.</span></span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Here is the difference.</span></span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Check whether the selected IQ ranks are in the top 5.</span></span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a>    are_top <span class="ot">&lt;-</span> top_5 <span class="sc">&lt;=</span> <span class="dv">5</span></span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Count how many were in the top 5</span></span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a>    n_are_top <span class="ot">&lt;-</span> <span class="fu">sum</span>(are_top)</span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Keep track of the result of each trial.</span></span>
<span id="cb4-20"><a href="#cb4-20" aria-hidden="true" tabindex="-1"></a>    results[i] <span class="ot">&lt;-</span> n_are_top</span>
<span id="cb4-21"><a href="#cb4-21" aria-hidden="true" tabindex="-1"></a>    <span class="co"># End the experiment, go back and repeat.</span></span>
<span id="cb4-22"><a href="#cb4-22" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb4-23"><a href="#cb4-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-24"><a href="#cb4-24" aria-hidden="true" tabindex="-1"></a><span class="co"># Determine how many trials produced 4 or more top ranks by chance.</span></span>
<span id="cb4-25"><a href="#cb4-25" aria-hidden="true" tabindex="-1"></a>k <span class="ot">=</span> <span class="fu">sum</span>(results <span class="sc">&gt;=</span> <span class="dv">4</span>)</span>
<span id="cb4-26"><a href="#cb4-26" aria-hidden="true" tabindex="-1"></a><span class="co">#  Convert to a proportion.</span></span>
<span id="cb4-27"><a href="#cb4-27" aria-hidden="true" tabindex="-1"></a>kk <span class="ot">=</span> k <span class="sc">/</span> n_trials</span>
<span id="cb4-28"><a href="#cb4-28" aria-hidden="true" tabindex="-1"></a><span class="co"># Show the result.</span></span>
<span id="cb4-29"><a href="#cb4-29" aria-hidden="true" tabindex="-1"></a>kk</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.103</code></pre>
</div>
</div>
<p>End of <code>athlete_iq_rank_count</code> notebook</p>
</div>
<!---
End of notebook
-->
<p>So far we have proceeded on the theory that if there is <em>any</em> relationship between athletics and I.Q., then the better athletes have higher rather than lower I.Q. scores. The justification for this assumption is that past research suggests that it is probably true. But if we had <em>not</em> had the benefit of that past research, we would then have had to proceed somewhat differently; we would have had to consider the possibility that the top five athletes could have I.Q. scores either higher <em>or</em> lower than those of the other students. The results of the “two-tail” test would have yielded odds weaker than those we observed.</p>
</section>
<section id="example-athletic-ability-and-i.q.-a-third-way" class="level3" data-number="29.3.2">
<h3 data-number="29.3.2" class="anchored" data-anchor-id="example-athletic-ability-and-i.q.-a-third-way"><span class="header-section-number">29.3.2</span> Example: Athletic ability and I.Q. — a third way</h3>
<p>The example in <a href="#sec-athletic-iq-ranks" class="quarto-xref"><span>Section 29.3.1</span></a> investigated the relationship between I.Q. and athletic score by ranking the two sets of scores. But ranking of scores loses some efficiency because it uses only an “ordinal” (rank-ordered) rather than a “cardinal” (measured) scale; the numerical shadings and relative relationships are lost when we convert to ranks. Therefore let us consider a test of correlation that uses the original cardinal numerical scores.</p>
<p>First a little background: <a href="#fig-hypot-spos" class="quarto-xref">Figure&nbsp;<span>29.2</span></a> and <a href="#fig-hypot-sneg" class="quarto-xref">Figure&nbsp;<span>29.3</span></a> show two hypothetical cases of very high association among the I.Q. and athletic scores used in previous examples. <a href="#fig-hypot-spos" class="quarto-xref">Figure&nbsp;<span>29.2</span></a> indicates that the higher the I.Q. score, the higher the athletic score. With a boy’s athletic score you can thus predict quite well his I.Q. score by means of a hand-drawn line — or vice versa. The same is true of <a href="#fig-hypot-sneg" class="quarto-xref">Figure&nbsp;<span>29.3</span></a>, but in the opposite direction. Notice that even though athletic score is on the x-axis (horizontal) and I.Q. score is on the y-axis (vertical), the athletic score does not <em>cause</em> the I.Q. score. (It is an unfortunate deficiency of such diagrams that <em>some</em> variable must arbitrarily be placed on the x-axis, whether you intend to suggest causation or not.)</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-hypot-spos" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-hypot-spos-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="correlation_causation_files/figure-html/fig-hypot-spos-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:70.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-hypot-spos-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;29.2: Hypothetical Scores for I.Q. and Athletic Ability — 1
</figcaption>
</figure>
</div>
</div>
</div>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-hypot-sneg" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-hypot-sneg-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="correlation_causation_files/figure-html/fig-hypot-sneg-3.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:70.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-hypot-sneg-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;29.3: Hypothetical Scores for I.Q. and Athletic Ability — 2
</figcaption>
</figure>
</div>
</div>
</div>
<p>In <a href="#fig-given_iq_athletic" class="quarto-xref">Figure&nbsp;<span>29.4</span></a>, which plots the scores as given in <a href="#tbl-physical-mental" class="quarto-xref">Table&nbsp;<span>29.1</span></a>, the prediction of athletic score given I.Q. score, or vice versa, is less clear-cut than in <a href="#fig-hypot-spos" class="quarto-xref">Figure&nbsp;<span>29.2</span></a>. On the basis of <a href="#fig-given_iq_athletic" class="quarto-xref">Figure&nbsp;<span>29.4</span></a> alone, one can say only that there <em>might</em> be some association between the two variables.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-given_iq_athletic" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-given_iq_athletic-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="correlation_causation_files/figure-html/fig-given_iq_athletic-5.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:70.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-given_iq_athletic-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;29.4: Given Scores for I.Q. and Athletic Ability
</figcaption>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="sec-sum-products" class="level2" data-number="29.4">
<h2 data-number="29.4" class="anchored" data-anchor-id="sec-sum-products"><span class="header-section-number">29.4</span> Correlation with sum of products</h2>
<p>Now let us take advantage of a handy property of numbers. The more closely two sets of numbers match each other in order, the higher the sums of their products. Consider the following arrays of the numbers 1, 2, and 3:</p>
<p><strong>Columns in matching order</strong></p>
<p><span class="math display">\[
\begin{align*}
1 * 1 = 1 \\
2 * 2 = 4 \\
3 * 3 = 9 \\
\\
\mathrm{SUM} = 14
\end{align*}
\]</span></p>
<p><strong>Columns not in matching order</strong></p>
<p><span class="math display">\[
\begin{align*}
1 * 2 = 2 \\
2 * 3 = 6 \\
3 * 1 = 3 \\
\\
\mathrm{SUM} = 11
\end{align*}
\]</span></p>
<p>I will not attempt a mathematical proof, but the reader is encouraged to try additional combinations to be sure that the highest sum is obtained when the order of the two columns is the same. Likewise, the lowest sum is obtained when the two columns are in perfectly opposite order:</p>
<p><strong>Columns in opposite order</strong></p>
<p><span class="math display">\[
\begin{align*}
1 * 3 = 3 \\
2 * 3 = 4 \\
3 * 1 = 3 \\
\\
\mathrm{SUM} = 10
\end{align*}
\]</span></p>
<p>Consider the cases in <a href="#tbl-pos-neg-mult" class="quarto-xref">Table&nbsp;<span>29.4</span></a> which are chosen to illustrate a perfect (linear) association between <em>x</em> (Column 1) and <em>y1</em> (Column 2), and also between <em>x</em> (Column 1) and <em>y2</em> (Column 4); the numbers shown in Columns 3 and 5 are those that would be consistent with perfect associations. Notice the sum of the multiples of the <em>x</em> and <em>y</em> values in the two cases. It is either higher (<em>x</em> * <em>y1</em>) or lower (<em>x</em> * <em>y2</em>) than for any other possible way of arranging the <em>y</em>’s. Any other arrangement of the <em>y</em>’s (<em>y3</em>, in Column 6, for example, chosen at random), when multiplied by the <em>x</em>’s in Column 1, (<em>x</em> * <em>y3</em>), produces a sum that falls somewhere between the sums of <em>x</em> * <em>y1</em> and <em>x</em> * <em>y2</em>, as is the case with any other set of <em>y3</em>’s which is not perfectly correlated with the <em>x</em>’s.</p>
<div id="tbl-pos-neg-mult" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-pos-neg-mult-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;29.4: Comparison of Sums of Multiplications
</figcaption>
<div aria-describedby="tbl-pos-neg-mult-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table class="caption-top table">
<colgroup>
<col style="width: 8%">
<col style="width: 9%">
<col style="width: 15%">
<col style="width: 12%">
<col style="width: 16%">
<col style="width: 9%">
<col style="width: 15%">
</colgroup>
<thead>
<tr class="header">
<th colspan="3">Strong positive relationship</th>
<th colspan="2">Strong negative relationship</th>
<th colspan="2">Random Pairings</th>
</tr>
<tr class="odd">
<th>X</th>
<th>Y1</th>
<th>X * Y1</th>
<th>Y2</th>
<th>X * Y2</th>
<th>Y3</th>
<th>X * Y3</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>2</td>
<td>2</td>
<td>4</td>
<td>10</td>
<td>20</td>
<td>4</td>
<td>8</td>
</tr>
<tr class="even">
<td>4</td>
<td>4</td>
<td>8</td>
<td>8</td>
<td>32</td>
<td>8</td>
<td>32</td>
</tr>
<tr class="odd">
<td>6</td>
<td>6</td>
<td>36</td>
<td>6</td>
<td>36</td>
<td>6</td>
<td>36</td>
</tr>
<tr class="even">
<td>8</td>
<td>8</td>
<td>64</td>
<td>4</td>
<td>32</td>
<td>2</td>
<td>16</td>
</tr>
<tr class="odd">
<td>10</td>
<td>10</td>
<td>100</td>
<td>2</td>
<td>20</td>
<td>10</td>
<td>100</td>
</tr>
</tbody><tfoot>
<tr class="odd">
<td colspan="2"><strong>Sums</strong></td>
<td>220</td>
<td></td>
<td>140</td>
<td></td>
<td>192</td>
</tr>
</tfoot>

</table>
</div>
</figure>
</div>
<section id="sec-ath-iq-sop" class="level3" data-number="29.4.1">
<h3 data-number="29.4.1" class="anchored" data-anchor-id="sec-ath-iq-sop"><span class="header-section-number">29.4.1</span> Example: sum of products correlation of athletic and IQ scores</h3>
<p><span class="quarto-unresolved-ref">?tbl-ath-iq-products</span> shows that the sum of the products of the <em>observed</em> I.Q. scores multiplied by athletic scores (column 7) is between the sums that would occur if the I.Q. scores were ranked from best to worst (column 3) and worst to best (column 5). The extent of correlation (association) can thus be measured by whether the sum of the multiples of the observed <em>x</em> and <em>y</em> values is relatively much higher or much lower than are sums of randomly-chosen pairs of <em>x</em> and <em>y</em> .</p>
<div class="cell" data-layout-align="center">
<p><string>:1: FutureWarning: Setting an item of incompatible dtype is deprecated and will raise an error in a future version of pandas. Value ’’ has dtype incompatible with int64, please explicitly cast to a compatible dtype first. +——————+—————-+—————–+—————-+—————–+————-+—————–+ | 1 | 2 | 3 | 4 | 5 | 6 | 7 | +——————+—————-+—————–+—————-+—————–+————-+—————–+ | Athletic score | Hypothetical | Col 1 x Col 2 | Hypothetical | Col 1 x Col 4 | Actual IQ | Col 1 x Col 6 | | | IQ pos | | IQ neg | | | | +==================+================+=================+================+=================+=============+=================+ | 97 | 120 | 11640 | 99 | 9603 | 114 | 11058 | +——————+—————-+—————–+—————-+—————–+————-+—————–+ | 94 | 118 | 11092 | 100 | 9400 | 120 | 11280 | +——————+—————-+—————–+—————-+—————–+————-+—————–+ | 93 | 114 | 10602 | 101 | 9393 | 107 | 9951 | +——————+—————-+—————–+—————-+—————–+————-+—————–+ | 90 | 110 | 9900 | 107 | 9630 | 113 | 10170 | +——————+—————-+—————–+—————-+—————–+————-+—————–+ | 87 | 113 | 9831 | 109 | 9483 | 118 | 10266 | +——————+—————-+—————–+—————-+—————–+————-+—————–+ | 86 | 109 | 9374 | 113 | 9718 | 101 | 8686 | +——————+—————-+—————–+—————-+—————–+————-+—————–+ | 86 | 107 | 9202 | 110 | 9460 | 109 | 9374 | +——————+—————-+—————–+—————-+—————–+————-+—————–+ | 85 | 101 | 8585 | 114 | 9690 | 110 | 9350 | +——————+—————-+—————–+—————-+—————–+————-+—————–+ | 81 | 100 | 8100 | 118 | 9558 | 100 | 8100 | +——————+—————-+—————–+—————-+—————–+————-+—————–+ | 76 | 99 | 7524 | 120 | 9120 | 99 | 7524 | +——————+—————-+—————–+—————-+—————–+————-+—————–+ | <strong>SUMS</strong> | | 95850 | | 95055 | | 95759 | +——————+—————-+—————–+—————-+—————–+————-+—————–+</string></p>
<p>: Sums of Products: IQ and Athletic Scores {#tbl-ath-iq-products}}</p>
</div>
<p><span class="quarto-unresolved-ref">?tbl-ath-iq-products</span> show three cases of products:</p>
<ol type="1">
<li>Perfect positive correlation (hypothetical); column 3</li>
<li>Perfect negative correlation (hypothetical); column 5</li>
<li>Observed; column 7</li>
</ol>
<p>Now we attack the I.Q. and athletic-score problem using the property of numbers just discussed. First multiply the <span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span> values of the actual observations, and sum them; we find a total of 95,759 (<span class="quarto-unresolved-ref">?tbl-ath-iq-products</span>). Then write the ten observed I.Q. scores on cards, and assign the cards in random order to the ten athletes, as shown in the column for trial 1 in <span class="quarto-unresolved-ref">?tbl-random-ath-iq</span>.</p>
<p>Multiply the random IQ scores by their paired <span class="math inline">\(x\)</span>’s (Athletic scores), and sum to give the values at the bottom of <span class="quarto-unresolved-ref">?tbl-random-ath-iq</span>. If the I.Q. scores and athletic scores are <em>positively associated</em>, that is, if high I.Q.s and high athletic scores go together, then the sum of the multiplications for the observed sample will be higher than for most of the random trials. (If high I.Q.s go with low athletic scores, the sum of the multiplications for the observed sample will be <em>lower</em> than most of the random trials.)</p>
<div class="cell" data-layout-align="center">
<p><string>:1: FutureWarning: Setting an item of incompatible dtype is deprecated and will raise an error in a future version of pandas. Value ‘<strong>Product sums</strong>’ has dtype incompatible with int64, please explicitly cast to a compatible dtype first. +——————+——-+——-+——-+——-+——-+——-+——-+——-+——-+——-+ | Athletic | 1 | 2 | 3 | 4 | 5 | 6 | 7 | 8 | 9 | 10 | | score | | | | | | | | | | | +==================+=======+=======+=======+=======+=======+=======+=======+=======+=======+=======+ | 97 | 100 | 110 | 101 | 113 | 107 | 109 | 109 | 114 | 100 | 118 | +——————+——-+——-+——-+——-+——-+——-+——-+——-+——-+——-+ | 94 | 120 | 109 | 99 | 101 | 100 | 113 | 107 | 110 | 118 | 107 | +——————+——-+——-+——-+——-+——-+——-+——-+——-+——-+——-+ | 93 | 114 | 113 | 113 | 120 | 99 | 120 | 100 | 113 | 99 | 100 | +——————+——-+——-+——-+——-+——-+——-+——-+——-+——-+——-+ | 90 | 101 | 120 | 114 | 99 | 110 | 107 | 101 | 107 | 107 | 120 | +——————+——-+——-+——-+——-+——-+——-+——-+——-+——-+——-+ | 87 | 118 | 101 | 110 | 107 | 118 | 100 | 120 | 99 | 114 | 114 | +——————+——-+——-+——-+——-+——-+——-+——-+——-+——-+——-+ | 86 | 110 | 114 | 118 | 114 | 101 | 101 | 110 | 109 | 101 | 110 | +——————+——-+——-+——-+——-+——-+——-+——-+——-+——-+——-+ | 86 | 107 | 100 | 120 | 109 | 114 | 114 | 113 | 120 | 120 | 101 | +——————+——-+——-+——-+——-+——-+——-+——-+——-+——-+——-+ | 85 | 99 | 99 | 107 | 110 | 120 | 110 | 118 | 100 | 109 | 113 | +——————+——-+——-+——-+——-+——-+——-+——-+——-+——-+——-+ | 81 | 113 | 118 | 100 | 118 | 109 | 99 | 99 | 118 | 113 | 109 | +——————+——-+——-+——-+——-+——-+——-+——-+——-+——-+——-+ | 76 | 109 | 107 | 109 | 100 | 113 | 118 | 114 | 101 | 110 | 99 | +——————+——-+——-+——-+——-+——-+——-+——-+——-+——-+——-+ | <strong>Product sums</strong> | 95452 | 95521 | 95389 | 95520 | 95259 | 95512 | 95352 | 95578 | 95331 | 95626 | +——————+——-+——-+——-+——-+——-+——-+——-+——-+——-+——-+</string></p>
<p>: Random Draws of IQ scores paired against athletic scores {#tbl-random-ath-iq}</p>
</div>
<p>More specifically, by the steps:</p>
<ul>
<li><strong>Step 1.</strong> Write the ten I.Q. scores on one set of cards, and the ten athletic scores on another set of cards.</li>
<li><strong>Step 2.</strong> Pair the I.Q. and athletic-score cards at random. Multiply the scores in each pair, and add the results of the ten multiplications.</li>
<li><strong>Step 3.</strong> Subtract the experimental sum in step 2 from the observed sum, 95,759.</li>
<li><strong>Step 4.</strong> Repeat steps 2 and 3 ten times.</li>
<li><strong>Step 5.</strong> Compute the proportion of trials where the difference is negative, which estimates the probability that an association as strong as the observed would occur by chance.</li>
</ul>
<p>The sums of the multiplications for 10 trials are shown in <span class="quarto-unresolved-ref">?tbl-random-ath-iq</span>. No random-trial sum was as high as the observed sum, which suggests that the probability of an association this strong happening by chance is so low as to approach zero. (An empirically-observed probability is never actually zero.)</p>
<p>This algorithm can be solved particularly easily with R. The vectors <code>ath</code> and <code>iq</code> in the notebook below list the athletic scores and the I.Q. scores respectively of the 10 “actual” students. We multiply the corresponding elements of these vectors and proceed to compare the sum of these multiplications to the sums of experimental multiplications in which the elements of <code>iq</code> have been randomly permuted, to form random pairings.</p>
<p>Finally, we count (<code>sum</code>) the trials in which the sum of the products of the randomly-paired athletic and I.Q. scores equals or exceeds the sum of the products in the observed data.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Notebook with data file
</div>
</div>
<div class="callout-body-container callout-body">
<p>As have seen already (see <span class="quarto-unresolved-ref">?sec-download-links</span>),the download link points to a <code>.zip</code> file containing the notebook and the data file the notebook will read.</p>
</div>
</div>
<div class="notebook" name="athlete_iq" title="Association of athletic and IQ scores">
<p>Start of <code>athlete_iq</code> notebook</p>
<div class="nb-links">
<a class="notebook-link" href="notebooks/athlete_iq.zip">Download zip with notebook + data file</a>
<a class="interact-button" href="./interact/lab/index.html?path=athlete_iq.ipynb">Interact</a>
</div>

<p>We load the file containing the data:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Read the data file containing athletic and IQ scores.</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>ath_iq_df <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">'data/athletic_iq.csv'</span>)</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Show the data frame.</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>ath_iq_df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   athletic_score iq_score athletic_rank iq_rank
1              97      114             1       3
2              94      120             2       1
3              93      107             3       7
4              90      113             4       4
5              87      118             5       2
6              86      101             6       8
7              86      109             7       6
8              85      110             8       5
9              81      100             9       9
10             76       99            10      10</code></pre>
</div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Turn athletic and IQ scores into vectors.</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>ath <span class="ot">=</span> ath_iq_df<span class="sc">$</span>athletic_score</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>iq <span class="ot">=</span> ath_iq_df<span class="sc">$</span>iq_score</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Multiply the two sets of scores together.</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>actual_prod <span class="ot">&lt;-</span> ath <span class="sc">*</span> iq</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Sum the results — the "observed value."</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>actual_sum <span class="ot">&lt;-</span> <span class="fu">sum</span>(actual_prod)</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>actual_sum</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 95759</code></pre>
</div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Set the number of trials</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>n_trials <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a><span class="co"># An empty array to store the trial results.</span></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>results <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n_trials)</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Do 10,000 experiments.</span></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n_trials) {</span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Shuffle the IQ scores so we can pair them against athletic scores.</span></span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>    shuffled <span class="ot">&lt;-</span> <span class="fu">sample</span>(iq)</span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Multiply the shuffled IQ scores by the athletic scores. (Note that we</span></span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a>    <span class="co"># could shuffle the athletic scores too but it would not achieve any</span></span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a>    <span class="co"># greater randomization, because shuffling one of the set of scores</span></span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a>    <span class="co"># already gives a random pairing between the sets of scores.</span></span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a>    fake_prod <span class="ot">&lt;-</span> ath <span class="sc">*</span> shuffled</span>
<span id="cb11-16"><a href="#cb11-16" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Sum the randomized multiplications.</span></span>
<span id="cb11-17"><a href="#cb11-17" aria-hidden="true" tabindex="-1"></a>    fake_sum <span class="ot">&lt;-</span> <span class="fu">sum</span>(fake_prod)</span>
<span id="cb11-18"><a href="#cb11-18" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Subtract the sum from the sum of the "observed" multiplication.</span></span>
<span id="cb11-19"><a href="#cb11-19" aria-hidden="true" tabindex="-1"></a>    diff <span class="ot">&lt;-</span> actual_sum <span class="sc">-</span> fake_sum</span>
<span id="cb11-20"><a href="#cb11-20" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Keep track of the result in results array.</span></span>
<span id="cb11-21"><a href="#cb11-21" aria-hidden="true" tabindex="-1"></a>    results[i] <span class="ot">&lt;-</span> diff</span>
<span id="cb11-22"><a href="#cb11-22" aria-hidden="true" tabindex="-1"></a>    <span class="co"># End one trial, go back and repeat until 10000 trials are complete.</span></span>
<span id="cb11-23"><a href="#cb11-23" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb11-24"><a href="#cb11-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-25"><a href="#cb11-25" aria-hidden="true" tabindex="-1"></a><span class="co"># Obtain a histogram of the trial results.</span></span>
<span id="cb11-26"><a href="#cb11-26" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(results, <span class="at">breaks=</span><span class="dv">25</span>,</span>
<span id="cb11-27"><a href="#cb11-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">main=</span><span class="st">'Random sums of products'</span>,</span>
<span id="cb11-28"><a href="#cb11-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">xlab=</span><span class="st">'Observed sum minus sum of random pairing'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="correlation_causation_files/figure-html/unnamed-chunk-20-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:70.0%"></p>
</figure>
</div>
</div>
</div>
<p>We see that obtaining a chance trial result as great as that observed was rare. R will calculate this proportion for us:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Determine in how many trials the random sum of products was less than</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="co"># the observed sum of products.</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="fu">sum</span>(results <span class="sc">&lt;=</span> <span class="dv">0</span>)</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert to a proportion.</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>kk <span class="ot">&lt;-</span> k <span class="sc">/</span> n_trials</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the result.</span></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a><span class="fu">message</span>(<span class="st">'Proportion of random pairings giving sum &lt;= observed: '</span>, kk)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Proportion of random pairings giving sum &lt;= observed: 0.0117</code></pre>
</div>
</div>
<p>End of <code>athlete_iq</code> notebook</p>
</div>
<!---
End of notebook
-->
</section>
<section id="example-correlation-between-adherence-to-medication-regime-and-change-in-cholesterol" class="level3" data-number="29.4.2">
<h3 data-number="29.4.2" class="anchored" data-anchor-id="example-correlation-between-adherence-to-medication-regime-and-change-in-cholesterol"><span class="header-section-number">29.4.2</span> Example: Correlation Between Adherence to Medication Regime and Change in Cholesterol</h3>
<p>Efron and Tibshirani <span class="citation" data-cites="efron1993bootstrap">(<a href="references.html#ref-efron1993bootstrap" role="doc-biblioref">1993, 72</a>)</span> show data on the extents to which 164 men a) took the drug prescribed to them (cholestyramine), and b) showed a decrease in total plasma cholesterol. <a href="#tbl-cholestyramine" class="quarto-xref">Table&nbsp;<span>29.5</span></a> shows the first 15 of the values (note that a positive value in the “Decrease in cholesterol” column denotes a decrease in cholesterol, while a negative value denotes an increase.)</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="tbl-cholestyramine" class="lightable-paper lightable-striped lightable-hover quarto-float quarto-figure quarto-figure-center anchored" style="font-family: &quot;Arial Narrow&quot;, arial, helvetica, sans-serif; width: auto !important; margin-left: auto; margin-right: auto;" data-quarto-postprocess="true">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-cholestyramine-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;29.5: First 15 rows of compliance / blood cholesterol
</figcaption>
<div aria-describedby="tbl-cholestyramine-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table class="lightable-paper lightable-striped lightable-hover caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: right;" data-quarto-table-cell-role="th">% compliance</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Decrease in cholesterol</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">0</td>
<td style="text-align: right;">-5.25</td>
</tr>
<tr class="even">
<td style="text-align: right;">27</td>
<td style="text-align: right;">-1.50</td>
</tr>
<tr class="odd">
<td style="text-align: right;">71</td>
<td style="text-align: right;">59.50</td>
</tr>
<tr class="even">
<td style="text-align: right;">95</td>
<td style="text-align: right;">32.50</td>
</tr>
<tr class="odd">
<td style="text-align: right;">0</td>
<td style="text-align: right;">-7.25</td>
</tr>
<tr class="even">
<td style="text-align: right;">28</td>
<td style="text-align: right;">23.50</td>
</tr>
<tr class="odd">
<td style="text-align: right;">71</td>
<td style="text-align: right;">14.75</td>
</tr>
<tr class="even">
<td style="text-align: right;">95</td>
<td style="text-align: right;">70.75</td>
</tr>
<tr class="odd">
<td style="text-align: right;">0</td>
<td style="text-align: right;">-6.25</td>
</tr>
<tr class="even">
<td style="text-align: right;">29</td>
<td style="text-align: right;">33.00</td>
</tr>
<tr class="odd">
<td style="text-align: right;">72</td>
<td style="text-align: right;">63.00</td>
</tr>
<tr class="even">
<td style="text-align: right;">95</td>
<td style="text-align: right;">18.25</td>
</tr>
<tr class="odd">
<td style="text-align: right;">0</td>
<td style="text-align: right;">11.50</td>
</tr>
<tr class="even">
<td style="text-align: right;">31</td>
<td style="text-align: right;">4.25</td>
</tr>
<tr class="odd">
<td style="text-align: right;">72</td>
<td style="text-align: right;">0.00</td>
</tr>
</tbody>
</table>
</div>
</figure>
</div>


</div>
</div>
<p>The aim is to assess the effect of the compliance on the improvement. There are two related issues:</p>
<ol type="1">
<li>What form of regression should be fitted to these data, which we address later, and</li>
<li>Is there reason to believe that the relationship is meaningful? That is, we wish to ascertain if there is any meaningful correlation between the variables — because if there is no relationship between the variables, there is no basis for regressing one on the other. Sometimes people jump ahead in the latter question to first run the regression and then ask whether the regression slope coefficient(s) is (are) different than zero, but this usually is not sound practice. The sensible way to proceed is first to graph the data to see whether there is visible indication of a relationship.</li>
</ol>
<p>Efron and Tibshirani do this, and they find sufficient intuitive basis in the graph to continue the analysis (see <a href="#fig-chole-scatter" class="quarto-xref">Figure&nbsp;<span>29.5</span></a>).</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-chole-scatter" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-chole-scatter-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="correlation_causation_files/figure-html/fig-chole-scatter-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:70.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-chole-scatter-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;29.5: Cholesterol decrease as function of compliance
</figcaption>
</figure>
</div>
</div>
</div>
<p>The next step is to investigate whether a measure of relationship is statistically convincing; this we do as follows:</p>
<ol type="1">
<li>Multiply the observed values for each of the 164 participants on the independent <span class="math inline">\(x\)</span> variable (cholestyramine — percent of prescribed dosage actually taken) and the dependent <span class="math inline">\(y\)</span> variable (cholesterol), and sum the results — it’s 439,141.</li>
<li>Randomly shuffle the dependent variable <span class="math inline">\(y\)</span> values among the participants. The sampling is being done without replacement, though an equally good argument could be made for sampling with replacement; the results do not differ meaningfully, however, because the sample size is so large.</li>
<li>Then multiply these <span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span> hypothetical values for each of the 164 participants, sum the results and record.</li>
<li>Repeat steps 2 and 3 perhaps 10,000 times.</li>
<li>Determine how often the shuffled sum-of-products exceeds the observed value (439,141).</li>
</ol>
<p>The following notebook in R provides the solution:</p>
<div class="notebook" name="compliance_cholesterol" title="Testing association of compliance and cholesterol values">
<p>Start of <code>compliance_cholesterol</code> notebook</p>
<div class="nb-links">
<a class="notebook-link" href="notebooks/compliance_cholesterol.zip">Download zip with notebook + data file</a>
<a class="interact-button" href="./interact/lab/index.html?path=compliance_cholesterol.ipynb">Interact</a>
</div>

<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Data as vectors.</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">'data/cholost.csv'</span>)</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>compliance <span class="ot">&lt;-</span> df<span class="sc">$</span>percent_compliance</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>cholesterol <span class="ot">&lt;-</span> df<span class="sc">$</span>cholesterol_decrease</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Rename the two sequences to match the description in the text.</span></span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> compliance</span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> cholesterol</span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 1 above</span></span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a>actual_prod <span class="ot">&lt;-</span> x <span class="sc">*</span> y</span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Note: actual_sum &lt;- 439,141</span></span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a>actual_sum <span class="ot">&lt;-</span> <span class="fu">sum</span>(actual_prod)</span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Show the result.</span></span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true" tabindex="-1"></a>actual_sum</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 439141</code></pre>
</div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Set the number of trials</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>n_trials <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a><span class="co"># An empty array to store the trial results.</span></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>results <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n_trials)</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Do 10,000 experiments (step 4)</span></span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n_trials) {</span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Step 2 above.</span></span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a>    y_random <span class="ot">&lt;-</span> <span class="fu">sample</span>(y)</span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Step 3 above.</span></span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a>    fake_prod <span class="ot">&lt;-</span> x <span class="sc">*</span> y_random</span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a>    fake_sum <span class="ot">&lt;-</span> <span class="fu">sum</span>(fake_prod)</span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Step 3 above</span></span>
<span id="cb16-15"><a href="#cb16-15" aria-hidden="true" tabindex="-1"></a>    results[i] <span class="ot">&lt;-</span> fake_sum</span>
<span id="cb16-16"><a href="#cb16-16" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Step 4 above</span></span>
<span id="cb16-17"><a href="#cb16-17" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb16-18"><a href="#cb16-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-19"><a href="#cb16-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 5 above</span></span>
<span id="cb16-20"><a href="#cb16-20" aria-hidden="true" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="fu">sum</span>(results <span class="sc">&gt;=</span> actual_sum)</span>
<span id="cb16-21"><a href="#cb16-21" aria-hidden="true" tabindex="-1"></a>kk <span class="ot">&lt;-</span> k <span class="sc">/</span> n_trials</span>
<span id="cb16-22"><a href="#cb16-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-23"><a href="#cb16-23" aria-hidden="true" tabindex="-1"></a><span class="fu">message</span>(<span class="st">'Proportion product sums &gt;= observed: '</span>, kk)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Proportion product sums &gt;= observed: 0</code></pre>
</div>
</div>
<p>End of <code>compliance_cholesterol</code> notebook</p>
</div>
<!---
End of notebook
-->
<p>Interpretation: 10,000 simulated random shufflings never produced a sum-of-products as high as the observed value. Hence we conclude that random chance is a very unlikely explanation for the observed correlation.</p>
</section>
</section>
<section id="sec-correlation-coefficient" class="level2" data-number="29.5">
<h2 data-number="29.5" class="anchored" data-anchor-id="sec-correlation-coefficient"><span class="header-section-number">29.5</span> The correlation coefficient</h2>
<p>We have been using the <em>sum of products</em> as a measure of straight-line (linear) association between two variables. We found that the sum of products for the athletic and IQ variables (<code>ath</code> and <code>iq</code>) was 95759, and we showed that the sum of products is higher for pairings of <code>ath</code> and <code>iq</code> with a higher degree of linear association. Now let us consider compliance and cholesterol above; the sum of products for <code>compliance</code> and <code>cholesterol</code> was 439141. Notice the <code>compliance</code> and <code>cholesterol</code> sum of products is much higher than for <code>ath</code> and <code>iq</code> — but, for various reasons that we explain below, that does not tell us whether the <em>association of the scores</em> is higher for the compliance / cholesterol values than the athletic / IQ scores. We would like a version of the sum of products procedure that could give us a measure of linear association that we could compare between different pairs of sequences. This is the purpose of the <em>correlation coefficient</em>.</p>
<p>The first problem that makes it hard to compare the sum of product scores is that the sum of products depends on the number of elements in the sequence. <code>ath</code> (and <code>iq</code>) have 10 elements, whereas <code>compliance</code> (and <code>cholesterol</code>) have 164 elements. The sum of products is a sum; all other things being equal, the more values you sum, the higher the sum; all other things being equal, the sum of 164 elements will be greater than the sum of 10 elements. We can solve this problem by dividing the sum of products by the number of elements in that sum, to get the <em>mean</em> of the products. The mean of product values for the athletic / IQ scores is 95759 / 10 = 9575.9. The mean of products for compliance / cholesterol is 439141 / 164 = 2677.69.</p>
<p>We have solved one problem in comparing the measure by taking the mean of products — the value no longer depends on the number of elements. We have other problems. For example, consider the IQ scores. We have used the raw IQ scores, on their usual scale, where 100 is the average IQ for the general population. Our raw IQ scores have a mean of 109.1. But we could also have scored IQ in another way. For example, we could have recorded the <em>difference</em> from 100 instead of the raw value, to get the values in column 2 of <a href="#tbl-iq-minus-hundred" class="quarto-xref">Table&nbsp;<span>29.6</span></a>. Call these the “IQ-100” scores. IQ-100 scores have a mean of 9.1.</p>
<div class="cell" data-layout-align="center">
<div id="tbl-iq-minus-hundred" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-iq-minus-hundred-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;29.6: Means of Products: IQ, IQ-100 and Athletic Scores
</figcaption>
<div aria-describedby="tbl-iq-minus-hundred-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table class="caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 22%">
<col style="width: 18%">
<col style="width: 21%">
<col style="width: 12%">
<col style="width: 21%">
</colgroup>
<thead>
<tr class="header">
<th>1</th>
<th>2</th>
<th>3</th>
<th>4</th>
<th>5</th>
</tr>
<tr class="odd">
<th>Athletic score</th>
<th>Original IQ</th>
<th>Col 1 x Col 2</th>
<th>IQ-100</th>
<th>Col 2 x Col 4</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>97</td>
<td>114</td>
<td>11058</td>
<td>14</td>
<td>1358</td>
</tr>
<tr class="even">
<td>94</td>
<td>120</td>
<td>11280</td>
<td>20</td>
<td>1880</td>
</tr>
<tr class="odd">
<td>93</td>
<td>107</td>
<td>9951</td>
<td>7</td>
<td>651</td>
</tr>
<tr class="even">
<td>90</td>
<td>113</td>
<td>10170</td>
<td>13</td>
<td>1170</td>
</tr>
<tr class="odd">
<td>87</td>
<td>118</td>
<td>10266</td>
<td>18</td>
<td>1566</td>
</tr>
<tr class="even">
<td>86</td>
<td>101</td>
<td>8686</td>
<td>1</td>
<td>86</td>
</tr>
<tr class="odd">
<td>86</td>
<td>109</td>
<td>9374</td>
<td>9</td>
<td>774</td>
</tr>
<tr class="even">
<td>85</td>
<td>110</td>
<td>9350</td>
<td>10</td>
<td>850</td>
</tr>
<tr class="odd">
<td>81</td>
<td>100</td>
<td>8100</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="even">
<td>76</td>
<td>99</td>
<td>7524</td>
<td>-1</td>
<td>-76</td>
</tr>
</tbody><tfoot>
<tr class="even">
<td><strong>SUMS</strong></td>
<td></td>
<td>95759</td>
<td></td>
<td>8259</td>
</tr>
<tr class="odd">
<td><strong>MEANS</strong></td>
<td></td>
<td>9575.9</td>
<td></td>
<td>825.9</td>
</tr>
</tfoot>

</table>
</div>
</figure>
</div>
</div>
<p>Notice that the mean product for the IQ-100 scores is much smaller than the mean for the product with the original IQ values, because the IQ element in the product is smaller, so the products will be smaller, and the mean product will be smaller. However, it might be obvious that the <em>association</em> of the IQ and athletic scores remains the same after we have subtracted 100 from the IQ; higher IQ values on either scale are still associated with higher athletic scores. Think of the association as a straight-line relationship in a scatter plot, with the athletic scores on the x-axis, and the IQ scores on the y-axis. <a href="#fig-ath-iq-scatter" class="quarto-xref">Figure&nbsp;<span>29.1</span></a> has the original scatter plot with the athletic scores on the x-axis and the original IQ scores on the y-axis. The points appear to scatter around some straight line we could draw. <a href="#fig-ath-iq-hundred" class="quarto-xref">Figure&nbsp;<span>29.6</span></a> shows the scatterplot of the original IQ score against the athletic scores on the left plot (as for <a href="#fig-ath-iq-scatter" class="quarto-xref">Figure&nbsp;<span>29.1</span></a>) and the IQ-100 scores against the athletic scores in the right plot. As you can see, subtracting 100 from the IQ values just moved the points on the graph down by 100 on the y-axis — but the slope of the line relating the two must be the same. The slope is a measure of how much the IQ score increases as the athletic score increases — it is therefore a good measure of the <em>linear association</em> between athletic score and IQ score. Because the slope of our potential line should not change between the original IQ score and the IQ-100 score, the association has not changed, even though the mean product is much smaller.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-ath-iq-hundred" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ath-iq-hundred-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="correlation_causation_files/figure-html/fig-ath-iq-hundred-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:70.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ath-iq-hundred-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;29.6: Scatter plot of IQ Score, IQ-100 as function of Athletic Score
</figcaption>
</figure>
</div>
</div>
</div>
<p>We have discovered that the mean product will change as we add or subtract values to one or both of the sequences. You might also be able to see that the mean product will change if we multiply or divide the values in the sequence by some number. In summary, the mean product depends on the <em>scale</em> or <em>units</em> of the values in the sequence.</p>
<p>We would like some measure of association that does not depend on the scale of the sequences. A simple approach is to put each sequence on a <em>standard</em> scale, by converting the original sequence values to <em>standard scores</em> (see <a href="standard_scores.html#sec-standard-scores" class="quarto-xref"><span>Section 16.9</span></a>).</p>
<p>We do this by:</p>
<ol type="1">
<li>Subtracting the mean value from each element in the sequence to give the <em>deviations</em>.</li>
<li>Dividing the deviations by a measure of spread — the <em>standard deviation</em> (see <a href="standard_scores.html#sec-standard-deviation" class="quarto-xref"><span>Section 16.7</span></a>).</li>
</ol>
<p>See <a href="#tbl-standard-iq" class="quarto-xref">Table&nbsp;<span>29.7</span></a> for an example of applying this algorithm to the IQ scores. We get the deviations by subtracting the mean IQ (109.1), and the standard scores by dividing the deviations by the IQ standard deviation (7.02).</p>
<div class="cell" data-layout-align="center">
<div id="tbl-standard-iq" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-standard-iq-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;29.7: IQ, deviations and standard scores
</figcaption>
<div aria-describedby="tbl-standard-iq-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table class="caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 22%">
<col style="width: 25%">
<col style="width: 27%">
</colgroup>
<thead>
<tr class="header">
<th>Original IQ</th>
<th>IQ deviations</th>
<th>Standard scores</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>114</td>
<td>4.9</td>
<td>0.7</td>
</tr>
<tr class="even">
<td>120</td>
<td>10.9</td>
<td>1.55</td>
</tr>
<tr class="odd">
<td>107</td>
<td>-2.1</td>
<td>-0.3</td>
</tr>
<tr class="even">
<td>113</td>
<td>3.9</td>
<td>0.56</td>
</tr>
<tr class="odd">
<td>118</td>
<td>8.9</td>
<td>1.27</td>
</tr>
<tr class="even">
<td>101</td>
<td>-8.1</td>
<td>-1.15</td>
</tr>
<tr class="odd">
<td>109</td>
<td>-0.1</td>
<td>-0.01</td>
</tr>
<tr class="even">
<td>110</td>
<td>0.9</td>
<td>0.13</td>
</tr>
<tr class="odd">
<td>100</td>
<td>-9.1</td>
<td>-1.3</td>
</tr>
<tr class="even">
<td>99</td>
<td>-10.1</td>
<td>-1.44</td>
</tr>
</tbody>
</table>
</div>
</figure>
</div>
</div>
<p>After we apply this procedure to both sequences, they are both in the same <em>standard</em> units. The mean product of these standard units is therefore a <em>standard</em> measure of association, called the <em>Pearson product-moment correlation coefficient</em>, or just the <em>correlation coefficient</em>. We use the letter <span class="math inline">\(r\)</span> for the value of the correlation coefficient. <span class="quarto-unresolved-ref">?tbl-r-iq</span> shows the mean of products calculation on standard scores athletic ability and IQ, to get the <span class="math inline">\(r\)</span> value.</p>
<div class="cell" data-layout-align="center">
<p><string>:1: FutureWarning: Setting an item of incompatible dtype is deprecated and will raise an error in a future version of pandas. Value ’’ has dtype incompatible with float64, please explicitly cast to a compatible dtype first. +——————–+—————+——————+—————-+—————–+ | 1 | 2 | 3 | 4 | 5 | +——————–+—————+——————+—————-+—————–+ | Athletic score | Original IQ | Standardized | Standardized | Col 3 x Col 4 | | | | athletic score | IQ | | +====================+===============+==================+================+=================+ | 97 | 114 | 1.6 | 0.7 | 1.11 | +——————–+—————+——————+—————-+—————–+ | 94 | 120 | 1.09 | 1.55 | 1.69 | +——————–+—————+——————+—————-+—————–+ | 93 | 107 | 0.92 | -0.3 | -0.28 | +——————–+—————+——————+—————-+—————–+ | 90 | 113 | 0.42 | 0.56 | 0.23 | +——————–+—————+——————+—————-+—————–+ | 87 | 118 | -0.08 | 1.27 | -0.11 | +——————–+—————+——————+—————-+—————–+ | 86 | 101 | -0.25 | -1.15 | 0.29 | +——————–+—————+——————+—————-+—————–+ | 86 | 109 | -0.25 | -0.01 | 0 | +——————–+—————+——————+—————-+—————–+ | 85 | 110 | -0.42 | 0.13 | -0.05 | +——————–+—————+——————+—————-+—————–+ | 81 | 100 | -1.09 | -1.3 | 1.42 | +——————–+—————+——————+—————-+—————–+ | 76 | 99 | -1.93 | -1.44 | 2.78 | +====================+===============+==================+================+=================+ | <strong>Mean product</strong> | | | | 0.71 | | <strong>(r value)</strong> | | | | | +====================+===============+==================+================+=================+</string></p>
<p>: <span class="math inline">\(r\)</span> for Athletic and IQ scores {#tbl-r-iq}}</p>
</div>
<p>Because the sequences for the correlation coefficient <span class="math inline">\(r\)</span> are in the same units, we can compare correlation coefficients between different sequences, to give a standard measure of association. For example, we can run the same calculation on the compliance and cholesterol values, to get the <span class="math inline">\(r\)</span> value (correlation coefficient) for these sequences. Let’s do that in R:</p>
<div class="notebook" name="r_for_cholesterol" title="Correlation coefficient for compliance and cholesterol">
<p>Start of <code>r_for_cholesterol</code> notebook</p>
<div class="nb-links">
<a class="notebook-link" href="notebooks/r_for_cholesterol.zip">Download zip with notebook + data file</a>
<a class="interact-button" href="./interact/lab/index.html?path=r_for_cholesterol.ipynb">Interact</a>
</div>

<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">'data/cholost.csv'</span>)</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>compliance <span class="ot">&lt;-</span> df<span class="sc">$</span>percent_compliance</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>cholesterol <span class="ot">&lt;-</span> df<span class="sc">$</span>cholesterol_decrease</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Compliance as standard scores.</span></span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>dev_compliance <span class="ot">&lt;-</span> compliance <span class="sc">-</span> <span class="fu">mean</span>(compliance)  <span class="co"># Deviations.</span></span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>stdev_compliance <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">mean</span>(dev_compliance <span class="sc">**</span> <span class="dv">2</span>))  <span class="co"># Standard deviation.</span></span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>std_compliance <span class="ot">&lt;-</span> dev_compliance <span class="sc">/</span> stdev_compliance  <span class="co"># Standard scores.</span></span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Cholesterol as standard scores.</span></span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a>dev_cholesterol <span class="ot">&lt;-</span> cholesterol <span class="sc">-</span> <span class="fu">mean</span>(cholesterol)  <span class="co"># Deviations.</span></span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a>stdev_cholesterol <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">mean</span>(dev_cholesterol <span class="sc">**</span> <span class="dv">2</span>))  <span class="co"># Standard deviation.</span></span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a>std_cholesterol <span class="ot">&lt;-</span> dev_cholesterol <span class="sc">/</span> stdev_cholesterol  <span class="co"># Standard scores.</span></span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-15"><a href="#cb18-15" aria-hidden="true" tabindex="-1"></a><span class="co"># r value is mean of product for standardized scores.</span></span>
<span id="cb18-16"><a href="#cb18-16" aria-hidden="true" tabindex="-1"></a>r <span class="ot">&lt;-</span> <span class="fu">mean</span>(std_compliance <span class="sc">*</span> std_cholesterol)</span>
<span id="cb18-17"><a href="#cb18-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-18"><a href="#cb18-18" aria-hidden="true" tabindex="-1"></a><span class="fu">message</span>(<span class="st">'r for compliance / cholesterol is: '</span>, <span class="fu">round</span>(r, <span class="dv">2</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>r for compliance / cholesterol is: 0.68</code></pre>
</div>
</div>
<p>End of <code>r_for_cholesterol</code> notebook</p>
</div>
<!---
End of notebook.
-->
<p>Notice that the <span class="math inline">\(r\)</span> value is higher for the athletic and IQ scores (0.71) than it is for compliance and cholesterol (0.68). Because we have measured the association in standard units, we can compare these values, and say there is a slightly stronger linear association for our athletic and IQ scores, than there is for our compliance and cholesterol scores.</p>
<section id="correlations-are-symmetrical" class="level3" data-number="29.5.1">
<h3 data-number="29.5.1" class="anchored" data-anchor-id="correlations-are-symmetrical"><span class="header-section-number">29.5.1</span> Correlations are symmetrical</h3>
<p>You might be able to see from the definition of the calculation above, that the correlation coefficient <span class="math inline">\(r\)</span> between <code>ath</code> and <code>iq</code> must be the same as the correlation coefficient (<span class="math inline">\(r\)</span>) between <code>iq</code> and <code>ath</code> — and in general the correlation coefficient between some sequence <span class="math inline">\(x\)</span> and another <span class="math inline">\(y\)</span> is equal to the correlation coefficient between <span class="math inline">\(y\)</span> and <span class="math inline">\(x\)</span>.</p>
<p>Why? Remember that the correlation coefficient is the mean of the product of the standard scores.</p>
<p>Let us first calculate the standard scores for <code>ath</code> and <code>iq</code>:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Athletic scores.</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>dev_ath <span class="ot">&lt;-</span> ath <span class="sc">-</span> <span class="fu">mean</span>(ath)   <span class="co"># Deviations.</span></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>stdev_ath <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">mean</span>(dev_ath <span class="sc">**</span> <span class="dv">2</span>))  <span class="co"># Standard deviation.</span></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>std_ath <span class="ot">=</span> dev_ath <span class="sc">/</span> stdev_ath  <span class="co"># Standard scores.</span></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a><span class="co"># IQ scores.</span></span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>dev_iq <span class="ot">&lt;-</span> iq <span class="sc">-</span> <span class="fu">mean</span>(iq)   <span class="co"># Deviations.</span></span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>stdev_iq <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">mean</span>(dev_iq <span class="sc">**</span> <span class="dv">2</span>))  <span class="co"># Standard deviation.</span></span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>std_iq <span class="ot">=</span> dev_iq <span class="sc">/</span> stdev_iq  <span class="co"># Standard scores.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Now calculate the correlation coefficient.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">message</span>(<span class="st">'r value for "ath" and "iq": '</span>, <span class="fu">mean</span>(std_ath <span class="sc">*</span> std_iq))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>r value for "ath" and "iq": 0.709311774030946</code></pre>
</div>
</div>
<p>But multiplication is commutative — changing the order does not change the result — so <span class="math inline">\(a * b = b * a\)</span>. This means that the <code>std_ath * std_id</code> gives the same vector as <code>std_id * std_ath</code>, and:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">message</span>(<span class="st">'r value for "iq" and "ath": '</span>, <span class="fu">mean</span>(std_iq <span class="sc">*</span> std_ath))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>r value for "iq" and "ath": 0.709311774030946</code></pre>
</div>
</div>
</section>
<section id="the-correlation-coefficient-in" class="level3" data-number="29.5.2">
<h3 data-number="29.5.2" class="anchored" data-anchor-id="the-correlation-coefficient-in"><span class="header-section-number">29.5.2</span> The correlation coefficient in R</h3>
<p>R has a function <span class="r"><code>cor</code></span> for calculating the correlation coefficient between two sequences directly.</p>
<!---
End of Python section.
-->
<div class="r">
<p><code>cor</code> works as you would expect:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(ath, iq)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.709</code></pre>
</div>
</div>
</div>
<!---
End of R section.
-->
</section>
<section id="test-linear-association-with-the-correlation-coefficient" class="level3" data-number="29.5.3">
<h3 data-number="29.5.3" class="anchored" data-anchor-id="test-linear-association-with-the-correlation-coefficient"><span class="header-section-number">29.5.3</span> Test linear association with the correlation coefficient</h3>
<p>Above we used the sum-of-products calculation to see if the actual observed sum of products was unusual in the null-world. We simulated sum of product values in the null-world by permuting one of the sequences, and recalculating the sum of products.</p>
<p>We could use the correlation coefficient instead of the sum of products as our measure of association, and simulate correlation coefficients in the null-world. We will come to the same conclusion using sum of products as we would for correlation coefficients because they are equivalent when comparing between two different orderings of the same sequences of values. The only advantage of the correlation coefficient for this case is that R has the ready-made function <span class="r"><code>cor</code></span> to do the calculation. Here is the test for linear association using the correlation coefficient instead of the sum of products. Compare the procedure below to <a href="#sec-ath-iq-sop" class="quarto-xref"><span>Section 29.4.1</span></a>.</p>
<div class="notebook" name="athlete_iq_cc" title="Association of athletic and IQ scores with $r$">
<p>Start of <code>athlete_iq_cc</code> notebook</p>
<div class="nb-links">
<a class="notebook-link" href="notebooks/athlete_iq_cc.zip">Download zip with notebook + data file</a>
<a class="interact-button" href="./interact/lab/index.html?path=athlete_iq_cc.ipynb">Interact</a>
</div>

<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Read the data file containing athletic and IQ scores.</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>ath_iq_df <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">'data/athletic_iq.csv'</span>)</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Turn athletic and IQ scores into vectors.</span></span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>ath <span class="ot">=</span> ath_iq_df<span class="sc">$</span>athletic_score</span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>iq <span class="ot">=</span> ath_iq_df<span class="sc">$</span>iq_score</span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate correlation coefficient.</span></span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a>actual_r <span class="ot">&lt;-</span> <span class="fu">cor</span>(ath, iq)</span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Set the number of trials for the null-world simulation.</span></span>
<span id="cb27-12"><a href="#cb27-12" aria-hidden="true" tabindex="-1"></a>n_trials <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb27-13"><a href="#cb27-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-14"><a href="#cb27-14" aria-hidden="true" tabindex="-1"></a><span class="co"># An empty array to store the trial results.</span></span>
<span id="cb27-15"><a href="#cb27-15" aria-hidden="true" tabindex="-1"></a>results <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n_trials)</span>
<span id="cb27-16"><a href="#cb27-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-17"><a href="#cb27-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Do 10,000 experiments.</span></span>
<span id="cb27-18"><a href="#cb27-18" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n_trials) {</span>
<span id="cb27-19"><a href="#cb27-19" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Shuffle the IQ scores so we can pair them against athletic scores.</span></span>
<span id="cb27-20"><a href="#cb27-20" aria-hidden="true" tabindex="-1"></a>    shuffled <span class="ot">&lt;-</span> <span class="fu">sample</span>(iq)</span>
<span id="cb27-21"><a href="#cb27-21" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Calculate the correlation coefficient.</span></span>
<span id="cb27-22"><a href="#cb27-22" aria-hidden="true" tabindex="-1"></a>    fake_r <span class="ot">&lt;-</span> <span class="fu">cor</span>(ath, shuffled)</span>
<span id="cb27-23"><a href="#cb27-23" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Keep track of the result in results array.</span></span>
<span id="cb27-24"><a href="#cb27-24" aria-hidden="true" tabindex="-1"></a>    results[i] <span class="ot">&lt;-</span> fake_r</span>
<span id="cb27-25"><a href="#cb27-25" aria-hidden="true" tabindex="-1"></a>    <span class="co"># End one trial, go back and repeat until 10000 trials are complete.</span></span>
<span id="cb27-26"><a href="#cb27-26" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb27-27"><a href="#cb27-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-28"><a href="#cb27-28" aria-hidden="true" tabindex="-1"></a><span class="co"># Obtain a histogram of the trial results.</span></span>
<span id="cb27-29"><a href="#cb27-29" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(results, <span class="at">breaks=</span><span class="dv">25</span>,</span>
<span id="cb27-30"><a href="#cb27-30" aria-hidden="true" tabindex="-1"></a>    <span class="at">main=</span><span class="st">'Random correlation coefficients'</span>,</span>
<span id="cb27-31"><a href="#cb27-31" aria-hidden="true" tabindex="-1"></a>    <span class="at">xlab=</span><span class="st">'Observed r values from random pairing'</span>)</span>
<span id="cb27-32"><a href="#cb27-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-33"><a href="#cb27-33" aria-hidden="true" tabindex="-1"></a><span class="co"># Determine in how many trials the random r value was greater than</span></span>
<span id="cb27-34"><a href="#cb27-34" aria-hidden="true" tabindex="-1"></a><span class="co"># the observed r value.</span></span>
<span id="cb27-35"><a href="#cb27-35" aria-hidden="true" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="fu">sum</span>(results <span class="sc">&gt;=</span> actual_r)</span>
<span id="cb27-36"><a href="#cb27-36" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert to a proportion.</span></span>
<span id="cb27-37"><a href="#cb27-37" aria-hidden="true" tabindex="-1"></a>kk <span class="ot">&lt;-</span> k <span class="sc">/</span> n_trials</span>
<span id="cb27-38"><a href="#cb27-38" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the result.</span></span>
<span id="cb27-39"><a href="#cb27-39" aria-hidden="true" tabindex="-1"></a><span class="fu">message</span>(<span class="st">'Proportion of random pairings giving r &gt;= observed: '</span>, kk)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Proportion of random pairings giving r &gt;= observed: 0.0107</code></pre>
</div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="correlation_causation_files/figure-html/unnamed-chunk-46-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:70.0%"></p>
</figure>
</div>
</div>
</div>
<p>End of <code>athlete_iq_cc</code> notebook</p>
</div>
<!---
End of notebook
-->
<p>Notice we get a very similar proportion (p-value) with the correlation coefficient to the one from sum of products in <a href="#sec-ath-iq-sop" class="quarto-xref"><span>Section 29.4.1</span></a>; in fact, the p-values only differ because the p-value is itself somewhat random, as it derives from (many) random samples.</p>
</section>
</section>
<section id="sec-counted-association" class="level2" data-number="29.6">
<h2 data-number="29.6" class="anchored" data-anchor-id="sec-counted-association"><span class="header-section-number">29.6</span> Testing for a relationship between counted-data variables</h2>
<section id="example-drinking-beer-and-being-in-favor-of-selling-beer" class="level3" data-number="29.6.1">
<h3 data-number="29.6.1" class="anchored" data-anchor-id="example-drinking-beer-and-being-in-favor-of-selling-beer"><span class="header-section-number">29.6.1</span> Example: Drinking Beer And Being In Favor of Selling Beer</h3>
<p>Earlier in this chapter, we analyzed measured values for athletic ability and I.Q. We can use them in their original “cardinal” form, or split them up into “high” and “low” groups. Often, however, the individual observations are recorded only as categories such “yes” or “no,” which makes it more difficult to ascertain the existence of a relationship. Consider the poll responses in <a href="#tbl-beerpol-data" class="quarto-xref">Table&nbsp;<span>29.8</span></a> to two public-opinion survey questions: “Do you drink beer?” and “Are you in favor of a local option on the sale of beer?”.<a href="#fn3" class="footnote-ref" id="fnref3" role="doc-noteref"><sup>3</sup></a></p>
<!---
Page 278 in 4th edition, example 13-5.

The actual numbers are:

Question 2  Beer Yes Beer No
==========  ======== =======
Local Yes   37       20
Local No    15        6
-->
<div id="tbl-beerpol-data" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-beerpol-data-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;29.8: Results of Observed Sample For beer poll
</figcaption>
<div aria-describedby="tbl-beerpol-data-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table class="caption-top table">
<colgroup>
<col style="width: 61%">
<col style="width: 10%">
<col style="width: 10%">
<col style="width: 14%">
</colgroup>
<tbody>
<tr class="odd">
<td>Do you favor local option on the sale of beer?</td>
<td colspan="3">Do you drink beer?</td>
</tr>
<tr class="even">
<td></td>
<td>Yes</td>
<td>No</td>
<td><strong>Total</strong></td>
</tr>
<tr class="odd">
<td>Favor</td>
<td>45</td>
<td>20</td>
<td><strong>65</strong></td>
</tr>
<tr class="even">
<td>Don’t favor</td>
<td>7</td>
<td>6</td>
<td><strong>13</strong></td>
</tr>
<tr class="odd">
<td><strong>Total</strong></td>
<td><strong>52</strong></td>
<td><strong>26</strong></td>
<td><strong>78</strong></td>
</tr>
</tbody>
</table>
</div>
</figure>
</div>
<p>Here is the statistical question: Is a person’s opinion on “local option” related to whether or not they drink beer? Our resampling solution begins by noting that there are seventy-eight respondents, sixty-five of whom approve local option and thirteen of whom do not. Therefore write “approve” on sixty-five index cards and “not approve” on thirteen index cards. Now take <em>another</em> set of seventy-eight index cards, preferably of a different color, and write “yes” on fifty-two of them and “no” on twenty-six of them, corresponding to the numbers of people who do and do not drink beer in the sample. Now lay them down in random <em>pairs</em> , one from each pile.</p>
<p>If there is a high association between the variables, then real life observations will bunch up in the two diagonal cells in the upper left and lower right in <a href="#tbl-beerpol-data" class="quarto-xref">Table&nbsp;<span>29.8</span></a>. (Ignore the “total” data for now.) Put another way, people filling in the upper left and lower right cells are people with views compatible with their drinking habits (drink-yes / favor, or drink-no / don’t favor). Conversely, people filling in the lower left and upper right cells have views incompatible with their drinking habits (drink-yes, don’t favor, or drink-no, favor). Adding up the upper left / lower right diagonal gives us the total number of <em>compatible</em> responses, and adding the lower left / upper right diagonal gives us the <em>incompatible</em> total. Therefore, et an index of how strongly the table show compatible responses, we can subtract the incompatible total (lower left plus upper right) from the compatible total (upper left plus lower right) for the observed data: (45 + 6) - (20 + 7) = 24. Then compare this difference to the comparable differences found in random trials. The proportion of times that the simulated-trial difference exceeds the observed difference is the probability that the observed difference of +24 might occur by chance, even if there is no relationship between the two variables. (Notice that, in this case, we are working on the assumption that beer drinking is <em>positively</em> associated with approval of local option and not the inverse. We are interested only in differences that are equal to or exceed +24 when the northeast-southwest diagonal is subtracted from the northwest-southeast diagonal.)</p>
<p>We can carry out a resampling test with this procedure:</p>
<ul>
<li><strong>Step 1.</strong> Write “approve” on 65 and “disapprove” on 13 red index cards, respectively; write “Drink” and “Don’t drink” on 52 and 26 white cards, respectively.</li>
<li><strong>Step 2.</strong> Pair the two sets of cards randomly. Count the numbers of the four possible pairs: (1) “approve-drink,” (2) “disapprove-don’t drink,” (3) “disapprove-drink,” and (4) “approve-don’t drink.” Record the number of these combinations, as in Table 23-10, where columns 1-4 correspond to the four cells in Table 23-9.</li>
<li><strong>Step 3.</strong> Add (column 1 plus column 4), then add (column 2 plus column 3), and subtract the result in the second parenthesis from the result in the first parenthesis. If the difference is equal to or greater than 24, record “yes,” otherwise “no.”</li>
<li><strong>Step 4.</strong> Repeat steps 2 and 3 perhaps a hundred times.</li>
<li><strong>Step 5.</strong> Calculate the proportion “yes,” which estimates the probability that an association this great or greater would be observed by chance.</li>
</ul>
<div id="tbl-beerpol-trial" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-beerpol-trial-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;29.9: Results of one random trial of the beer poll problem
</figcaption>
<div aria-describedby="tbl-beerpol-trial-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table class="caption-top table">
<colgroup>
<col style="width: 9%">
<col style="width: 14%">
<col style="width: 14%">
<col style="width: 15%">
<col style="width: 15%">
<col style="width: 24%">
</colgroup>
<thead>
<tr class="header">
<th></th>
<th>1</th>
<th>2</th>
<th>3</th>
<th>4</th>
<th>5</th>
</tr>
<tr class="odd">
<th>Trial</th>
<th>Approve Yes</th>
<th>Approve No</th>
<th>Disapprove Yes</th>
<th>Disapprove No</th>
<th>(Col 1 + Col 4) - (Col 2 + Col 3)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>43</td>
<td>22</td>
<td>9</td>
<td>4</td>
<td>47 - 31 = 16</td>
</tr>
</tbody>
</table>
</div>
</figure>
</div>
<p><a href="#tbl-beerpol-trial" class="quarto-xref">Table&nbsp;<span>29.9</span></a> shows the result of one such trial. When we run a series of ten trials such trials, it indicates that the observed difference is very often exceeded, which suggests that we have no good evidence here for a relationship between beer drinking and opinion.</p>
<p>The R notebook below does this repetitively. From the “actual” sample results we know that 52 respondents drink beer and 26 do not. We create the vector “drink” with 52 1’s for those who drink beer, and 26 0’s for those who do not. We also create the vector “sale” with 65 1’s (approve) and 13 0’s (disapprove). In the actual sample, 51 of the 78 respondents had “consistent” responses to the two questions — that is, people who both favor the sale of beer <em>and</em> drink beer, or who are against the sale of beer <em>and</em> do not drink beer. We want to randomly pair the responses to the two questions to compare against that observed result to test the relationship.</p>
<p>To accomplish this aim, we repeat the following procedure 10,000 times using a <code>for</code> loop. We shuffle <code>drink</code> to <code>random_drink</code> so that the responses are randomly ordered. Now when we subtract the corresponding elements of the two vectors, a 0 will appear in each element of the new vector <code>diffs</code> for which there was consistency in the response of the two questions. We therefore count (<code>sum</code>) the times that <code>diffs</code> equals 0 and place this result in the vector <code>consistent</code> and the number of times <code>diffs</code> does not equal 0, and place this result in <code>inconsistent</code>. Find the difference (<code>consistent</code> minus <code>inconsistent</code>), and record the result in the <code>results</code> vector for each trial.</p>
<p><code>results</code> stores, for each trial, the number of consistent responses minus inconsistent responses. To determine whether the results of the actual sample indicate a relationship between the responses to the two questions, we check how often the random trials had a difference (between consistent and inconsistent responses) as great as 24, the value in the observed sample.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Constitute the set of 52 beer drinkers, and the set of 26 non-drinkers,</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a><span class="co"># where 1 represents beer drinker, and 0 represents non-drinker.</span></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>drink <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">0</span>), <span class="fu">c</span>(<span class="dv">52</span>, <span class="dv">26</span>))</span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Show the result</span></span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>drink</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
[39] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
[77] 0 0</code></pre>
</div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="co"># The same set of individuals classified by whether they favor or</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a><span class="co"># don't favor the sale of beer, where 1 represents those who favor</span></span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a><span class="co"># local beer sale, and 0 represents those who do not.</span></span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>sale <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">0</span>), <span class="fu">c</span>(<span class="dv">65</span>, <span class="dv">13</span>))</span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Show the result</span></span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>sale</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
[39] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 0 0 0 0 0 0 0 0 0 0
[77] 0 0</code></pre>
</div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Number of repeats.</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>n_trials <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Array to store the results of each trial.</span></span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>results <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n_trials)</span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Repeat the experiment 10,000 times.</span></span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n_trials) {</span>
<span id="cb33-9"><a href="#cb33-9" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Shuffle the drink labels..</span></span>
<span id="cb33-10"><a href="#cb33-10" aria-hidden="true" tabindex="-1"></a>    random_drink <span class="ot">&lt;-</span> <span class="fu">sample</span>(drink)</span>
<span id="cb33-11"><a href="#cb33-11" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Note: random_drink is now an array like</span></span>
<span id="cb33-12"><a href="#cb33-12" aria-hidden="true" tabindex="-1"></a>    <span class="co"># [1, 0, 1, 1, 1, 0, 0, 1 ...]</span></span>
<span id="cb33-13"><a href="#cb33-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-14"><a href="#cb33-14" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Subtract the favor/don't favor set from the drink/don't drink set.</span></span>
<span id="cb33-15"><a href="#cb33-15" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Consistent responses are someone who drinks favoring the sale of beer (a</span></span>
<span id="cb33-16"><a href="#cb33-16" aria-hidden="true" tabindex="-1"></a>    <span class="co"># 1 and a 1) or someone who doesn't drink opposing the sale of beer.</span></span>
<span id="cb33-17"><a href="#cb33-17" aria-hidden="true" tabindex="-1"></a>    <span class="co"># When subtracted, consistent responses *(and only consistent responses)*</span></span>
<span id="cb33-18"><a href="#cb33-18" aria-hidden="true" tabindex="-1"></a>    <span class="co"># produce a 0.</span></span>
<span id="cb33-19"><a href="#cb33-19" aria-hidden="true" tabindex="-1"></a>    diffs <span class="ot">&lt;-</span> random_drink <span class="sc">-</span> sale</span>
<span id="cb33-20"><a href="#cb33-20" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Count the number of consistent responses (those equal to 0).</span></span>
<span id="cb33-21"><a href="#cb33-21" aria-hidden="true" tabindex="-1"></a>    consistent <span class="ot">&lt;-</span> <span class="fu">sum</span>(diffs <span class="sc">==</span> <span class="dv">0</span>)</span>
<span id="cb33-22"><a href="#cb33-22" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Count the "inconsistent" responses (those not equal to 0).</span></span>
<span id="cb33-23"><a href="#cb33-23" aria-hidden="true" tabindex="-1"></a>    inconsistent <span class="ot">&lt;-</span> <span class="fu">sum</span>(diffs <span class="sc">!=</span> <span class="dv">0</span>)</span>
<span id="cb33-24"><a href="#cb33-24" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Find the difference</span></span>
<span id="cb33-25"><a href="#cb33-25" aria-hidden="true" tabindex="-1"></a>    diff_diff <span class="ot">&lt;-</span> consistent <span class="sc">-</span> inconsistent</span>
<span id="cb33-26"><a href="#cb33-26" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Keep track of the results of each trial.</span></span>
<span id="cb33-27"><a href="#cb33-27" aria-hidden="true" tabindex="-1"></a>    results[i] <span class="ot">&lt;-</span> diff_diff</span>
<span id="cb33-28"><a href="#cb33-28" aria-hidden="true" tabindex="-1"></a>    <span class="co"># End one trial, go back and repeat until all 10,000 trials are complete.</span></span>
<span id="cb33-29"><a href="#cb33-29" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb33-30"><a href="#cb33-30" aria-hidden="true" tabindex="-1"></a><span class="co"># Produce a histogram of the trial result.</span></span>
<span id="cb33-31"><a href="#cb33-31" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(results, <span class="at">breaks=</span><span class="dv">0</span><span class="sc">:</span><span class="dv">40</span>,</span>
<span id="cb33-32"><a href="#cb33-32" aria-hidden="true" tabindex="-1"></a>    <span class="at">main=</span><span class="st">'Consistent-inconsistent responses in null world'</span>,</span>
<span id="cb33-33"><a href="#cb33-33" aria-hidden="true" tabindex="-1"></a>    <span class="at">xlab=</span><span class="st">'Consistent-inconsistent responses'</span>)</span>
<span id="cb33-34"><a href="#cb33-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-35"><a href="#cb33-35" aria-hidden="true" tabindex="-1"></a><span class="co"># Count differences &gt;= observed.</span></span>
<span id="cb33-36"><a href="#cb33-36" aria-hidden="true" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="fu">sum</span>(results <span class="sc">&gt;=</span> <span class="dv">24</span>)</span>
<span id="cb33-37"><a href="#cb33-37" aria-hidden="true" tabindex="-1"></a><span class="co"># Proportion.</span></span>
<span id="cb33-38"><a href="#cb33-38" aria-hidden="true" tabindex="-1"></a>kk <span class="ot">&lt;-</span> k <span class="sc">/</span> n_trials</span>
<span id="cb33-39"><a href="#cb33-39" aria-hidden="true" tabindex="-1"></a><span class="co"># Print result.</span></span>
<span id="cb33-40"><a href="#cb33-40" aria-hidden="true" tabindex="-1"></a><span class="fu">message</span>(<span class="st">'Proportion null-world differences &gt;= observed: '</span>, kk)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Proportion null-world differences &gt;= observed: 0.2238</code></pre>
</div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="correlation_causation_files/figure-html/unnamed-chunk-52-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:70.0%"></p>
</figure>
</div>
</div>
</div>
<p>::: <!---
End of notebook
--></p>
<p>The actual results showed a difference of 24. In the histogram we see that a difference that large or larger happened just by chance pairing — without any relationship between the two variables — about 22 percent of the time. Hence, we conclude that there is little evidence of a relationship between the two variables.</p>
<p>Though the test just described may <em>generally</em> be appropriate for data of this sort, it may well not be appropriate in some particular case. Let’s consider a set of data where even if the test showed that an association existed, we would not believe the test result to be meaningful.</p>
<p>Suppose the survey results had been as presented in <a href="#tbl-crazy-beer" class="quarto-xref">Table&nbsp;<span>29.10</span></a>. We see that non-beer drinkers have a higher rate of approval of allowing beer drinking, which does not accord with experience or reason. Hence, without additional explanation we would not believe that a meaningful relationship exists among these variables even if the test showed one to exist. (Still another reason to doubt that a relationship exists is that the absolute differences are too small to mean anything to anyone — there is only a 6% difference in disapproval between drink and don’t drink groups. On both grounds, then, it makes sense simply to act as if there were no difference between the two groups and to run <em>no test</em>.)</p>
<div id="tbl-crazy-beer" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-crazy-beer-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;29.10: Beer poll in which results are not in accord with expectation
</figcaption>
<div aria-describedby="tbl-crazy-beer-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table class="caption-top table">
<thead>
<tr class="header">
<th></th>
<th>% Approve</th>
<th>% Disapprove</th>
<th>Total</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Beer Drinkers</td>
<td>71%</td>
<td>29%</td>
<td>100%</td>
</tr>
<tr class="even">
<td>Non-Beer Drinkers</td>
<td>77%</td>
<td>23%</td>
<td>100%</td>
</tr>
</tbody>
</table>
</div>
</figure>
</div>
<p>The lesson to be learned from this is that one should inspect the data carefully before applying a statistical test, and only test for “significance” if the apparent relationships accord with theory, general understanding, and common sense.</p>
</section>
<section id="example-do-athletes-really-have-slumps" class="level3" data-number="29.6.2">
<h3 data-number="29.6.2" class="anchored" data-anchor-id="example-do-athletes-really-have-slumps"><span class="header-section-number">29.6.2</span> Example: do athletes really have “slumps”?</h3>
<p><strong>Are successive events in a series independent, or is there a relationship between them?</strong></p>
<p>The important concept of independent events was introduced earlier. Various scientific and statistical decisions depend upon whether or not a series of events is independent. But how does one know whether or not the events are independent? Let us consider a baseball example.</p>
<p>Baseball players and their coaches believe that on some days and during some weeks a player will bat better than on other days and during other weeks. And team managers and coaches act on the belief that there are periods in which players do poorly — slumps — by temporarily replacing the player with another after a period of poor performance. The underlying belief is that a series of failures indicates a temporary (or permanent) change in the player’s capacity to play well, and it therefore makes sense to replace him until the evil spirit passes on, either of its own accord or by some change in the player’s style.</p>
<p>But even if his hits come randomly, a player will have runs of good luck and runs of bad luck just by chance — just as does a card player. The problem, then, is to determine whether (a) the runs of good and bad batting are merely runs of chance, and the probability of success for each event remains the same throughout the series of events — which would imply that the batter’s ability is the same at all times, and coaches should not take recent performance heavily into account when deciding which players should play; or (b) whether a batter really does have a tendency to do better at some times than at others, which would imply that there is some relationship between the occurrence of success in one trial event and the probability of success in the next trial event, and therefore that it is reasonable to replace players from time to time.</p>
<p>Let’s analyze the batting of a player we shall call “Slug.” Here are the results of Slug’s first 100 times at bat during the 1987 season (“H” = hit, “X” = out):</p>
<p>X X X X X X H X X H X H H X X X X X X X X H X X X X X H X X X X H H X X X X X H X X H X H X X X H H X X X X X H X H X X X X H H X H H X X X X X X X X X X H X X X H X X H X X H X H X X H X X X H X X X.</p>
<p>Now, do Slug’s hits tend to come in bunches? That would be the case if he really did have a tendency to do better at some times than at others. Therefore, let us compare Slug’s results with those of a deck of cards or a set of random numbers that we know has no tendency to do better at some times than at others.</p>
<p>During this period of 100 times at bat, Slug has averaged one hit in every four times at bat — a .250 batting average. This average is the same as the chance of one card suit’s coming up. We designate hearts as “hits” and prepare a deck of 100 cards, twenty-five “H”s (hearts, or “hit”) and seventy-five “X”s (other suit, or “out”). Here is the sequence in which the 100 randomly-shuffled cards fell:</p>
<p>X X H X X X X H H X X X H H H X X X X X H X X X H X X H X X X X H X H H X X X X X X X X X H X X X X X X H H X X X X X H H H X X X X X X H X H X H X X H X H X X X X X X X X X H X X X X X X X H H H X X.</p>
<p>Now we can compare whether or not Slug’s hits are bunched up more than they would be by random chance; we can do so by <em>counting the clusters</em> (also called “runs”) of <em>one or more</em> consecutive hits or outs for Slug and for the cards. Notice a cluster (run) can be length 1. So “H H X X X H X H” contains five clusters — they are “H H”, “X X X”, “H” “X” “H”. Notice too that number of clusters will be highest <em>when there is no clumping</em> — that is - when “H” and “X” always alternate, as in “H X H X H X …”. Slug had forty-three clusters, which is more than the thirty-seven clusters in the cards; it therefore does not seem that there is a tendency for Slug’s hits to clump together. (A larger number of clusters indicates a lower tendency to cluster.)</p>
<p>Of course, the single trial of 100 cards shown above might have an unusually high or low number of clusters. To be safer, lay out, (say,) ten trials of 100 cards each, and compare Slug’s number of clusters with the various trials. The proportion of trials with more clusters than Slug’s indicates whether or not Slug’s hits have a tendency to bunch up. (But caution: This proportion cannot be interpreted directly as a probability.) Now the steps:</p>
<ul>
<li><strong>Step 1.</strong> Constitute a bucket with 3 slips of paper that say “out” and one that says “hit.” Or use a table of random numbers and say “01-25” = hits (H), “26-00” = outs (X), Slug’s long-run average.</li>
<li><strong>Step 2.</strong> Sample 100 slips of paper, with replacement, record “hit” or “out” each time, or write a series of “H’s” or “X’s” corresponding to 100 numbers, each selected randomly between 1 and 100.</li>
<li><strong>Step 3.</strong> Count the number of “clusters,” that is, the number of “runs” of the same event, “H”s or “X”s.</li>
<li><strong>Step 4.</strong> Compare the outcome in step 3 with Slug’s outcome, 43 clusters. If 43 or fewer; write “yes,” otherwise “no.”</li>
<li><strong>Step 5.</strong> Repeat steps 2-4 a hundred times.</li>
<li><strong>Step 6.</strong> Compute the proportion “yes.” This estimates the probability that Slug’s record is not characterized by more “slumps” than would be caused by chance. A very low proportion of “yeses” indicates longer (and hence fewer) “streaks” and “slumps” than would result by chance.</li>
</ul>
<p>In R, we can do this experiment 10000 times.</p>
<div class="notebook" name="slugs_slumps" title="Do Slugs hits and misses tend to cluster?">
<p>Start of <code>slugs_slumps</code> notebook</p>
<div class="nb-links">
<a class="notebook-link" href="notebooks/slugs_slumps.Rmd">Download notebook</a>
<a class="interact-button" href="./interact/lab/index.html?path=slugs_slumps.ipynb">Interact</a>
</div>

<p>First let us work out how to calculate the number of clusters as defined above.</p>
<p>This is Slug’s record:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>slug <span class="ot">=</span> <span class="fu">c</span>(</span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">'X'</span>, <span class="st">'X'</span>, <span class="st">'X'</span>, <span class="st">'X'</span>, <span class="st">'X'</span>, <span class="st">'X'</span>, <span class="st">'H'</span>, <span class="st">'X'</span>, <span class="st">'X'</span>, <span class="st">'H'</span>, <span class="st">'X'</span>, <span class="st">'H'</span>, <span class="st">'H'</span>, <span class="st">'X'</span>, <span class="st">'X'</span>,</span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">'X'</span>, <span class="st">'X'</span>, <span class="st">'X'</span>, <span class="st">'X'</span>, <span class="st">'X'</span>, <span class="st">'X'</span>, <span class="st">'H'</span>, <span class="st">'X'</span>, <span class="st">'X'</span>, <span class="st">'X'</span>, <span class="st">'X'</span>, <span class="st">'X'</span>, <span class="st">'H'</span>, <span class="st">'X'</span>, <span class="st">'X'</span>,</span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">'X'</span>, <span class="st">'X'</span>, <span class="st">'H'</span>, <span class="st">'H'</span>, <span class="st">'X'</span>, <span class="st">'X'</span>, <span class="st">'X'</span>, <span class="st">'X'</span>, <span class="st">'X'</span>, <span class="st">'H'</span>, <span class="st">'X'</span>, <span class="st">'X'</span>, <span class="st">'H'</span>, <span class="st">'X'</span>, <span class="st">'H'</span>,</span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">'X'</span>, <span class="st">'X'</span>, <span class="st">'X'</span>, <span class="st">'H'</span>, <span class="st">'H'</span>, <span class="st">'X'</span>, <span class="st">'X'</span>, <span class="st">'X'</span>, <span class="st">'X'</span>, <span class="st">'X'</span>, <span class="st">'H'</span>, <span class="st">'X'</span>, <span class="st">'H'</span>, <span class="st">'X'</span>, <span class="st">'X'</span>,</span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">'X'</span>, <span class="st">'X'</span>, <span class="st">'H'</span>, <span class="st">'H'</span>, <span class="st">'X'</span>, <span class="st">'H'</span>, <span class="st">'H'</span>, <span class="st">'X'</span>, <span class="st">'X'</span>, <span class="st">'X'</span>, <span class="st">'X'</span>, <span class="st">'X'</span>, <span class="st">'X'</span>, <span class="st">'X'</span>, <span class="st">'X'</span>,</span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">'X'</span>, <span class="st">'X'</span>, <span class="st">'H'</span>, <span class="st">'X'</span>, <span class="st">'X'</span>, <span class="st">'X'</span>, <span class="st">'H'</span>, <span class="st">'X'</span>, <span class="st">'X'</span>, <span class="st">'H'</span>, <span class="st">'X'</span>, <span class="st">'X'</span>, <span class="st">'H'</span>, <span class="st">'X'</span>, <span class="st">'H'</span>,</span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a>    <span class="st">'X'</span>, <span class="st">'X'</span>, <span class="st">'H'</span>, <span class="st">'X'</span>, <span class="st">'X'</span>, <span class="st">'X'</span>, <span class="st">'H'</span>, <span class="st">'X'</span>, <span class="st">'X'</span>, <span class="st">'X'</span></span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Here’s how we can calculate the number of runs:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>slug_runs <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>current_element <span class="ot">&lt;-</span> <span class="st">'start-marker'</span>  <span class="co"># Something that is always != to the elements.</span></span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (element <span class="cf">in</span> slug) {</span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (element <span class="sc">!=</span> current_element) {  <span class="co"># The previous cluster has finished.</span></span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>        slug_runs <span class="ot">&lt;-</span> slug_runs <span class="sc">+</span> <span class="dv">1</span>  <span class="co"># Record we are in a new cluster.</span></span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a>        current_element <span class="ot">&lt;-</span> element  <span class="co"># Give the starting element for the new cluster.</span></span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb36-9"><a href="#cb36-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Show the count.</span></span>
<span id="cb36-10"><a href="#cb36-10" aria-hidden="true" tabindex="-1"></a>slug_runs</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 43</code></pre>
</div>
</div>
<p>For practice, let us count the number of clusters in the random set of cards above:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>random_hand <span class="ot">=</span> <span class="fu">c</span>(</span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">'X'</span>, <span class="st">'X'</span>, <span class="st">'H'</span>, <span class="st">'X'</span>, <span class="st">'X'</span>, <span class="st">'X'</span>, <span class="st">'X'</span>, <span class="st">'H'</span>, <span class="st">'H'</span>, <span class="st">'X'</span>, <span class="st">'X'</span>, <span class="st">'X'</span>, <span class="st">'H'</span>, <span class="st">'H'</span>, <span class="st">'H'</span>,</span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">'X'</span>, <span class="st">'X'</span>, <span class="st">'X'</span>, <span class="st">'X'</span>, <span class="st">'X'</span>, <span class="st">'H'</span>, <span class="st">'X'</span>, <span class="st">'X'</span>, <span class="st">'X'</span>, <span class="st">'H'</span>, <span class="st">'X'</span>, <span class="st">'X'</span>, <span class="st">'H'</span>, <span class="st">'X'</span>, <span class="st">'X'</span>,</span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">'X'</span>, <span class="st">'X'</span>, <span class="st">'H'</span>, <span class="st">'X'</span>, <span class="st">'H'</span>, <span class="st">'H'</span>, <span class="st">'X'</span>, <span class="st">'X'</span>, <span class="st">'X'</span>, <span class="st">'X'</span>, <span class="st">'X'</span>, <span class="st">'X'</span>, <span class="st">'X'</span>, <span class="st">'X'</span>, <span class="st">'X'</span>,</span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">'H'</span>, <span class="st">'X'</span>, <span class="st">'X'</span>, <span class="st">'X'</span>, <span class="st">'X'</span>, <span class="st">'X'</span>, <span class="st">'X'</span>, <span class="st">'H'</span>, <span class="st">'H'</span>, <span class="st">'X'</span>, <span class="st">'X'</span>, <span class="st">'X'</span>, <span class="st">'X'</span>, <span class="st">'X'</span>, <span class="st">'H'</span>,</span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">'H'</span>, <span class="st">'H'</span>, <span class="st">'X'</span>, <span class="st">'X'</span>, <span class="st">'X'</span>, <span class="st">'X'</span>, <span class="st">'X'</span>, <span class="st">'X'</span>, <span class="st">'H'</span>, <span class="st">'X'</span>, <span class="st">'H'</span>, <span class="st">'X'</span>, <span class="st">'H'</span>, <span class="st">'X'</span>, <span class="st">'X'</span>,</span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">'H'</span>, <span class="st">'X'</span>, <span class="st">'H'</span>, <span class="st">'X'</span>, <span class="st">'X'</span>, <span class="st">'X'</span>, <span class="st">'X'</span>, <span class="st">'X'</span>, <span class="st">'X'</span>, <span class="st">'X'</span>, <span class="st">'X'</span>, <span class="st">'X'</span>, <span class="st">'H'</span>, <span class="st">'X'</span>, <span class="st">'X'</span>,</span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true" tabindex="-1"></a>    <span class="st">'X'</span>, <span class="st">'X'</span>, <span class="st">'X'</span>, <span class="st">'X'</span>, <span class="st">'X'</span>, <span class="st">'H'</span>, <span class="st">'H'</span>, <span class="st">'H'</span>, <span class="st">'X'</span>, <span class="st">'X'</span></span>
<span id="cb38-9"><a href="#cb38-9" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb38-10"><a href="#cb38-10" aria-hidden="true" tabindex="-1"></a>random_runs <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb38-11"><a href="#cb38-11" aria-hidden="true" tabindex="-1"></a>current_element <span class="ot">&lt;-</span> <span class="st">'start-marker'</span>  <span class="co"># Something that is always != to the elements.</span></span>
<span id="cb38-12"><a href="#cb38-12" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (element <span class="cf">in</span> random_hand) {</span>
<span id="cb38-13"><a href="#cb38-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (element <span class="sc">!=</span> current_element) {  <span class="co"># The previous cluster has finished.</span></span>
<span id="cb38-14"><a href="#cb38-14" aria-hidden="true" tabindex="-1"></a>        random_runs <span class="ot">&lt;-</span> random_runs <span class="sc">+</span> <span class="dv">1</span>  <span class="co"># Record we are in a new cluster.</span></span>
<span id="cb38-15"><a href="#cb38-15" aria-hidden="true" tabindex="-1"></a>        current_element <span class="ot">&lt;-</span> element  <span class="co"># Give the starting element for the new cluster.</span></span>
<span id="cb38-16"><a href="#cb38-16" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb38-17"><a href="#cb38-17" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb38-18"><a href="#cb38-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Show the result.</span></span>
<span id="cb38-19"><a href="#cb38-19" aria-hidden="true" tabindex="-1"></a>random_runs</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 37</code></pre>
</div>
</div>
<p>We will use that code in the procedure below.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Set the number of trials.</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>n_trials <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a><span class="co"># An empty array to store the trials.</span></span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a>results <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n_trials)</span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n_trials) {</span>
<span id="cb40-8"><a href="#cb40-8" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Sample 100 "at-bats" with Slug's own probabilities.</span></span>
<span id="cb40-9"><a href="#cb40-9" aria-hidden="true" tabindex="-1"></a>    hits_misses <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="st">'H'</span>, <span class="st">'X'</span>), <span class="at">size=</span><span class="dv">100</span>, <span class="at">replace=</span><span class="cn">TRUE</span>, <span class="at">prob=</span><span class="fu">c</span>(<span class="fl">0.25</span>, <span class="fl">0.75</span>))</span>
<span id="cb40-10"><a href="#cb40-10" aria-hidden="true" tabindex="-1"></a>    <span class="co"># How many runs (of any length &gt;=1) are there in the 100 at-bats?</span></span>
<span id="cb40-11"><a href="#cb40-11" aria-hidden="true" tabindex="-1"></a>    fake_runs <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb40-12"><a href="#cb40-12" aria-hidden="true" tabindex="-1"></a>    current_element <span class="ot">&lt;-</span> <span class="st">'start-marker'</span>  <span class="co"># Something always != to the elements.</span></span>
<span id="cb40-13"><a href="#cb40-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (element <span class="cf">in</span> hits_misses) {</span>
<span id="cb40-14"><a href="#cb40-14" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> (element <span class="sc">!=</span> current_element) {  <span class="co"># The previous cluster has finished.</span></span>
<span id="cb40-15"><a href="#cb40-15" aria-hidden="true" tabindex="-1"></a>            fake_runs <span class="ot">&lt;-</span> fake_runs <span class="sc">+</span> <span class="dv">1</span>  <span class="co"># Record we are in a new cluster.</span></span>
<span id="cb40-16"><a href="#cb40-16" aria-hidden="true" tabindex="-1"></a>            current_element <span class="ot">&lt;-</span> element  <span class="co"># Give the starting element for the new cluster.</span></span>
<span id="cb40-17"><a href="#cb40-17" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb40-18"><a href="#cb40-18" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb40-19"><a href="#cb40-19" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Record the result.</span></span>
<span id="cb40-20"><a href="#cb40-20" aria-hidden="true" tabindex="-1"></a>    results[i] <span class="ot">&lt;-</span> fake_runs</span>
<span id="cb40-21"><a href="#cb40-21" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb40-22"><a href="#cb40-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-23"><a href="#cb40-23" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(results, <span class="at">breaks=</span><span class="dv">25</span>,</span>
<span id="cb40-24"><a href="#cb40-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">main=</span><span class="st">'Distribution of number of clusters in random hit/miss arrays'</span>,</span>
<span id="cb40-25"><a href="#cb40-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">xlab=</span><span class="st">'Number of clusters'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="correlation_causation_files/figure-html/unnamed-chunk-61-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:70.0%"></p>
</figure>
</div>
</div>
</div>
<p>Examining the histogram, we see that 43 runs is not at all an unusual occurrence.</p>
<p>End of <code>slugs_slumps</code> notebook</p>
</div>
<!---
End of notebook
-->
<p>The manager wants to look at this matter in a somewhat different fashion, however. He insists that the existence of slumps is proven by the fact that the player sometimes does not get a hit for an abnormally long period of time. One way of testing whether or not the coach is right is by comparing an average player’s longest slump in a 100-at-bat season with the longest run of outs in the first card trial. Assume that Slug is a player picked <em>at random</em> . Then compare Slug’s longest slump — say, 10 outs in a row — with the longest cluster of a single simulated 100-at-bat trial with the cards, 9 outs. This result suggests that Slug’s apparent slump might well have resulted by chance.</p>
<p>The estimate can be made more accurate by taking the <em>average</em> longest slump (cluster of outs) in ten simulated 400-at-bat trials. But notice that we do <em>not</em> compare Slug’s slump against the <em>longest</em> slump found in ten such simulated trials. We want to know the longest cluster of outs that would be found under <em>average</em> conditions, and the hand with the <em>longest</em> slump is <em>not</em> average or typical. Determining whether to compare Slug’s slump with the <em>average</em> longest slump or with the <em>longest</em> of the ten longest slumps is a decision of crucial importance. There are no mathematical or logical rules to help you. What is required is hard, clear thinking. Experience can help you think clearly, of course, but these decisions are not easy or obvious even to the most experienced statisticians.</p>
<p>The coach may then refer to the protracted slump of one of the twenty-five players on his team to prove that slumps really occur. But, of twenty-five random 100-at-bat trials, one will contain a slump longer than any of the other twenty-four, and that slump will be considerably longer than average. A fair comparison, then, would be between the longest slump of his longest-slumping player, and the longest run of outs found among twenty-five random trials. In fact, the longest run among twenty-five hands of 100 cards was fifteen outs in a row. And, if we had set some of the hands for lower (and higher) batting averages than .250, the longest slump in the cards would have been even longer.</p>
<p>Research by Roberts and his students at the University of Chicago shows that in fact slumps do <em>not</em> exist, as I conjectured in the first publication of this material in 1969. (Of course, a batter feels as if he has a better chance of getting a hit at some times than at other times. After a series of successful at-bats, sandlot players and professionals alike feel confident — just as gamblers often feel that they’re on a “streak.” But there seems to be no connection between a player’s performance and whether he feels hot or cold, astonishing as that may be.)</p>
<p>Averages over longer periods may vary systematically, as Ty Cobb’s annual batting average varied non-randomly from season to season, Roberts found. But short-run analyses of dayto-day and week-to-week individual and team performances in most sports have shown results similar to the outcomes that a lottery-type random-number machine would produce.</p>
<p>Remember, too, the study by Gilovich, Vallone, and Twersky of basketball mentioned in <a href="sampling_variability.html" class="quarto-xref"><span>Chapter 14</span></a>. To repeat, their analyses “provided no evidence for a positive correlation between the outcomes of successive shots.” That is, knowing whether a shooter has or has not scored on the previous sheet — or in any previous sequence of shots — is useless for predicting whether they will score again.</p>
<p>The species <em>homo sapiens</em> apparently has a powerful propensity to believe that one can find a pattern even when there is no pattern to be found. Two decades ago I (JLS) cooked up several series of random numbers that looked like weekly prices of publicly-traded stocks. Players in the experiment were told to buy and sell stocks as they chose. Then I repeatedly gave them “another week’s prices,” and allowed them to buy and sell again. The players did all kinds of fancy calculating, using a wild variety of assumptions — although there was no possible way that the figuring could help them.</p>
<p>When I stopped the game before completing the 10 buy-and-sell sessions they expected, subjects would ask that the game go on. Then I would tell them that there was no basis to believe that there were patterns in the data, because the “prices” were just randomly-generated numbers. Winning or losing therefore did not depend upon the subjects’ skill. Nevertheless, they demanded that the game not stop until the 10 “weeks” had been played, so they could find out whether they “won” or “lost.”</p>
<p>This study of batting illustrates how one can test for independence among various trials. The trials are independent if each observation is randomly chosen with replacement from the universe, in which case there is no reason to believe that one observation will be related to the observations directly before and after; as it is said, “the coin has no memory.”</p>
<p>The year-to-year level of Lake Michigan is an example in which observations are <em>not</em> independent. If Lake Michigan is very high in one year, it is likely to be higher than average the following year because some of the high level carries over from one year into the next.<a href="#fn4" class="footnote-ref" id="fnref4" role="doc-noteref"><sup>4</sup></a> We could test this hypothesis by writing down whether the level in each year from, say, 1860 to 1975 was higher or lower than the median level for those years. We would then count the number of runs of “higher” and “lower” and compare the number of runs of “black” and “red” with a deck of that many cards; we would find fewer runs in the lake level than in an average hand of 116 (1976-1860) cards, though this test is hardly necessary. (But are the <em>changes</em> in Lake Michigan’s level independent from year to year? If the level went up last year, is there a better than 50-50 chance that the level will also go up this year? The answer to this question is not so obvious. One could compare the numbers of runs of ups and downs against an average hand of cards, just as with the hits and outs in baseball.)</p>
<p>Exercise for students: How could one check whether the successive numbers in a random-number table are independent?</p>
</section>
</section>
<section id="exercises" class="level2" data-number="29.7">
<h2 data-number="29.7" class="anchored" data-anchor-id="exercises"><span class="header-section-number">29.7</span> Exercises</h2>
<p>You can find solutions for problems at <a href="exercise_solutions.html" class="quarto-xref"><span>Chapter 32</span></a>.</p>
<section id="sec-exr-voter-participation" class="level3" data-number="29.7.1">
<h3 data-number="29.7.1" class="anchored" data-anchor-id="sec-exr-voter-participation"><span class="header-section-number">29.7.1</span> Exercise: voter participation</h3>
<p><a href="#tbl-voter-participation" class="quarto-xref">Table&nbsp;<span>29.11</span></a> shows voter participation rates in the various states in the 1844 presidential election. Should we conclude that there was a negative relationship between the participation rate and the vote spread between the parties in the election? (Adapted from <span class="citation" data-cites="noreen1989computer">(<a href="references.html#ref-noreen1989computer" role="doc-biblioref">Noreen 1989, 20</a>, Table 2-4)</span>:</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="tbl-voter-participation" class="lightable-paper lightable-striped lightable-hover quarto-float quarto-figure quarto-figure-center anchored" style="font-family: &quot;Arial Narrow&quot;, arial, helvetica, sans-serif; width: auto !important; margin-left: auto; margin-right: auto;" data-quarto-postprocess="true">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-voter-participation-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;29.11: Voter Participation In 1844 Presidential Election
</figcaption>
<div aria-describedby="tbl-voter-participation-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table class="lightable-paper lightable-striped lightable-hover caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">State</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Participation</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Spread</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Maine</td>
<td style="text-align: right;">67.5</td>
<td style="text-align: right;">13</td>
</tr>
<tr class="even">
<td style="text-align: left;">New Hampshire</td>
<td style="text-align: right;">65.6</td>
<td style="text-align: right;">19</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Vermont</td>
<td style="text-align: right;">65.7</td>
<td style="text-align: right;">18</td>
</tr>
<tr class="even">
<td style="text-align: left;">Massachusetts</td>
<td style="text-align: right;">59.3</td>
<td style="text-align: right;">12</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Rhode Island</td>
<td style="text-align: right;">39.8</td>
<td style="text-align: right;">20</td>
</tr>
<tr class="even">
<td style="text-align: left;">Connecticut</td>
<td style="text-align: right;">76.1</td>
<td style="text-align: right;">5</td>
</tr>
<tr class="odd">
<td style="text-align: left;">New York</td>
<td style="text-align: right;">73.6</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">New Jersey</td>
<td style="text-align: right;">81.6</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Pennsylvania</td>
<td style="text-align: right;">75.5</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="even">
<td style="text-align: left;">Delaware</td>
<td style="text-align: right;">85.0</td>
<td style="text-align: right;">3</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Maryland</td>
<td style="text-align: right;">80.3</td>
<td style="text-align: right;">5</td>
</tr>
<tr class="even">
<td style="text-align: left;">Virginia</td>
<td style="text-align: right;">54.5</td>
<td style="text-align: right;">6</td>
</tr>
<tr class="odd">
<td style="text-align: left;">North Carolina</td>
<td style="text-align: right;">79.1</td>
<td style="text-align: right;">5</td>
</tr>
<tr class="even">
<td style="text-align: left;">Georgia</td>
<td style="text-align: right;">94.0</td>
<td style="text-align: right;">4</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Kentucky</td>
<td style="text-align: right;">80.3</td>
<td style="text-align: right;">8</td>
</tr>
<tr class="even">
<td style="text-align: left;">Tennessee</td>
<td style="text-align: right;">89.6</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Louisiana</td>
<td style="text-align: right;">44.7</td>
<td style="text-align: right;">3</td>
</tr>
<tr class="even">
<td style="text-align: left;">Alabama</td>
<td style="text-align: right;">82.7</td>
<td style="text-align: right;">8</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Mississippi</td>
<td style="text-align: right;">89.7</td>
<td style="text-align: right;">13</td>
</tr>
<tr class="even">
<td style="text-align: left;">Ohio</td>
<td style="text-align: right;">83.6</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Indiana</td>
<td style="text-align: right;">84.9</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="even">
<td style="text-align: left;">Illinois</td>
<td style="text-align: right;">76.3</td>
<td style="text-align: right;">12</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Missouri</td>
<td style="text-align: right;">74.7</td>
<td style="text-align: right;">17</td>
</tr>
<tr class="even">
<td style="text-align: left;">Arkansas</td>
<td style="text-align: right;">68.8</td>
<td style="text-align: right;">26</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Michigan</td>
<td style="text-align: right;">79.3</td>
<td style="text-align: right;">6</td>
</tr>
</tbody>
</table>
</div>
</figure>
</div>


</div>
</div>
<p>The observed correlation coefficient between voter participation and spread is -0.425. Is this more negative that what might occur by chance, if no correlation exists?</p>
<p>Here’s a notebook to get you started.</p>
<div class="notebook" name="voter_participation_exercise" title="Voter participation in 1844 election">
<p>Start of <code>voter_participation_exercise</code> notebook</p>
<div class="nb-links">
<a class="notebook-link" href="notebooks/voter_participation_exercise.zip">Download zip with notebook + data file</a>
<a class="interact-button" href="./interact/lab/index.html?path=voter_participation_exercise.ipynb">Interact</a>
</div>

<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>voter_df <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">'data/election_1844.csv'</span>)</span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>participation <span class="ot">&lt;-</span> voter_df<span class="sc">$</span>Participation</span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>spread <span class="ot">&lt;-</span> voter_df<span class="sc">$</span>Spread</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>End of <code>voter_participation_exercise</code> notebook</p>
</div>
<!---
End of notebook
-->
<p>See: <a href="exercise_solutions.html#sec-soln-voter-participation" class="quarto-xref"><span>Section 32.6</span></a>.</p>
</section>
<section id="sec-exr-runs-strikeouts" class="level3" data-number="29.7.2">
<h3 data-number="29.7.2" class="anchored" data-anchor-id="sec-exr-runs-strikeouts"><span class="header-section-number">29.7.2</span> Exercise: association of runs and strikeouts</h3>
<p>We would like to know whether, among major-league baseball players, home runs (per 500 at-bats) and strikeouts (per 500 at-bat’s) are correlated. For this exercise, you should use the sum-of-products procedure as used above for I.Q. and athletic ability — multiplying the elements within each pair. The next exercise uses the more “sophisticated” measure, the correlation coefficient.</p>
<p>The data for 18 randomly-selected players in the 1989 season are as follows, as they would appear in the first lines of the notebook.</p>
<div class="notebook" name="homerun_sop_exercise" title="Homeruns and strikeout sum of products.">
<p>Start of <code>homerun_sop_exercise</code> notebook</p>
<div class="nb-links">
<a class="notebook-link" href="notebooks/homerun_sop_exercise.Rmd">Download notebook</a>
<a class="interact-button" href="./interact/lab/index.html?path=homerun_sop_exercise.ipynb">Interact</a>
</div>

<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>homeruns <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">14</span>, <span class="dv">20</span>, <span class="dv">0</span>, <span class="dv">38</span>, <span class="dv">9</span>, <span class="dv">38</span>, <span class="dv">22</span>, <span class="dv">31</span>, <span class="dv">33</span>,</span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>              <span class="dv">11</span>, <span class="dv">40</span>, <span class="dv">5</span>, <span class="dv">15</span>, <span class="dv">32</span>, <span class="dv">3</span>, <span class="dv">29</span>, <span class="dv">5</span>, <span class="dv">32</span>)</span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>strikeout <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">135</span>, <span class="dv">153</span>, <span class="dv">120</span>, <span class="dv">161</span>, <span class="dv">138</span>, <span class="dv">175</span>, <span class="dv">126</span>, <span class="dv">200</span>, <span class="dv">205</span>,</span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a>               <span class="dv">147</span>, <span class="dv">165</span>, <span class="dv">124</span>, <span class="dv">169</span>, <span class="dv">156</span>, <span class="dv">36</span>, <span class="dv">98</span>, <span class="dv">82</span>, <span class="dv">131</span>)</span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Exercise - complete this program.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>End of <code>homerun_sop_exercise</code> notebook</p>
</div>
<!---
End of notebook.
-->
<p>See: <a href="exercise_solutions.html#sec-soln-runs-strikeouts" class="quarto-xref"><span>Section 32.7</span></a>.</p>
</section>
<section id="sec-exr-runs-strikeouts-r" class="level3" data-number="29.7.3">
<h3 data-number="29.7.3" class="anchored" data-anchor-id="sec-exr-runs-strikeouts-r"><span class="header-section-number">29.7.3</span> Exercise: runs, strikeouts, correlation coefficient</h3>
<p>In the previous example relating strikeouts and home runs, we used the procedure of multiplying the elements within each pair. Now we use a more “sophisticated” measure, the correlation coefficient, which is simply a standardized form of the multiplicands, but sufficiently well known that we calculate it with a pre-set command.</p>
<p>Exercise: Write a program that uses the correlation coefficient to test the significance of the association between home runs and strikeouts. You can use the starting notebook for the previous exercise.</p>
<p>See: <a href="exercise_solutions.html#sec-soln-runs-strikeouts-r" class="quarto-xref"><span>Section 32.8</span></a>.</p>
</section>
<section id="sec-exr-money-exchange" class="level3" data-number="29.7.4">
<h3 data-number="29.7.4" class="anchored" data-anchor-id="sec-exr-money-exchange"><span class="header-section-number">29.7.4</span> Exercise: money and exchange rate</h3>
<p>All the other things equal, an increase in a country’s money supply is inflationary and should have a negative impact on the exchange rate for the country’s currency. The data in the following table (<a href="#tbl-exchange" class="quarto-xref">Table&nbsp;<span>29.12</span></a>) were computed using data from tables in the 1983/1984 <em>Statistical Yearbook of the United Nations</em>. The table shows the first 15 rows.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="tbl-exchange" class="lightable-paper lightable-striped lightable-hover quarto-float quarto-figure quarto-figure-center anchored" style="font-family: &quot;Arial Narrow&quot;, arial, helvetica, sans-serif; width: auto !important; margin-left: auto; margin-right: auto;" data-quarto-postprocess="true">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-exchange-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;29.12: % change in exchange rates and money supply 1983-1984
</figcaption>
<div aria-describedby="tbl-exchange-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table class="lightable-paper lightable-striped lightable-hover caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th"></th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Exchange rate</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Money supply</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Australia</td>
<td style="text-align: right;">0.089</td>
<td style="text-align: right;">0.035</td>
</tr>
<tr class="even">
<td style="text-align: left;">Belgium</td>
<td style="text-align: right;">0.134</td>
<td style="text-align: right;">0.003</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Botswana</td>
<td style="text-align: right;">0.351</td>
<td style="text-align: right;">0.085</td>
</tr>
<tr class="even">
<td style="text-align: left;">Burma</td>
<td style="text-align: right;">0.064</td>
<td style="text-align: right;">0.155</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Burundi</td>
<td style="text-align: right;">0.064</td>
<td style="text-align: right;">0.064</td>
</tr>
<tr class="even">
<td style="text-align: left;">Canada</td>
<td style="text-align: right;">0.062</td>
<td style="text-align: right;">0.209</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Chile</td>
<td style="text-align: right;">0.465</td>
<td style="text-align: right;">0.126</td>
</tr>
<tr class="even">
<td style="text-align: left;">China</td>
<td style="text-align: right;">0.411</td>
<td style="text-align: right;">0.555</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Costa Rica</td>
<td style="text-align: right;">0.100</td>
<td style="text-align: right;">0.100</td>
</tr>
<tr class="even">
<td style="text-align: left;">Cyprus</td>
<td style="text-align: right;">0.158</td>
<td style="text-align: right;">0.044</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Denmark</td>
<td style="text-align: right;">0.140</td>
<td style="text-align: right;">0.351</td>
</tr>
<tr class="even">
<td style="text-align: left;">Ecuador</td>
<td style="text-align: right;">0.242</td>
<td style="text-align: right;">0.356</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Fiji</td>
<td style="text-align: right;">0.093</td>
<td style="text-align: right;">0.000</td>
</tr>
<tr class="even">
<td style="text-align: left;">Finland</td>
<td style="text-align: right;">0.124</td>
<td style="text-align: right;">0.164</td>
</tr>
<tr class="odd">
<td style="text-align: left;">France</td>
<td style="text-align: right;">0.149</td>
<td style="text-align: right;">0.090</td>
</tr>
<tr class="even">
<td style="text-align: left;">Germany</td>
<td style="text-align: right;">0.156</td>
<td style="text-align: right;">0.061</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Greece</td>
<td style="text-align: right;">0.302</td>
<td style="text-align: right;">0.202</td>
</tr>
<tr class="even">
<td style="text-align: left;">Hungary</td>
<td style="text-align: right;">0.133</td>
<td style="text-align: right;">0.049</td>
</tr>
<tr class="odd">
<td style="text-align: left;">India</td>
<td style="text-align: right;">0.187</td>
<td style="text-align: right;">0.184</td>
</tr>
<tr class="even">
<td style="text-align: left;">Indonesia</td>
<td style="text-align: right;">0.080</td>
<td style="text-align: right;">0.132</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Italy</td>
<td style="text-align: right;">0.167</td>
<td style="text-align: right;">0.124</td>
</tr>
<tr class="even">
<td style="text-align: left;">Jamaica</td>
<td style="text-align: right;">0.504</td>
<td style="text-align: right;">0.237</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Japan</td>
<td style="text-align: right;">0.081</td>
<td style="text-align: right;">0.069</td>
</tr>
<tr class="even">
<td style="text-align: left;">Jordan</td>
<td style="text-align: right;">0.092</td>
<td style="text-align: right;">0.010</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Kenya</td>
<td style="text-align: right;">0.144</td>
<td style="text-align: right;">0.141</td>
</tr>
<tr class="even">
<td style="text-align: left;">Korea</td>
<td style="text-align: right;">0.040</td>
<td style="text-align: right;">0.006</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Kuwait</td>
<td style="text-align: right;">0.038</td>
<td style="text-align: right;">-0.180</td>
</tr>
<tr class="even">
<td style="text-align: left;">Lebanon</td>
<td style="text-align: right;">0.619</td>
<td style="text-align: right;">0.065</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Madagascar</td>
<td style="text-align: right;">0.337</td>
<td style="text-align: right;">0.244</td>
</tr>
<tr class="even">
<td style="text-align: left;">Malawi</td>
<td style="text-align: right;">0.205</td>
<td style="text-align: right;">0.203</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Malaysia</td>
<td style="text-align: right;">0.037</td>
<td style="text-align: right;">-0.006</td>
</tr>
<tr class="even">
<td style="text-align: left;">Malta</td>
<td style="text-align: right;">0.003</td>
<td style="text-align: right;">0.003</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Mauritania</td>
<td style="text-align: right;">0.180</td>
<td style="text-align: right;">0.192</td>
</tr>
<tr class="even">
<td style="text-align: left;">Mauritius</td>
<td style="text-align: right;">0.226</td>
<td style="text-align: right;">0.136</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Mexico</td>
<td style="text-align: right;">0.338</td>
<td style="text-align: right;">0.599</td>
</tr>
<tr class="even">
<td style="text-align: left;">Morocco</td>
<td style="text-align: right;">0.076</td>
<td style="text-align: right;">0.076</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Netherlands</td>
<td style="text-align: right;">0.158</td>
<td style="text-align: right;">0.078</td>
</tr>
<tr class="even">
<td style="text-align: left;">New Zealand</td>
<td style="text-align: right;">0.370</td>
<td style="text-align: right;">0.098</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Nigeria</td>
<td style="text-align: right;">0.079</td>
<td style="text-align: right;">0.082</td>
</tr>
<tr class="even">
<td style="text-align: left;">Norway</td>
<td style="text-align: right;">0.177</td>
<td style="text-align: right;">0.242</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Papua</td>
<td style="text-align: right;">0.075</td>
<td style="text-align: right;">0.209</td>
</tr>
<tr class="even">
<td style="text-align: left;">Philippines</td>
<td style="text-align: right;">0.411</td>
<td style="text-align: right;">0.035</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Portugal</td>
<td style="text-align: right;">0.288</td>
<td style="text-align: right;">0.166</td>
</tr>
<tr class="even">
<td style="text-align: left;">Romania</td>
<td style="text-align: right;">-0.029</td>
<td style="text-align: right;">0.039</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Rwanda</td>
<td style="text-align: right;">0.059</td>
<td style="text-align: right;">0.083</td>
</tr>
<tr class="even">
<td style="text-align: left;">Samoa</td>
<td style="text-align: right;">0.348</td>
<td style="text-align: right;">0.118</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Saudi Arabia</td>
<td style="text-align: right;">0.023</td>
<td style="text-align: right;">0.023</td>
</tr>
<tr class="even">
<td style="text-align: left;">Seychelles</td>
<td style="text-align: right;">0.063</td>
<td style="text-align: right;">0.031</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Singapore</td>
<td style="text-align: right;">0.024</td>
<td style="text-align: right;">0.030</td>
</tr>
<tr class="even">
<td style="text-align: left;">Solomon Is</td>
<td style="text-align: right;">0.101</td>
<td style="text-align: right;">0.526</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Somalia</td>
<td style="text-align: right;">0.481</td>
<td style="text-align: right;">0.238</td>
</tr>
<tr class="even">
<td style="text-align: left;">South Africa</td>
<td style="text-align: right;">0.624</td>
<td style="text-align: right;">0.412</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Spain</td>
<td style="text-align: right;">0.107</td>
<td style="text-align: right;">0.086</td>
</tr>
<tr class="even">
<td style="text-align: left;">Sri Lanka</td>
<td style="text-align: right;">0.051</td>
<td style="text-align: right;">0.141</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Switzerland</td>
<td style="text-align: right;">0.186</td>
<td style="text-align: right;">0.186</td>
</tr>
<tr class="even">
<td style="text-align: left;">Tunisia</td>
<td style="text-align: right;">0.193</td>
<td style="text-align: right;">0.068</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Turkey</td>
<td style="text-align: right;">0.573</td>
<td style="text-align: right;">0.181</td>
</tr>
<tr class="even">
<td style="text-align: left;">UK</td>
<td style="text-align: right;">0.255</td>
<td style="text-align: right;">0.154</td>
</tr>
<tr class="odd">
<td style="text-align: left;">USA</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.156</td>
</tr>
<tr class="even">
<td style="text-align: left;">Vanatuva</td>
<td style="text-align: right;">0.008</td>
<td style="text-align: right;">0.331</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Yemen</td>
<td style="text-align: right;">0.253</td>
<td style="text-align: right;">0.247</td>
</tr>
<tr class="even">
<td style="text-align: left;">Yugoslavia</td>
<td style="text-align: right;">0.685</td>
<td style="text-align: right;">0.432</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Zaire</td>
<td style="text-align: right;">0.343</td>
<td style="text-align: right;">0.244</td>
</tr>
<tr class="even">
<td style="text-align: left;">Zambia</td>
<td style="text-align: right;">0.457</td>
<td style="text-align: right;">0.094</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Zimbabwe</td>
<td style="text-align: right;">0.359</td>
<td style="text-align: right;">0.164</td>
</tr>
</tbody>
</table>
</div>
</figure>
</div>


</div>
</div>
<p>Are changes in the exchange rates and in money supplies related to each other? That is, are they correlated?</p>
<!---
Original text has "(Adapted from Noreen (1990)".  It isn't obvious how it
would be adapted from Noreen (1989), and otherwise, what Noreen (1990) might
be.
-->
<p>Should the algorithm of non-computer resampling steps be similar to the algorithm for I.Q. and athletic ability shown in the text? One can also work with the correlation coefficient rather then the sum-of-products method, and expect to get the same result.</p>
<ol type="1">
<li>Write a series of non-computer resampling steps to solve this problem.</li>
<li>Write a R program to implement those steps.</li>
</ol>
<p>Here’s a notebook to get you started on part 2:</p>
<div class="notebook" name="exchange_rates_exercise" title="Exchange rates and money supply">
<p>Start of <code>exchange_rates_exercise</code> notebook</p>
<div class="nb-links">
<a class="notebook-link" href="notebooks/exchange_rates_exercise.zip">Download zip with notebook + data file</a>
<a class="interact-button" href="./interact/lab/index.html?path=exchange_rates_exercise.ipynb">Interact</a>
</div>

<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>exchange_df <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">'data/exchange_rates.csv'</span>)</span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>exchange_rates <span class="ot">&lt;-</span> exchange_df<span class="sc">$</span>exchange_rate</span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>money_supply <span class="ot">&lt;-</span> exchange_df<span class="sc">$</span>money_supply</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>End of <code>exchange_rates_exercise</code> notebook</p>
</div>
<!---
End of notebook.
-->
<p>See: <a href="exercise_solutions.html#sec-soln-money-exchange" class="quarto-xref"><span>Section 32.8.1</span></a>.</p>


<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list" style="display: none">
<div id="ref-dixon1983introduction" class="csl-entry" role="listitem">
Dixon, Wilfrid J, and Frank J Massey Jr. 1983. <span>“Introduction to Statistical Analysis.”</span>
</div>
<div id="ref-efron1993bootstrap" class="csl-entry" role="listitem">
Efron, Bradley, and Robert J Tibshirani. 1993. <span>“An Introduction to the Bootstrap.”</span> In <em>Monographs on Statistics and Applied Probability</em>, edited by David R Cox, David V Hinkley, Nancy Reid, Donald B Rubin, and Bernard W Silverman. Vol. 57. New York: <span>Chapman &amp; Hall</span>.
</div>
<div id="ref-noreen1989computer" class="csl-entry" role="listitem">
Noreen, Eric W. 1989. <em>Computer-Intensive Methods for Testing Hypotheses</em>. New York: John Wiley &amp; Sons. <a href="https://archive.org/details/computerintensiv0000nore">https://archive.org/details/computerintensiv0000nore</a>.
</div>
<div id="ref-simon1985basic" class="csl-entry" role="listitem">
Simon, Julian Lincoln, and Paul Burstein. 1985. <em>Basic Research Methods in Social Science</em>. 3rd ed. New York: Random House.
</div>
<div id="ref-wallis1956statistics" class="csl-entry" role="listitem">
Wallis, Wilson Allen, and Harry V Roberts. 1956. <em>Statistics, a New Approach.</em> New York: The Free Press.
</div>
</div>
</section>
</section>
<section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes">
<hr>
<ol>
<li id="fn1"><p>As we discussed in the introduction, correlation coefficient values can vary between 1 and -1, where values near 1 mean a very strong positive linear relationship (high values in one variable predict high values in the other), values near -1 mean a very strong negative linear relationship (high values in one predict low values in the other), and values near 0 mean very little linear relationship between the variables.<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn2"><p>For a much fuller discussion on causality and causation, see Simon and Burstein <span class="citation" data-cites="simon1985basic">(<a href="references.html#ref-simon1985basic" role="doc-biblioref">1985</a>)</span>.<a href="#fnref2" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn3"><p>These data are based on an example in <span class="citation" data-cites="dixon1983introduction">(<a href="references.html#ref-dixon1983introduction" role="doc-biblioref">Dixon and Massey Jr 1983, 278</a>, example 13-5)</span>, in which the problem is tackled conventionally with a chi-square test.<a href="#fnref3" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn4"><p>Example from <span class="citation" data-cites="wallis1956statistics">(<a href="references.html#ref-wallis1956statistics" role="doc-biblioref">Wallis and Roberts 1956, 565</a> – 556)</span>.<a href="#fnref4" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./reliability_average.html" class="pagination-link" aria-label="Some Last Words About the Reliability of Sample Averages">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">28</span>&nbsp; <span class="chapter-title">Some Last Words About the Reliability of Sample Averages</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./how_big_sample.html" class="pagination-link" aria-label="How Large a Sample?">
        <span class="nav-page-text"><span class="chapter-number">30</span>&nbsp; <span class="chapter-title">How Large a Sample?</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




</body></html>